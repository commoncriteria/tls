<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html><head><meta content="text/html;charset=utf-8" http-equiv="Content-Type"></meta><meta content="utf-8" http-equiv="encoding"></meta><title>Functional Package for Transport Layer Security (TLS)</title><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/x-mathjax-config">
            MathJax.Hub.Config({
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            showMathMenu: false,
            tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
              processEscapes: true
            },
            styles: {

                ".MathJax_Display": {
                "text-align": "left !important",
                margin:       "0em 0em !important"
            }}
            });
        </script><script type="text/javascript">// 

// Called on page load to parse URL parameters and perform actions on them.
function init(){
    if(getQueryVariable("expand") == "on"){
      expand();
    }
    fixAbbrs();
}


function fixAbbrs(){
    var aa;
    var brk_els = document.getElementsByClassName("dyn-abbr");
    //
    for(aa=0; aa!=brk_els.length; aa++){
        var abbr = brk_els[aa].firstElementChild.getAttribute("href").substring(1);
        var el = document.getElementById("long_"+abbr)
        if (el==null) {
             console.log("Could not find 'long_abbr_'"+abbr);
             continue;
        }
        var abbr_def = el.textContent;
        brk_els[aa].setAttribute("title", abbr_def);
    }
}
// // 
const AMPERSAND=String.fromCharCode(38);

// Pass a URL variable to this function and it will return its value
function getQueryVariable(variable)
{
    var query = window.location.search.substring(1);
    var vars = query.split(AMPERSAND);
    for (var i=0;i!=vars.length;i++) {
        var pair = vars[i].split("=");
        if(pair[0] == variable){return pair[1];}
    }
    return(false);
}


//    Expands all evaluation activities
function expand(){
    var ap = document.getElementsByClassName('activity_pane');
    for (var ii = 0; ii!=ap.length; ii++) {
        ap[ii].classList.remove('hide');
    }
}

// Function to expand and contract a given div
function toggle(descendent) {
    var cl = descendent.parentNode.parentNode.classList;
    if (cl.contains('hide')){
      cl.remove('hide');
    }
    else{
      cl.add('hide');
    }
}

// Expands targets if they are hidden
function showTarget(id){
    var element = document.getElementById(id);
    while (element != document.body.rootNode ){
	element.classList.remove("hide");
	element = element.parentElement;
    }
}


// </script><style type="text/css">
    #toc a{
        display: block;
    }
    .td-{
        display: block;
    }
    svg{
      width: 100%;
    }

    a[id^="ajq_"]{
        color:black;
    }

    
    body{
       max-width: 900px;
       margin: auto;
    }
    #toc span{
       margin-left: 20px;
    }
    .assignable-content{
      font-style: italic;
    }
    .selectable-content{
      font-style: italic;
    }
    .not-selectable-content{
      font-style: italic;
      text-decoration: line-through;
    }
    .refinement{
      font-weight: bold;
    }
    div.eacategory{
      font-style: italic;
      font-weight: bold;
    }
    .activity_pane .toggler::after, .activity_pane .toggler{
       display: inline-block;
       height: auto;
       content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
       AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
       VDz+AAAAB3RJTUUH4gIXFDM7fhmr1wAAAfRJREFUKM+dkk9I02EYxz/P+25uurWR\
       tTkzI4NGl4jQgkq71K1DhnTQIDolRAQFQYSHTtGhU4e6eujQofBSFLOg0C4RUSjh\
       FnmqTTdKpj/mfv/eX4cUpmRYn9vz8v3w8D7PA/AWGADCbI4QcAb4AnAF8IBJEdX+\
       N0tEda40C4AHADviW1LFvpOX6+FwtAacVzqkGiWtwxo4F21OuPu7+yvxRNoDEhpY\
       cpzavkQyc7D76FCk+vN7j7VU6RdR4xAsikjGGP9FKrN3sPfEpajv2i2zhckR4JUG\
       UCr0erFavLkn2ytd2WPxcFOsZb74+SIQA0YPHBqIdB8Z6tChJv1m/N4P33OGAUsD\
       BIFxPNcOkq07jyeSbbo1tTu2q6vHEqU7D/ddSKcz2ZQJjBSmx925b9NjwEMAafha\
       eyQa/3Dq7O0243sCIEoRGAOA59nm5dM7OHVruzH+AkDjYEp23RrLT+U8Ub+fV0UR\
       oVyaMfVa9fqquF5GKX3ja2FCuc6yWbMipYNP755UgEdr8o2FMf5ivVYdKRfzRkRW\
       RfJTOc+2rWdAcUN5hdGP7x8viGgAXLvGbGFCKxW6tj74J3nOqVvP89M5V6kQ86UZ\
       f7lWvWWMt7Sp41VKb21uSfqnB++6kWi8BLTzL4ioq7H4tgC4z3/QAZSBxEaBXygN\
       v+jeFnAPAAAAAElFTkSuQmCC');
       max-width: 15px;
    }

    a.defined{
      color: inherit;
      text-decoration: inherit;
    }
      
    a {
      text-decoration: none;
      word-wrap: break-word;
    }
    a.abbr:link{
      color:black;
      text-decoration:none;
    }
    a.abbr:visited{
      color:black;
      text-decoration:none;
    }
    a.abbr:hover{
      color:blue;
      text-decoration:none;
    }
    a.abbr:hover:visited{
      color:purple;
      text-decoration:none;
    }
    a.abbr:active{
      color:red;
      text-decoration:none;
    }
    .note-header{
      font-weight: bold;
    }
    .note p:first-child{
      display: inline;
    }

    .indent{ margin-left:2em; }

    /* Tooltip container */
    .tooltipped {
       position: relative;
       display: inline-block;
       border-bottom: 1px dotted black; /* If you want dots under the hoverable text */
    }

    /* Tooltip text */
    .tooltiptext {
       visibility: hidden;
       width: 120px;
       background-color: black;
       color: #fff;
       text-align: center;
       padding: 5px 0;
       border-radius: 6px;

       /* Position the tooltip text - see examples below! */
       position: absolute;
       z-index: 1;
   }

   /* Show the tooltip text when you mouse over the tooltip container */
   .tooltipped:hover .tooltiptext {
       visibility: visible;
   }
   tr.major-row{
       border-top-style: double;
   }
   tr.major-row td:first-child{
       border-right-style: ridge;
       background-color: white;
   } 
   table.mfs td{
       text-align: center;
   }
   table.mfs td:first-child{
       text-align: left;
       white-space: nowrap;
   }
  .table-caption, caption{
       text-align: center;
       font-weight: bold;
   }
   table{
       margin:auto;
       margin-top:1em;
       border-collapse:collapse; /*border: 1px solid black;*/
   }
   td{
       text-align:left;
       padding:8px 8px;
   }
   th{
       padding:8px 8px;
   }
   thead tr td{
       text-align: center;
       font-style: oblique;
       font-weight: bold;
   }
   tr.header{
       border-bottom:3px solid gray;
       padding:8px 8px;
       text-align:left;
       font-weight:bold; /*font-size: 90%; font-family: verdana, arial, helvetica, sans-serif; */
   }
   table tr:nth-child(2n+2){
       background-color:#F4F4F4;
   }

   table.ecd_heir_dep{
       width: 100%;
   }
   table.ecd_heir_dep tr{
       background-color: inherit;
   }
       
   table.ecd_heir_dep tr :first-child{
       white-space: nowrap;
   }
   table.ecd_heir_dep tr :last-child{
       width: 100%;
   }

       
   .dependent{
       border: 1px solid gray;
       border-radius: 1px
   }
   .dependent-content{
       margin-left: 25px;
       font-style: italic;
   }

   .uc_table_or td, .uc_table_or tr {
       vertical-align: middle;
       border: 1px solid black;
       background-color: white;
   }

   .uc_not, .uc_mf, .uc_sel, .uc_guide{
       text-indent: 10px;
   }
   .uc_sel &gt; a{ 
       font-style: italic;
   }

   .uc_not_sel, .uc_sel.uc_mf, uc_assign.uc_mf{
       text-indent: 20px;
   }


   .uc_table_or tr td.or_cell{
      white-space: nowrap;
      border-radius: 0.6em 0 0 0.6em;
      background-color: black;
      color: white;
   }

   .uc_table_and, .uc_table_or {
       width: 100%;
       background-color: white;
   }
   .uc_guidance{
       display: table;
       background-color: gray;
   }  
   div.uc_inc_fcomp{
       display: list-item;
       list-style-type: disc;
       list-style-position: inside;
       }

   div.validationguidelines_label{
        padding-top: 10px;
   }
	
   .evidence, .test-obj { font-style: normal; font-size: 90%;}
   
   
	table.classic {
    	width: 100%;
    	background-color: white;
    	border-collapse: collapse;
    	border-width: 2px;
  		border-color: gray;
  		border-style: solid;
  		color: black;
		font-size: small;
	}
    table.classic th {
  		background-color: lightgray;   
	}
    table.classic th:empty{
	    background-color: white;
		border-top: none;
		border-left: none;
	}
	table.classic td, table.classic th {
  		border-width: 2px;
  		border-color: gray;
  		border-style: solid;
  		padding: 5px;
	}

   
    .comp .description{
        padding-bottom: 20px;
        display: block;
    }    
   
   
          .figure{
              font-weight:bold;
          }
          h1{
              page-break-before:always;
              text-align:left;
              font-size:200%;
              margin-top:2em;
              margin-bottom:2em;
              font-family:verdana, arial, helvetica, sans-serif;
              margin-bottom:1.0em;
          }
          h1.title{
              text-align:center;
          }
          h2{
              font-size:125%;
              border-bottom:solid 1px gray;
              margin-bottom:1.0em;
              margin-top:2em;
              margin-bottom:0.75em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h3{
              font-size:110%;
              margin-bottom:0.25em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h4{
              margin-left:0%;
              font-size:100%;
              margin-bottom:0.75em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h5,
          h6{
              margin-left:6%;
              font-size:90%;
              margin-bottom:0.5em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          p{
              margin-bottom:0.6em;
              margin-top:0.2em;
          }
          pre{
              margin-bottom:0.5em;
              margin-top:0.25em;
              margin-left:3%;
              font-family:monospace;
              font-size:90%;
          }
          ul{
              margin-bottom:0.5em;
              margin-top:0.25em;
          }
          td{
              vertical-align:top;
          }
          dl{
              margin-bottom:0.5em;
              margin-top:0.25em;
          }
          dt{
              margin-top:0.7em;
              font-weight:bold;
              font-family:verdana, arial, helvetica, sans-serif;
          }

          a.linkref{
              font-family:verdana, arial, helvetica, sans-serif;
              font-size:90%;
          }

          *.simpleText{
              margin-left:10%;
          }
          *.propertyText{
              margin-left:10%;
              margin-top:0.2em;
              margin-bottom:0.2em
          }
          *.toc{
              background:#FFFFFF;
          }
          *.toc2{
              background:#FFFFFF;
          }
	  .choicelabel{
	    font-weight: bold;
	  }
          div.comp{
              margin-left:8%;
              margin-top:1em;
              margin-bottom:1em;
          }
          div.element{
              margin-bottom:1em;
          }
          div.appnote{
              margin-left:0%;
              margin-top:1em;
          }
          .comment{
              background-color:beige;
              color:green;
          }

          div.subaact{
              margin-left:0%;
              margin-top:1em;
          }
          .subaact-header{
              font-weight: bold;
          }

          div.activity_pane_body{
              font-style:italic;
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              padding:1em;
              border:2px solid #888888;
              border-radius:3px;
              display:block;
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);
          }
          div.optional-appendicies{
              display:none;
          }

          div.statustag{
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              padding: 0.6em;
              border:2px solid #888888;
              border-radius:3px;
          }

          div.toc{
              margin-left:8%;
              margin-bottom:4em;
              padding-bottom:0.75em;
              padding-top:1em;
              padding-left:2em;
              padding-right:2em;
          }
          span.SOlist{
              font-size:90%;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h2.toc{
              border-bottom:none;
              margin-left:0%;
              margin-top:0em;
          }
          p.toc{
              margin-left:2em;
              margin-bottom:0.2em;
              margin-top:0.5em;
          }
          p.toc2{
              margin-left:5em;
              margin-bottom:0.1em;
              margin-top:0.1em;
          }
          div.center{
              display:block;
              margin-left:auto;
              margin-right:auto;
              text-align:center;
              }
          div.ea{
	      padding-bottom:10px;
          }
	      
          div.figure{
              display:block;
              margin-left:auto;
              margin-right:auto;
              text-align:center;
              margin-top:1em;
          }
          div.activity_pane_header{
              display:table-cell;
              vertical-align:middle;
              padding-top:10px;
          }
          span.activity_pane_label{
              vertical-align:middle;
              color:black;
              text-decoration:none;
              font-size:100%;
              font-weight:bold; /*font-family: verdana, arial, helvetica, sans-serif; */
          }
          .dyn-abbr a, .dyn-abbr a:active, .dyn-abbr a:visited{
              background-color: inherit;
              color: inherit;
              text-decoration: inherit;;
          }

          @media screen{
              *.reqid{
                  float:left;
                  font-size:90%;
                  font-family:verdana, arial, helvetica, sans-serif;
                  margin-right:1em;
              }
              *.req{
                  margin-left:0%;
                  margin-top:1em;
                  margin-bottom:1em;
              }
              *.reqdesc{
                  margin-left:20%;
              }

              .activity_pane.hide .toggler::after, .activity_pane.hide .toggler{
	          content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
		  AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
		  VDz+AAAAB3RJTUUH4gIXFC4BR3keeQAAAfZJREFUKM+d0k1PE1EUBuB37h2nQ+30\
		  w5YObR0FhIppqBgWuDCaSBQjiQZNTIxLfoAkBHXh2vg7xID+ABPXBl3UdAMaN1CR\
		  j5ZijZ22DKW9d44LP1KMROvZnMU5z+KcvBzAAgADwCdV1RzXlYQ26tYhrYM6u/qX\
		  ATwCcKodrAOYv3z9IV28OuP6/NHPAGYZ45G/QQ5AAFjNbyzdTA2NewcGx7xeI5wu\
		  FZenQOQQuasHncN/9IJo1sn+unkpbqVFIJhgydQo13VjDKCJSnnLBJAHUPoTBoA3\
		  uzvlfiNgDhn+KMiVCB6xYCZSoaPHz5wrba/cbuztpBWFvQLI+R2DSGZqleKNuJX2\
		  cVVjAIExDo/uV7pPjGhSNntrleI9+n7Ox33Y549Wq/ZWTyh8rNcfjPlaZ4xzZvUM\
		  ezrNvnJ+fXFCiL2k2rpQq2wnAqH4tYjZFyZq/Y8CKZoim51z1nIZQ4jGNIC5fZhz\
		  7fHA4JVuj26AyIWiMDSbdTi1L/T29RO7ahdfKgqbInJLANCKZ6Kx5J24dVowztW6\
		  Y+8WNt91FNYXc4WN988BzAL4QOT+Aj/x8GFf+MHI+UlI2cBS9kVlLZfxSFdMS9GY\
		  V1WtKETDPShhz85emLRHx++TETBLAJ4qCov8c7ajsZMr/5PtBQB3AXSpqsbagd8A\
		  O+HMRUtPNsQAAAAASUVORK5CYII=');
              }

              .activity_pane.hide .activity_pane_body{
                  display:none;
              }
              div.statustag{
                  box-shadow:4px 4px 3px #888888;
              }
          }


          @media print{
              *.reqid{
                  font-size:90%;
                  font-family:verdana, arial, helvetica, sans-serif;
              }
              *.req{
                  margin-left:0%;
                  margin-top:1em;
                  margin-bottom:1em;
              }
              *.reqdesc{
                  margin-left:20%;
              }
              div.activity_pane_body{
                  padding:1em;
                  border:2px solid #888888;
                  border-radius:3px;
                  display:block;
              }

	            img[src="images/collapsed.png"] { display:none;}

          }
    </style></head><body onLoad="init()"><h1 class="title" style="page-break-before:auto;">Functional Package for Transport Layer Security (TLS)</h1><noscript><h1 style="text-align:center; border-style: dashed; border-width: medium; border-color: red;">This page is best viewed with JavaScript enabled!</h1></noscript><div class="center"><img src="images/niaplogo.png" alt="NIAP Logo"></img><br/>
      Version: 2.1<br/>2025-03-05<br/><b>National Information Assurance Partnership</b><br/></div><h2 style="page-break-before:always;">Revision History</h2><table><tr class="header"><th>Version</th><th>Date</th><th>Comment</th></tr><tr><td>1.0</td><td>2018-12-17</td><td>First publication</td></tr>
<tr><td>1.1</td><td>2019-03-01</td><td>Clarifications regarding override for invalid certificates,
      renegotiation_info extension, <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> versions, and named Diffie-Hellman groups in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>
      contexts</td></tr>
<tr><td>2.0</td><td>2022-12-19</td><td>Added audit events, added <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>/<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 support, deprecated <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.0 and 1.1, updated algorithms/ciphersuites in accordance with CNSA suite <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> and to consider PSK, restructured <abbr class="dyn-abbr"><a href="#abbr_SFR">SFRs</a></abbr> for clarity</td></tr>
<tr><td>2.1</td><td>2025-03-05</td><td>Updated for <abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>:2022 conformance, incorporated applicable errata.</td></tr>
</table><h2>Contents</h2><div class="toc" id="toc"><a href="#Introduction" style="text-indent:0px">1<span>Introduction</span></a><a href="#Overview" style="text-indent:10px">1.1<span>Overview</span></a><a href="#glossary" style="text-indent:10px">1.2<span>Terms</span></a><a href="#cc-terms" style="text-indent:20px">1.2.1<span>Common Criteria Terms</span></a><a href="#tech-terms" style="text-indent:20px">1.2.2<span>Technical Terms</span></a><a href="#Compliant_Targets_of_Evaluation" style="text-indent:10px">1.3<span>Compliant Targets of Evaluation</span></a><a href="#Conformance_Claims" style="text-indent:0px">2<span>Conformance Claims</span></a><a href="#Security_Functional_Requirements" style="text-indent:0px">3<span>Security Functional Requirements</span></a><a href="#Auditable_Events_for_Mandatory_SFRs" style="text-indent:10px">3.1<span>Auditable Events for Mandatory SFRs</span></a><a href="#fcs" style="text-indent:10px">3.2<span>Cryptographic Support (FCS)</span></a><a href="#impl-reqs" style="text-indent:0px">Appendix A - <span>Implementation-dependent Requirements</span></a><a href="#ext-comp-defs" style="text-indent:0px">Appendix B - <span>Extended Component Definitions</span></a><a href="#ext-comp-defs-bg" style="text-indent:10px">B.1<span>Extended Components Table</span></a><a href="#ext-comp-defs-bg" style="text-indent:10px">B.2<span>Extended Component Definitions</span></a><a href="#ext-comp-FCS" style="text-indent:20px">B.2.1<span>Cryptographic Support (FCS)</span></a><a href="#ext-comp-FCS_TLS_EXT" style="text-indent:30px">B.2.1.1<span>FCS_TLS_EXT TLS Protocol</span></a><a href="#ext-comp-FCS_DTLSC_EXT" style="text-indent:30px">B.2.1.2<span>FCS_DTLSC_EXT DTLS Client Protocol</span></a><a href="#ext-comp-FCS_DTLSS_EXT" style="text-indent:30px">B.2.1.3<span>FCS_DTLSS_EXT DTLS Server Protocol</span></a><a href="#ext-comp-FCS_TLSC_EXT" style="text-indent:30px">B.2.1.4<span>FCS_TLSC_EXT TLS Client Protocol</span></a><a href="#ext-comp-FCS_TLSS_EXT" style="text-indent:30px">B.2.1.5<span>FCS_TLSS_EXT TLS Server Protocol</span></a><a href="#acronyms" style="text-indent:0px">Appendix C - <span>Acronyms</span></a><a href="#appendix-bibliography" style="text-indent:0px">Appendix D - <span>Bibliography</span></a></div><h1 class="indexable" data-level="1" id="Introduction">1 Introduction</h1>
    <h2 class="indexable" data-level="2" id="Overview">1.1 Overview</h2>
      <p>      
	  Transport Layer Security (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>) and the closely-related Datagram <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>) are
    cryptographic protocols designed to provide communications security over <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> networks.
    Several versions of the protocol are in widespread use in software that provides functionality
    such as web browsing, email, instant messaging, and voice-over-IP (VoIP).
    Major websites use <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> to protect communications to and from their servers.
    <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> is also used to protect communications between
    hosts and network infrastructure devices for administration.
    The underlying platform, such as an operating system, often provides the
    actual <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> implementation.
    The primary goal of the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> protocol is to
    provide confidentiality and integrity of data transmitted
    between two communicating endpoints, as well as authentication of at least
    the server endpoint.
    </p><p>
	  <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> supports many different methods for exchanging keys, encrypting data,
	  and authenticating message integrity. These methods are dynamically negotiated
    between the client and server when the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> connection is established.
    As a result, evaluating the implementation of both endpoints is typically
    necessary to provide assurance for the operating environment.
    </p><p>
	  This "Functional Package for Transport Layer Security" (short name "<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>-PKG")
    defines functional requirements for the implementation of the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>
    and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> protocols. The requirements are
    intended to improve the security of products by enabling their evaluation.
  </p>
    
    <div class="no-link"><h2 id="glossary" class="indexable" data-level="2">1.2 Terms</h2>
The following sections list Common Criteria and technology terms used in this document.
    <h3 id="cc-terms" class="indexable" data-level="3">1.2.1 Common Criteria Terms</h3><table><tr><td><div id="Assurance">Assurance</div></td><td>Grounds for confidence that a TOE meets the SFRs <a href="#bibCC">[CC]</a>.</td></tr>
<tr><td><div id="Base_Protection_Profile">Base Protection Profile (Base-PP)</div></td><td>Protection Profile used as a basis to build a PP-Configuration.</td></tr>
<tr><td><div id="Collaborative_Protection_Profile">Collaborative Protection Profile (cPP)</div></td><td>A Protection Profile developed by
    international technical communities and approved by multiple schemes.</td></tr>
<tr><td><div id="Common_Criteria">Common Criteria (CC)</div></td><td>Common Criteria for Information Technology Security Evaluation (International Standard ISO/IEC 15408).</td></tr>
<tr><td><div id="Common_Criteria_Testing_Laboratory">Common Criteria Testing Laboratory</div></td><td>
      Within the context of the Common Criteria Evaluation and Validation Scheme (CCEVS), an IT security evaluation facility
      accredited by the National Voluntary Laboratory Accreditation Program (NVLAP) and approved by the NIAP Validation Body to conduct Common Criteria-based evaluations.
    </td></tr>
<tr><td><div id="Common_Evaluation_Methodology">Common Evaluation Methodology (CEM)</div></td><td>Common Evaluation Methodology for Information Technology Security Evaluation.</td></tr>
<tr><td><div id="Distributed_TOE">Distributed TOE</div></td><td>A TOE composed of multiple components operating as a logical whole.</td></tr>
<tr><td><div id="Extended_Package">Extended Package (EP)</div></td><td>A deprecated document form for collecting SFRs that implement a particular protocol, technology,
	    or functionality. See Functional Packages.</td></tr>
<tr><td><div id="Functional_Package">Functional Package (FP)</div></td><td>A document that collects SFRs for a particular protocol, technology,
	    or functionality.</td></tr>
<tr><td><div id="Operational_Environment">Operational Environment (OE)</div></td><td>Hardware and software that are outside the TOE boundary that support the TOE functionality and security policy.</td></tr>
<tr><td><div id="Protection_Profile">Protection Profile (PP)</div></td><td>An implementation-independent set of security requirements for a category of products.</td></tr>
<tr><td><div id="Protection_Profile_Configuration">Protection Profile Configuration (PP-Configuration)</div></td><td>A comprehensive set of security requirements for a product type that consists of at least one Base-PP and at least one PP-Module.</td></tr>
<tr><td><div id="Protection_Profile_Module">Protection Profile Module (PP-Module)</div></td><td>An implementation-independent statement of security needs for a TOE type complementary to one or more Base-PPs.</td></tr>
<tr><td><div id="Security_Assurance_Requirement">Security Assurance Requirement (SAR)</div></td><td>A requirement to assure the security of the TOE.</td></tr>
<tr><td><div id="Security_Functional_Requirement">Security Functional Requirement (SFR)</div></td><td>A requirement for security enforcement by the TOE.</td></tr>
<tr><td><div id="Security_Target">Security Target (ST)</div></td><td>A set of implementation-dependent security requirements for a specific product.</td></tr>
<tr><td><div id="Target_of_Evaluation">Target of Evaluation (TOE)</div></td><td>The product under evaluation. </td></tr>
<tr><td><div id="TOE_Security_Functionality">TOE Security Functionality (TSF)</div></td><td>The security functionality of the product under evaluation.</td></tr>
<tr><td><div id="TOE_Summary_Specification">TOE Summary Specification (TSS)</div></td><td>A description of how a TOE satisfies the SFRs in an ST.</td></tr>
</table><h3 id="tech-terms" class="indexable" data-level="3">1.2.2 Technical Terms</h3><table style="width: 100%"><tr><td><div id="Calling_application">Calling application</div></td><td>A TOE application that utilizes functions defined in this package to secure its communications with external entities</td></tr>
<tr><td><div id="Certificate_Authority">Certificate Authority (CA)</div></td><td>
	      Issuer of digital certificates.
      </td></tr>
<tr><td><div id="Common_Name">Common Name (CN)</div></td><td>A particular relative distinguished name (DN) that is a component of a DN in accordance with RFC 5280 usage of RFC 4519, interpreted as a string without further normalization. It is common, but not recommended, for TLS and the calling applications to interpret a CN entry using specific formatting. When such formatting is applied for interpreting a CN entry, the resulting name is referred to as an 'embedded CN name'. The various formats supported for interpreting CN entries are referred to as the 'embedded CN name types'.</td></tr>
<tr><td><div id="Datagram_Transport_Layer_Security">Datagram Transport Layer Security (DTLS)</div></td><td>
	      Cryptographic network protocol, based on TLS, which provides
              communications security for datagram protocols.
	    </td></tr>
<tr><td><div id="Presented_identifier">Presented identifier</div></td><td>A piece of data supplied by an external entity to identify itself to the calling application via an X.509 certificate as part of the (D)TLS handshake. The certificate may include one or more identifiers in the subject field of the certificate or in the Subject Alternative Name (SAN) extension. The presented identifier is compared to the reference identifier to determine the validity of the external entity.</td></tr>
<tr><td><div id="Reference_identifier">Reference identifier</div></td><td>A piece of data defined by a calling application that is used to specify how an external entity is expected to present itself (such as the DNS name of a server that presents a certificate to the TOE). </td></tr>
<tr><td><div id="Transport_Layer_Security">Transport Layer Security (TLS)</div></td><td>
        Cryptographic network protocol for providing communications
        security over a TCP/IP network.
      </td></tr>
</table></div>

    <h2 class="indexable" data-level="2" id="Compliant_Targets_of_Evaluation">1.3 Compliant Targets of Evaluation</h2>
      <p>
      The Target of Evaluation
      (<abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>) in this Package is a product that acts as a (D)<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client, a (D)<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server, or both.
      This Package describes the security functionality of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> in terms of   <a href="#bibCC">[CC]</a>. 
      </p><p>
      The contents of this Package must be appropriately
      combined with a <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>.
      When this Package is instantiated by a <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>, the Package must
      include selection-based requirements in accordance with the
      selections or assignments indicated in the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>.  These may be expanded by the
      <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author.
      </p><p>
      The <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> which instantiates this Package must typically include
      the following components in order to satisfy dependencies of this Package. It is the responsibility
      of the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> author who instantiates this Package to ensure that dependence
      on these components is satisfied:<br/>
      <table><tr class="header"><th>Component</th><th>Explanation</th></tr><tr><td class="componentneeded" id="FCS_CKM.1"><span class="no-link">FCS_CKM.1</span></td><td>To support <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ciphersuites that use <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> for key exchange, the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> must
            include <a href="#FCS_CKM.1">FCS_CKM.1</a> and specify the corresponding key generation algorithm.<br/></td></tr><tr><td class="componentneeded" id="FCS_CKM.2"><span class="no-link">FCS_CKM.2</span></td><td>To support <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ciphersuites that use <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> for key exchange, the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> must
          include <a href="#FCS_CKM.2">FCS_CKM.2</a> and specify the corresponding algorithm.<br/></td></tr><tr><td class="componentneeded" id="FCS_COP.1"><span class="no-link">FCS_COP.1</span></td><td>To support <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ciphersuites that use <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr> for encryption and decryption, the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>
          must include <a href="#FCS_COP.1">FCS_COP.1</a> (iterating as needed) and specify <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr> with corresponding key sizes and modes. To
          support <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ciphersuites that use <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr> for hashing, the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> must include <a href="#FCS_COP.1">FCS_COP.1</a>
          (iterating as needed) and specify <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr> with corresponding digest sizes.
        <br/></td></tr><tr><td class="componentneeded" id="FCS_RBG.1"><span class="no-link">FCS_RBG.1</span></td><td>To support random bit generation needed for SSH key generation,
            the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> must include <a href="#FCS_RBG.1">FCS_RBG.1</a> or an extended <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> that defines comparable functionality.<br/></td></tr><tr><td class="componentneeded" id="FIA_X509_EXT.1"><span class="no-link">FIA_X509_EXT.1</span></td><td>
          To support validation of certificates needed during <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> connection setup,
          the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> must include <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>.
        <br/></td></tr><tr><td class="componentneeded" id="FIA_X509_EXT.2"><span class="no-link">FIA_X509_EXT.2</span></td><td>To support the use of X509 certificates for authentication in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> connection setup,
          the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> must include <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a>.
          <br/></td></tr></table>
    </p><p>
      An <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must identify the applicable version of the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or
      <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> and this Package in its conformance claims.
      </p>
      
    

  <h1 class="indexable" data-level="1" id="Conformance_Claims">2 Conformance Claims</h1>
    
    <dl><dt>Conformance Statement</dt><p></p><dd>An <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must claim exact conformance 
		 to this Functional Package.</dd><p></p><dd>The evaluation methods used for evaluating the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> are a combination of the workunits 
			defined in <a href="#bibCEM">[CEM]</a> as well as the Evaluation Activities for ensuring that individual <abbr class="dyn-abbr"><a href="#abbr_SFR">SFRs</a></abbr> 
			and <abbr class="dyn-abbr"><a href="#abbr_SAR">SARs</a></abbr> have a sufficient level of supporting evidence in the Security Target and guidance 
			documentation and have been sufficiently tested by the laboratory as part of completing 
			ATE_IND.1. Any functional packages this <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> claims similarly contain their own Evaluation 
			Activities that are used in this same manner.
			</dd><dt>CC Conformance Claims</dt><p></p><dd>This Functional Package is conformant to 
			Part 2 (extended) 
			
			
				of Common Criteria <abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>:2022, Revision 1.
			</dd><dt>PP Claim</dt><p></p><dd>
					This Functional Package does not claim conformance to 
					any Protection Profile.
				</dd><p></p><dd>There are no <abbr class="dyn-abbr"><a href="#abbr_PP">PPs</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>-Modules that are allowed in a <abbr class="dyn-abbr"><a href="#abbr_PP-Configuration">PP-Configuration</a></abbr> 
					with this Functional Package.</dd><dt>Package Claim</dt><p></p><dd>This Functional Package is not conformant to any 
						Functional or Assurance Packages.</dd></dl>	
    
    
  <h1 class="indexable" data-level="1" id="Security_Functional_Requirements">3 Security Functional Requirements</h1>
      This chapter describes the security requirements which have to be fulfilled by the product under evaluation.
      Those requirements comprise functional components from Part 2 of <a href="#bibCC">[CC]</a>.
 
       
    The following conventions are used for the completion of operations:
     <ul>
       <li>
         <b>Refinement</b> operation (denoted by <b>bold text</b> or <strike>strikethrough
         text</strike>): Is used to add details to a requirement or to remove part of the requirement that is made irrelevant
         through the completion of another operation, and thus further restricts a requirement.
         </li>
       <li>
         <b>Selection</b> (denoted by <i>italicized text</i>): Is used to select one or more options
         provided by the [<abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>] in stating a requirement.</li>
       <li>
         <b>Assignment</b> operation (denoted by <span class="assignable-content">italicized text</span>): Is used to assign a
         specific value to an unspecified parameter, such as the length of a password. Showing the
         value in square brackets indicates assignment.</li>
       <li>
         <b>Iteration</b> operation: Is indicated by appending the <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> name with a slash and unique identifier
            suggesting the purpose of the operation, e.g. "/EXAMPLE1."
       </li>
     </ul>
   
 
	  
 <h2 class="indexable" data-level="2" id="Auditable_Events_for_Mandatory_SFRs">3.1 Auditable Events for Mandatory SFRs</h2>
   <p>
     The auditable events specified in this Functional Package are included in a Security Target 
     if the incorporating <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> supports audit event reporting through FAU_GEN.1 and all other criteria in the incorporating
     <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> are met. 
     
     Note that, if "None" is not selected in the "Auditable Events" column, it should not be selected in the "Additional Audit Record Contents" column. 
     Likewise, if "None" is selected in the "Auditable Events" column, it should also be selected in the "Additional Audit Record Contents" column.
   </p>
   <table class="sort_kids_" border="1"><caption data-sortkey="#0"><span class="ctr" data-myid="t-audit-mandatory" data-counter-type="ct-Table" id="t-audit-mandatory">Table <span class="counter">1</span></span>: Auditable Events for Mandatory Requirements</caption><tr data-sortkey="#1"><th>Requirement</th><th>Auditable Events</th><th>Additional Audit Record Contents</th></tr><tr data-sortkey="FCS_TLS_EXT.1"><td rowspan="2"><a href="#FCS_TLS_EXT.1">FCS_TLS_EXT.1</a></td><td style="display:none"></td></tr><tr style="display:none;" data-sortkey="FCS_TLS_EXT.1#"><td></td></tr><tr data-sortkey="FCS_TLS_EXT.1.1"><td>No events specified</td><td>N/A</td></tr></table>

 
 <h2 id="fcs" class="indexable" data-level="2">3.2 Cryptographic Support (FCS)</h2>

        

   
   
        <div class="comp" id="FCS_TLS_EXT.1"><h4>FCS_TLS_EXT.1 TLS Protocol</h4>
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_TLS_EXT.1.1"><a href="#FCS_TLS_EXT.1.1" class="abbr">FCS_TLS_EXT.1.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement
        [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="tlsc_impl"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a client</span></li><li style=""><span class="selectable-content" id="tlss_impl"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a server</span></li><li style=""><span class="selectable-content" id="dtlsc_impl"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a client</span></li><li style=""><span class="selectable-content" id="dtlss_impl"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a server</span></li></ul>].
        <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              If <i><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a client</i> is selected, then the
              <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the requirements from <a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a> and <a href="#FCS_TLSC_EXT.4">FCS_TLSC_EXT.4</a>.
              <br/>
              If <i><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a server</i> is selected, then the
              <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the requirements from <a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a> and <a href="#FCS_TLSS_EXT.4">FCS_TLSS_EXT.4</a>.
              <br/><br/>
              If <i><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a client</i> is selected, then the
              <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the requirements from <a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a> and <a href="#FCS_DTLSC_EXT.4">FCS_DTLSC_EXT.4</a>.
              <br/>
              If <i><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a server</i> is selected, then the
              <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the requirements from <a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a> and <a href="#FCS_DTLSS_EXT.4">FCS_DTLSS_EXT.4</a>.
            </span></div></div></div>
	  
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLS_EXT.1">FCS_TLS_EXT.1</a></div>
              
	      
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to verify that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> claims are consistent with those selected in the <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> (e.g., if <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a> claims "<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a client," the evaluator shall ensure that <a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a> is claimed as part of the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> at minimum).
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea">
			There are no additional Guidance evaluation activities for this component.<br/></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                <p>
                There are no test activities for this <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr>; the following information is provided as an overview of the expected functionality and test environment for all subsequent <abbr class="dyn-abbr"><a href="#abbr_SFR">SFRs</a></abbr>.
                </p>
                
                <p>
                <b>Test Environment:</b>
                </p><p>
                Tests for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 include examination of the handshake messages and behavior of the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> when presented with unexpected or invalid messages. 
                For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and below, previous versions of this Functional Package only required visibility of network traffic and the ability to modify a valid handshake message sent to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>.
                </p><p>
                <div class="figure" id="figure-Figure2"><img id="Figure2" src="images/figure2.png" width="" height=""></img><br/><span class="ctr" data-myid="Figure2" data-counter-type="ct-figure">Figure <span class="counter">1</span></span>:
      Test environment for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 using network traffic visibility and control tools</div>
                </p><p>
                <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 introduces the encryption of handshake messages subsequent to the ServerHello exchange which prevents visibility and control using midpoint capabilities. 
                To achieve equivalent validation of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 requires the ability to modify the traffic underlying the encryption applied after the ServerHello message. 
                This can be achieved by introducing additional control of the messages sent, and visibility of messages received by the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client, 
                (when validating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server functionality) or the test server (when validating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client functionality).
                </p><p>
                <div class="figure" id="figure-Figure3"><img id="Figure3" src="images/figure3.png" width="" height=""></img><br/><span class="ctr" data-myid="Figure3" data-counter-type="ct-figure">Figure <span class="counter">2</span></span>:
      Test environment for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 using custom endpoint capabilities for visibility and control</div>
                </p><p>
                Typically, a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 library modified to provide visibility and control of the handshake messages prior to encryption suffices for all tests. 
                Such modification will require the test client, test server, or both to be validated. 
                </p><p>
                Since validations of products supporting only <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 are still expected under this Package, 
                the test environment for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2-only validations may include network sniffers and man-in-the-middle products that do not require such 
                modifications to a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 library. 
                For consistency, a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client (or <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server) together with the network sniffers and man-in-the-middle capabilities 
                will also be referred to as a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client (or test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server, respectively) in the following evaluation activities.
                </p>
                <div class="figure" id="figure-Figure4"><img id="Figure4" src="images/figure4.png" width="" height=""></img><br/><span class="ctr" data-myid="Figure4" data-counter-type="ct-figure">Figure <span class="counter">3</span></span>:
      Combined test environment for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 using both network tools and custom endpoint capabilities</div>
                 
              </div></div></div></div></div>

 
   
   
   
  <div class="comp" id="FCS_DTLSC_EXT.1"><h4>FCS_DTLSC_EXT.1 DTLS Client Protocol</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
      </i></b></div>
    
    
    
    
    
     
    
    <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.1.1"><a href="#FCS_DTLSC_EXT.1.1" class="abbr">FCS_DTLSC_EXT.1.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement
      [<b>selection</b>: <span class="selectable-content" id="_s_5"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6347)</span>, <span class="selectable-content" id="_s_6"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147)</span>] as a client that supports additional functionality for session renegotiation protection and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="dtlsc_mutual_auth">mutual authentication</span></li><li style=""><span class="selectable-content" id="dtlsc_downgrade_protection">supplemental downgrade protection</span></li><li style=""><span class="selectable-content" id="dtlsc_resumption">session resumption</span></li><li style=""><span class="selectable-content" id="_s_10">no optional functionality</span></li></ul>] and shall abort attempts by a server to negotiate all other <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> versions.
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
          This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a client" is selected in <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
        </p><p>
        The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author will claim supported <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> versions and optional functionality as appropriate for the claimed versions. 
        </p><p>
        Session renegotiation protection is required for both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, and the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> must include the requirements from <a href="#FCS_DTLSC_EXT.4">FCS_DTLSC_EXT.4</a>. 
        Within <a href="#FCS_DTLSC_EXT.4">FCS_DTLSC_EXT.4</a>, options for implementation of secure session renegotiation in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 or rejecting renegotiation requests
        required in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and optionally supported in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 are claimed.  
        </p><p>
        If "mutual authentication" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> must additionally include the requirements from <a href="#FCS_DTLSC_EXT.2">FCS_DTLSC_EXT.2</a>. 
        If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> with mutual authentication, this selection must be made.
        </p><p>
        If "supplemental downgrade protection" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> must additionally include the requirements from <a href="#FCS_DTLSC_EXT.3">FCS_DTLSC_EXT.3</a>. 
        This is claimed when both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 are supported and the client uses the method to reject downgrade. Note that <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1
        or below downgrade protection in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> is used to notify a client that the server is capable of supporting <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 or <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, when
        it negotiates a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0 session because it received a ClientHello indicating maximum support for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0 (there is no <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version 1.1).
        Since this <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> does not allow negotiation of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0, it is not necessary to claim such support.
        </p><p>
        If "session resumption" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> must additionally include the requirements from <a href="#FCS_DTLSC_EXT.5">FCS_DTLSC_EXT.5</a>. 
        </p><p>
        <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version numbers are denoted on the wire as the 1’s complement of the corresponding textual <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> versions as described in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6347, Section 4.1. 
        <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version 1.2 is 0xfefd; <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version 1.3 is 0xfefc. 
        </p>
      </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.1.2"><a href="#FCS_DTLSC_EXT.1.2" class="abbr">FCS_DTLSC_EXT.1.2</a></div><div class="reqdesc">
          The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_11"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites: [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_12">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8422</span></li><li style=""><span class="selectable-content" id="_s_13">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8422</span></li><li style=""><span class="selectable-content" id="_s_14">TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5288</span></li><li style=""><span class="selectable-content" id="_s_15">TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5288</span></li><li style=""><span class="selectable-content" id="_s_16">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289</span></li><li style=""><span class="selectable-content" id="_s_17">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289</span></li><li style=""><span class="selectable-content" id="_s_18">ciphersuites using pre-shared secrets:
            [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_19">TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442</span></li><li style=""><span class="selectable-content" id="_s_20">TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487</span></li><li style=""><span class="selectable-content" id="_s_21">TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487</span></li></ul>]</span></li></ul>]
              and shall not offer other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites,</span></li><li style=""><span class="selectable-content" id="_s_22"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites: [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_23">TLS_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span></li><li style=""><span class="selectable-content" id="_s_24">[<b>assignment</b>: 
     <span class="assignable-content">other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites</span>]</span></li></ul>]</span></li></ul>]
          offering the supported ciphersuites in a ClientHello message in preference order:
          [<b>assignment</b>: 
     <span class="assignable-content">list of supported ciphersuites</span>].
        <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
        <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> uses <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ciphersuites. The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author should select the ciphersuites that are supported, and must select at least one ciphersuite 
        for each <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version supported – <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3. Pre-shared secret ciphersuites for
        <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 are only claimed as required by a specific <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>.
        </p>
        <p>
          While mandatory for <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, TLS_AES_128_GCM_SHA256 is deprecated by this <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> and should not be included in “other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 
          ciphersuites.” The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author may list additional <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites as they are registered.
        </p>
        <p>
          In addition to the supported ciphersuites, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates the order of ciphersuites included in the ClientHello, 
          indicating the preferred ciphersuites for server negotiation. To eliminate the need to produce duplicate lists, it is recommended to complete the selected list of ciphersuites in the order that they are presented and then complete the following assignment by saying that the presentation order is the same as in the previous list. It is recommended, but not required, that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites
          claimed are listed before <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites, and that any other ciphersuites are listed last among the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites.
        </p>
      </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.1.3"><a href="#FCS_DTLSC_EXT.1.3" class="abbr">FCS_DTLSC_EXT.1.3</a></div><div class="reqdesc">
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not offer ClientHello messages indicating the following: 
        <ul>
          <li>null encryption</li>
          <li>support for anonymous servers</li>
          <li>use of deprecated or export-grade cryptography including DES, 3DES, RC2, RC4, or IDEA for encryption</li>
          <li>use of MD-5 or <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr>-1 for key derivation.</li>
        </ul> and shall abort sessions where a server attempts to negotiate cryptographic options not enumerated in the ClientHello
        message.
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
          This element explicitly excludes ciphersuites defined for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and previous <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> or SSL versions that might be included in the 
          ClientHello from a <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> that supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 (as the only supported version, or as a fallback version for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 clients 
          negotiating with potential <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 servers). The requirement also constrains the choice of "other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites" when
          <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported. In addition, this requirement prohibits Using Raw Public Keys in Transport Layer Security and Datagram
          Transport Layer Security (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7250) for server certificates.
        </p>
        <p>
          Ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 are of the form TLS_(key exchange algorithm)_WITH_(encryption algorithm)_(message digest algorithm), and
          are listed in the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters section of the internet assignments at iana.org. This requirement constrains the value of 
          (encryption algorithm) and (message digest algorithm).
        </p>
        <p>
          Ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 are of the form TLS_(AEAD)_(HASH), where (AEAD) is of the form (encryption algorithm)_(symmetric key 
          length)_(mode) for an authenticated encryption with associated data specification (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5116). This requirement constrains the 
          value of the (encryption algorithm) component of (AEAD) and the value of (HASH). 
        </p>
      </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.1.4"><a href="#FCS_DTLSC_EXT.1.4" class="abbr">FCS_DTLSC_EXT.1.4</a></div><div class="reqdesc">
      The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ClientHello message extensions: 
      <ul>
        <li>signature_algorithms extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for 
          [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_25">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_26">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_27">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_28">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_29">no other signature algorithms</span></li></ul>] and
        </li>
      </ul>
          [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_30">signature_algorithms_cert extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_31">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_32">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_33">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_34">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_35">no other signature algorithms</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_36">supported_versions extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and [<b>selection</b>: <span class="selectable-content" id="_s_37"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2</span>, <span class="selectable-content" id="_s_38">no other versions</span>]</span></li><li style=""><span class="selectable-content" id="_s_39">supported_groups extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7919, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_40">secp384r1</span></li><li style=""><span class="selectable-content" id="_s_41">secp521r1</span></li><li style=""><span class="selectable-content" id="_s_42">ffdhe3072(257)</span></li><li style=""><span class="selectable-content" id="_s_43">ffdhe4096(258)</span></li><li style=""><span class="selectable-content" id="_s_44">ffdhe6144(259)</span></li><li style=""><span class="selectable-content" id="_s_45">ffdhe8192(260)</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_46">key_share extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_47">post_handshake_auth (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446), pre_shared_key (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446), and psk_key_exchange_modes (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating psk_dhe_ke
              (<abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr>) mode</span></li><li style=""><span class="selectable-content" id="_s_48">extended_master_secret extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7627) enforcing server support, and
              [<b>selection</b>: <span class="selectable-content" id="_s_49">allowing legacy servers</span>, <span class="selectable-content" id="_s_50">no other enforcement mode</span>]</span></li><li style=""><span class="selectable-content" id="_s_51">no other extensions</span></li></ul>]
          and shall not send the following extensions: <ul>
            <li>early_data</li>
            <li>psk_key_exchange_modes indicating PSK only mode.</li>
          </ul>
    <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
          <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> uses <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extensions.
        </p>
        <p>
          Support for the signature_algorithms extension is optional in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246 but is mandated for this functional package. Support for the signature_algorithms extension is mandatory in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 and remains so in this functional package. Whether the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>'s implementation conforms to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, or both is dependent on whether the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, or both.
        </p>
        <p>
          If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is claimed in <a href="#FCS_DTLSC_EXT.1.1">FCS_DTLSC_EXT.1.1</a>, supported_versions, supported_groups, and key_share extensions are claimed in 
          accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is not claimed, supported_versions and key_share extensions are not claimed.
        </p>
        <p>
          If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is
          claimed, extended_master_secret extension is claimed, with the ability to enforce server support, and optionally, the ability to 
          support legacy servers. 
        </p><p>
          If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported and if <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites are claimed in <a href="#FCS_DTLSC_EXT.1.2">FCS_DTLSC_EXT.1.2</a>, the supported_groups extension is claimed here with appropriate secp and ffdhe groups claimed.
        </p>
        
        <p>
          Other extensions may be supported; certain extensions and values may need to be claimed for <abbr class="dyn-abbr"><a href="#abbr_SFR">SFRs</a></abbr> defined outside of this package related to the calling applications.
        </p>
     
    </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.1.5"><a href="#FCS_DTLSC_EXT.1.5" class="abbr">FCS_DTLSC_EXT.1.5</a></div><div class="reqdesc">
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_57">verify that a presented identifier of name type: [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_58">dNSName according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span></li><li style=""><span class="selectable-content" id="_s_59">uniformResourceIdentifier according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span></li><li style=""><span class="selectable-content" id="_s_60">SRVname according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span></li><li style=""><span class="selectable-content" id="_s_61">Common Name conversion to dNSName according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span></li><li style=""><span class="selectable-content" id="_s_62">directoryName according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280</span></li><li style=""><span class="selectable-content" id="_s_63">iPAddress according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280</span></li><li style=""><span class="selectable-content" id="_s_64">rfc822Name according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280</span></li><li style=""><span class="selectable-content" id="_s_65">[<b>assignment</b>: 
     <span class="assignable-content">other name type</span>] according to [<b>assignment</b>: 
     <span class="assignable-content"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> number</span>]</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_66">interface with a supported function requesting the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel to verify that a presented identifier</span></li><li style=""><span class="selectable-content" id="_s_67">pass initial name constraints to the certification path processing function to verify, in accordance with
          <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>, that the presented identifier</span></li></ul>] 
        matches a reference identifier for the requested <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server and shall abort the session if no match is found.
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
          The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims the supported options for verifying that the server is associated with an expected reference identifier. The first option is claimed if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> implements name matching. The option “interface with a supported function…” is claimed if the validated certification path, names extracted from the subject field and/or subject alternate name extension of a leaf certificate of a validated certification path, or normalized representations of names extracted from the leaf certificate are passed to a supported function for matching. The option “pass initial name constraints…” is claimed if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> formulates initial name constraints from the reference identifiers used by the certification path processing function. The final option is claimed if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and PSK ciphersuites are supported, and is used to associate the shared PSK with a known identifier.
        </p>
        <br/><br/>
        <p>
          If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> matches names, the rules for verification of identity are described in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125, Section 6 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280, Section 7. If "Common name conversion..."
          is claimed, both the subject field and the converted common name are matched. The reference identifier is established by the user
          (e.g., entering a <abbr class="dyn-abbr"><a href="#abbr_URL">URL</a></abbr> into a web browser or clicking a link), by configuration (e.g., configuring the name of a mail or 
          authentication server), or by an application (e.g., a parameter of an API) depending on the supported function. The client 
          establishes all acceptable reference identifiers for matching against the presented identifiers as validated in the server’s
          certificate. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> performs matching of the reference identifiers to the identifiers provided in the server’s certificate, the
          first option is claimed and all supported name types are claimed. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> presents the certificate, or the presented identifiers
          from the certificate to the supported function, the second option is claimed. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> constructs initial name constraints
          derived from the reference identifiers for validation during certification path validation, the third option is claimed.
        </p>
        <p>
          In most cases where <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> servers are represented by <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>-type names, the preferred method for verification is the Subject Alternative
          Name using <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or Service Names. Verification using a conversion of the Common Name relative distinguished name from a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>
          name type in the subject field is allowed for the purposes of backward compatibility.
        </p>
        <p>
          The client should avoid constructing reference identifiers using wildcards. However, if the presented identifiers include wildcards,
          the client must follow the best practices regarding matching; these best practices are captured in the evaluation activity. If the
          <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports wildcards and allows names with <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portions containing internationalized names, the internationalized name should not
          match any wildcard, in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125 section 7.2.
        </p>
        <p>
          Support for other name types is rare, but may be claimed for specific applications. If specified, the assignment includes both the
          <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> describing normalization and matching rules and any refinements necessary to resolve options available in the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr>.
        </p>
      </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.1.6"><a href="#FCS_DTLSC_EXT.1.6" class="abbr">FCS_DTLSC_EXT.1.6</a></div><div class="reqdesc">
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a trusted channel if the server certificate is invalid [<b>selection</b>: <span class="selectable-content" id="s-dtlsc-no-excep">with no <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>-specific exceptions</span>, <span class="selectable-content" id="_s_72">except when override is authorized in accordance with [<b>assignment</b>: 
     <span class="assignable-content">override rules</span>]in the case where valid revocation information is not available</span>]. 
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
          The option “except when…” is claimed if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> specific exception rules are implemented to allow server certificates with no valid
          revocation status information to be accepted. This is claimed only when <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a>.2 includes the option “supported function
          determines acceptance via…”. The assignment for when override is authorized describes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>-specific processing to include the privileged users authorized to configure an override, and the duration of an override. It is preferred that overrides are minimized in scope and time. Otherwise, “with no
          <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>-specific exceptions” is claimed.
        </p>
        <p>
          Note that <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> may allow methods other than CRL or OCSP to validate the revocation status of a certificate. A
          certificate that exclusively uses these alternate methods may not advertise revocation status information locations. Thus, a
          certificate that is valid according to <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> and does not advertise revocation status information in a CRL_DP or AIA
          extension is considered to be not revoked. <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>-specific override mechanisms are for use with certificates with published
          revocation status information that is not accessible, whether temporarily or because the information cannot be accessed during the
          state of the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> (e.g., for verifying signatures on boot code). The circumstances should be described by the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author, who should
          indicate the override mechanism and conditions that apply to the override, including system state, user or admin actions, etc.
        </p>
      </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.1.7"><a href="#FCS_DTLSC_EXT.1.7" class="abbr">FCS_DTLSC_EXT.1.7</a></div><div class="reqdesc">
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall [<b>selection</b>: <span class="selectable-content" id="_s_73">terminate the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session</span>, <span class="selectable-content" id="_s_74">silently discard the record</span>]
        if a message received contains an invalid MAC or if decryption fails in the case of <abbr class="dyn-abbr"><a href="#abbr_GCM">GCM</a></abbr> and other AEAD ciphersuites.
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
        All supported responses are claimed; at least one option is claimed. 
        </p>
      </span></div></div></div>
    
    
    
  <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a></div>
        
        
        
      <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
          <p>
            The evaluator shall check the description of the implementation of this protocol in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure the supported <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> versions,
            features, ciphersuites, and extensions are specified in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6347 (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2) and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147 (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and updates to
            <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2) and as refined in <a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a> as appropriate. 
          </p>
          <p>
            The evaluator shall verify that ciphersuites indicated in <a href="#FCS_DTLSC_EXT.1.2">FCS_DTLSC_EXT.1.2</a> are included in the description, and that none of the
            following ciphersuites are supported: ciphersuites indicating NULL, RC2, RC4, DES, IDEA, TDES, or <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>-128 in the encryption
            algorithm component, indicating 'anon,' or indicating MD5 or <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr> in the message digest algorithm component.
          </p>
          <p>
            The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> implementation description includes the extensions as required in <a href="#FCS_DTLSC_EXT.1.4">FCS_DTLSC_EXT.1.4</a>.
          </p>
          <p>
            The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes applications that use the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> functions and how they establish reference
            identifiers.
          </p>
          <p>
            If name matching is supported, the evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> includes a description of matching methods used for each
            supported name type to the supported application defined reference identifiers. The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> includes a
            description of wildcards recognized for each name type claimed in <a href="#FCS_DTLSC_EXT.1.5">FCS_DTLSC_EXT.1.5</a>, if any, and shall verify that the matching rules meet
            or exceed best practices. In particular, the evaluator shall ensure that the matching rules are as restrictive as, or more
            restrictive than the following: 
            <ul>
              <li><abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> names: The ‘*’ character used in the complete leftmost label of a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name represents any valid name that has the
                same number of labels, and that matches all remaining labels. The ‘*’ character must only be used in the leftmost complete
                label of a properly formatted <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name. The ‘*’ must not be used to represent a public suffix, or in the leftmost label
                immediately following a public suffix. </li>
              <li><abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr> or SRV names: The ‘*’ character can only occur in the domain name portion of the name represented as a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name. All
                restrictions for wildcards in <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> names apply to the <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion of the name. <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr> host names presented as an <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address are
                matched according to <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address matching rules – see best practices for <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses below. In accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125, it
                is preferred that such URIs are presented a matching name of type <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address in the <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr>.</li>
              <li><abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses: <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280 does not support <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address ranges as presented names, but indicates that presented names may be
                compared to <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address ranges present in name constraints. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address ranges as reference identifiers,
                the reference identifier matches if the presented name is in the range. <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> ranges in name constraints (including reference
                identifiers) should be presented in CIDR format. </li>
              <li><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822 names: <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280 and updates <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8398 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8399 do not support special indicators representing more that a 
                a single mailbox as a presented name, but indicates that presented names may be compared to a single mailbox, ‘any’ email
                address at a host, or ‘any’ email address on a domain (e.g., “example.com” matches any email address on the host example.com
                and “.example.com” matches any email address in the domain example.com, but does not match email addresses at the host
                “example.com”). Such matching is prohibited for internationalized <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822 names.</li>
              <li>Embedded <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> name types: The <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> relative distinguished name of a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name type included in the subject field is not
                strongly typed. Attempts to match both the name type and wildcard specifications can result in matches not intended, and
                therefore, not authoritatively asserted by a certification authority. It is preferred that no matching of <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> embedded names
                be supported, but if necessary for backward compatibility, the description should clearly indicate how different name types
                are interpreted in the matching algorithm. If an embedded <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> is present, the <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr> structure containing the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> as an RDN is
                matched, and the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> component is further matched according to the specific rules for the implied name type. In particular,
                the ‘*’ character in a <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> is not to be interpreted as representing more than a single entity unless the entirety of the RDN
                is properly formatted as a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or SVR name, and represents a wildcard meeting best practices as described above.</li>
            </ul>
          </p>
          <p>
            If name types are passed to the supported functions, the evaluator shall verify that for each claimed supported function, the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> includes a description of the information used to validate the identifier that is passed to that function. 
          </p>
          <p>
            If name constraints are passed to the certificate verification function, the evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the
            initial allow and deny tables for each reference identity reference name supported.
          </p>
          <p>        
            The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address is validated prior to issuing a ServerHello
            message.
            <p>
              If override rules are claimed in <a href="#FCS_DTLSC_EXT.1.6">FCS_DTLSC_EXT.1.6</a>, the evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> identifies the subjects authorized to configure the override as well as the scope or duration of any overrides.
            </p>
          </p>
            The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the actions that take place if a message received from the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server fails
            the integrity check. If both selections are chosen in <a href="#FCS_DTLSC_EXT.1.7">FCS_DTLSC_EXT.1.7</a>, the evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes when
            each method is used and whether the behavior is configurable. 
        </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
          <p>
            The evaluator shall check the operational guidance to ensure that it contains instructions on configuring the product so that
            <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> conforms to the description in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and that it includes any instructions on configuring the version, ciphersuites, or
            optional extensions that are supported.
          </p>
          <p>
            The evaluator shall verify that all configurable features for matching identifiers in certificates presented in the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>
            handshake to application specific reference identifiers are described.
          </p>
          <p>
            If override rules are claimed in <a href="#FCS_DTLSC_EXT.1.6">FCS_DTLSC_EXT.1.6</a>, the evaluator shall verify the operational guidance has instructions for applying them.
          </p>
          <p>
            If the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> indicates the behavior of the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> on receiving a message from the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that fails the MAC integrity check is
            configurable, the evaluator shall verify that the guidance documentation describes instructions for configuring the behavior.
          </p>
        </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
          The evaluator shall perform the following tests.
          <span class="testlist-"><ul>
                
                <li class="test-"><a id="dtls-client-supported-configurations" class="defined" href="#dtls-client-supported-configurations">Test FCS_DTLSC_EXT.1:1</a>:
      (supported configurations) For each supported version, and for each supported
                  ciphersuite associated with the version:
                  <p>
                  The evaluator shall establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> connection between the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that is configured to negotiate the
                  tested version and ciphersuite in accordance with the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> for the version.
                  </p>
                  <p>
                  The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> presents a ClientHello indicating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 (value 'fe fd') in the highest or
                  legacy version field and, if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported, the "supported versions" extension is present and contains the value
                  'fe fc' for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3
                  </p>
                  <p>
                  The evaluator shall observe that the ClientHello indicates the supported ciphersuites in the order indicated, and that it 
                  includes only the extensions supported, with appropriate values, for that version in accordance with the requirement.
                  </p>
                  <p>
                  The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> successfully completes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake.
                  </p>
                  <p>
                  <b>Note:</b> The highest version field is renamed to the legacy version field for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3. Regardless of the versions
                  supported, this field is required to indicate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2. If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the ClientHello
                  should indicate all ciphersuites and all extensions as required for either version. In particular, the supported versions
                  extension is required and must include the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 value ('fe fc') and may also include the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 indicator ('fe fd').
                  </p>
                  <p>
                  If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is configurable to support only <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, only <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, or both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3,
                  <a href="#dtls-client-supported-configurations" class="dynref">Test FCS_DTLSC_EXT.1:1</a> should be performed in each configuration, with ciphersuites and
                  extensions appropriate for the configured version.
                  </p>
                  <p>
                  The connection in <a href="#dtls-client-supported-configurations" class="dynref">Test FCS_DTLSC_EXT.1:1</a> may be established as part of the establishment of a
                  higher-level protocol, (e.g., as part of an <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> session). 
                  </p>
                  <p>
                  It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not
                  necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used 
                  (for example, that the cryptographic algorithm is 128-bit <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr> and not 256-bit <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>).
                  </p>
                </li>
                
                
            <li class="test-"><a id="dtls-client-obsolete-versions" class="defined" href="#dtls-client-obsolete-versions">Test FCS_DTLSC_EXT.1:2</a>:
      (obsolete versions) The evaluator shall perform the following tests:
                
                <span class="testlist-"><ul>                  
                    <li class="test-"><a id="dtls-client-obsolete-versions" class="defined" href="#dtls-client-obsolete-versions">Test FCS_DTLSC_EXT.1:2.1</a>:
      For each of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 if it is not supported, the evaluator shall
                      initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> connection from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that is configured to negotiate the obsolete version and
                      observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the connection.
                      <p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                        the evaluator shall repeat sending the message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error
                        alert message (e.g., protocol version, insufficient security) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>
                        terminates the connection silently (i.e., without logging a fatal error alert). 
                      </p>
                    </li>
                  
                  <li class="test-"><a id="dtls-client-nonstandard-versions" class="defined" href="#dtls-client-nonstandard-versions">Test FCS_DTLSC_EXT.1:2.2</a>:
      
                      <p>
                        The evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to
                        ensure any supported beta <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 versions are disabled, as necessary. The evaluator
                        shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a ClientHello message indicating the supported version (referred to
                        as the legacy version in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147) with the value 'fe fc' but without including the
                        supported_versions extension and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> responds with a ServerHello
                        indicating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, silently drops the message, or terminates the connection.
                      </p>
                    <p>
                    <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> responds with a ServerHello indicating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 in the highest version or legacy version,
                      the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall repeat sending the message until the
                      <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., protocol version) in response to
                      this response, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal 
                      error alert). 
                    </p>
                    <p>
                      <a href="#dtls-client-nonstandard-versions" class="dynref">Test FCS_DTLSC_EXT.1:2.2</a> is intended to test the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> response to non-standard versions, higher than
                      indicated in the ClientHello's "highest version or legacy version" supported, including early proposals for 'beta <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>
                      1.3' versions. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports such beta versions, the evaluator shall follow the operational guidance instructions
                      to disable them prior to conducting <a href="#dtls-client-nonstandard-versions" class="dynref">Test FCS_DTLSC_EXT.1:2.2</a>.
                    </p>
                  </li>
                </ul></span>
                </li>
                
                
                <li class="test-"><a id="_t_5" class="defined" href="#_t_5">Test FCS_DTLSC_EXT.1:3</a>:
      (ciphersuites) The evaluator shall perform the following tests on handling unexpected ciphersuites using a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>
                  server sending handshake messages compliant with the negotiated version except as indicated in the test:
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_6" class="defined" href="#_t_6">Test FCS_DTLSC_EXT.1:3.1</a>:
      (supported ciphersuite not offered) For each supported version, the evaluator shall attempt to establish a connection with a
                      test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server configured to negotiate the supported version and a ciphersuite not included in the ClientHello and
                      observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently drops the message or rejects the connection.
                    <p>
                      <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the
                      evaluator shall repeat sending the ServerHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a
                      fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates
                      the connection silently (i.e., without logging a fatal error alert). 
                    </p>
                      <p>
                      This test is intended to test the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s generic ability to recognize non-offered ciphersuites. 
                      If the ciphersuites in the ClientHello are configurable, 
                      the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> not to offer a supported ciphersuite and then use that ciphersuite in the test. 
                      If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> ciphersuite list is not configurable, it is acceptable to use a named ciphersuite from the IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> protocols
                      associated with the tested version. 
                      Additional special cases of this test for special ciphersuites are performed separately.
                    </p>
                    </li>
                    <li class="test-"><a id="dtls-client-version-confusion" class="defined" href="#dtls-client-version-confusion">Test FCS_DTLSC_EXT.1:3.2</a>:
      (version confusion) For each supported version, 
                      the evaluator shall attempt to establish a connection with a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that is configured to negotiate the
                      supported version and a ciphersuite that is not associated with that version and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently drops the
                      message or rejects the connection.
                      <p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                        the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a
                        fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates
                        the connection silently (i.e., without logging a fatal error alert). 
                      </p>
                      <p>
                        If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, the evaluator shall use <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ciphersuites for a server negotiating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>
                        1.3 is supported, the test server negotiating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 should select a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ciphersuite consistent with the client's
                        supported groups and signature algorithm indicated by extensions in the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ClientHello. 
                      </p>
                      <p>
                        If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is configurable to allow both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 servers, the evaluator should use this configuration for
                        the test, and configure the test server to use ciphersuites offered by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> in its ClientHello message.
                    </p>
                </li>
                <li class="test-"><a id="_t_8" class="defined" href="#_t_8">Test FCS_DTLSC_EXT.1:3.3</a>:
      (null ciphersuite) For each supported version, the evaluator shall attempt to establish a connection with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>
                  server configured to negotiate the null ciphersuite (TLS_NULL_WITH_NULL_NULL) and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently discards the 
                  message or rejects the connection. 
                      <p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently discards the message,
                        the evaluator shall repeat the test until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert
                        message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>
                        terminates the connection silently (i.e., without logging a fatal error alert).
                        </p></li>
                    
                    <li class="test-"><a id="_t_9" class="defined" href="#_t_9">Test FCS_DTLSC_EXT.1:3.4</a>:
      The evaluator shall perform one or more of the following tests to demonstrate the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> does not connect with
                      anonymous servers:
                      <p>
                       [conditional] (anon ciphersuite) If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, the evaluator shall attempt to establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2
                       connection with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server configured to negotiate a ciphersuite using the anonymous server authentication
                       method and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently drops the message or rejects the connection.
                      </p>
                      <p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message
                        the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a
                        fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable
                        that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                      </p>
                    <p>
                    See IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters for available ciphersuites to be selected by the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server. 
                    The test ciphersuite should use supported cryptographic algorithms for as many of the other components as possible. 
                    For example, if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> only supports the ciphersuite TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test server could
                    select TLS_DH_ANON_WITH_AES_256_GCM_SHA_384.
                    </p>
                    <p>
                      [conditional] (anon ciphersuite) If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the evaluator shall attempt to establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3
                      connection with a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server configured to assert a ‘raw public key’ in the server_certificate_type as defined in
                      <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7250, and to send its certificate message including the raw public key indicator for the public key information
                      field (regardless of the client's support for this extension). The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not send
                      the server_certificate_type extension indicating support for raw public keys in its ClientHello message and silently
                      drops the message or terminates the session when receiving the server’s certificate message.
                    </p><p>
                      <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                      the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a
                      fatal error alert message (e.g., bad_certificate, unsupported_certificate) in response to this, but it is acceptable
                      that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                    </p>
                      <p>
                      It is acceptable for the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support the extensions defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7250. If so, it must not include the value
                      indicating support for raw public keys in the server_certificate_type extension.
                    </p>
                    </li>
                    <li class="test-"><a id="dtls-client-deprecated-encryption" class="defined" href="#dtls-client-deprecated-encryption">Test FCS_DTLSC_EXT.1:3.5</a>:
      
                      <p>
                        The evaluator shall perform one or more of the following tests to demonstrate that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> does not accept
                        connections using deprecated ciphersuites:
                      </p>
                      <p>
                        [conditional] (deprecated encryption algorithm) If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, for each
                        deprecated encryption algorithm (NULL, RC2, RC4, DES, IDEA, TDES, and <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>-128), 
                        the evaluator shall attempt to establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 connection with a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server 
                        configured to negotiate a ciphersuite using the deprecated encryption algorithm 
                        and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently drops the message or rejects the connection.
                      </p>
                      <p>
                        [conditional] (deprecated encryption algorithm) If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, for each <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ciphersuite
                        registered in IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters using <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>-128 as the encryption algorithm, the evaluator shall attempt to
                        establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 connection with a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server configured to negotiate a ciphersuite using the
                        deprecated encryption algorithm and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently drops the message or rejects the connection.   
                      </p>
                      <p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                        the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a
                        fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable
                        that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                      </p>
                      <p>
                      See IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters for available ciphersuites to be tested. The test ciphersuite should use supported
                      cryptographic algorithms for as many of the other components as possible. 
                      For example, if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> only supports TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test server could select
                      TLS_ECDHE_PSK_WITH_NULL_SHA_384, TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5, TLS_ECDHE_RSA_WITH_RC4_128_SHA, 
                      TLS_DHE_DSS_WITH_DES_CBC_SHA, TLS_RSA_WITH_IDEA_CBC_SHA, and TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA.  
                      </p>
                    </li>
                  </ul></span>
                </li>
                
                
                <li class="test-"><a id="_t_11" class="defined" href="#_t_11">Test FCS_DTLSC_EXT.1:4</a>:
      (extensions) For each supported version indicated in the following tests, 
                  the evaluator shall establish a connection from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> with a test server negotiating the tested version and providing 
                  server handshake messages as indicated when performing the following tests for validating proper extension handling:
                <span class="testlist-"><ul>
                  <li class="test-"><a id="_t_12" class="defined" href="#_t_12">Test FCS_DTLSC_EXT.1:4.1</a>:
      
                    (signature_algorithms) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports certificate-based server authentication, the evaluator shall
                    perform the following tests:
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_13" class="defined" href="#_t_13">Test FCS_DTLSC_EXT.1:4.1.1</a>:
      For each supported version, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session with a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> test server and observe that
                        the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ClientHello includes the signature_algorithms extension with values in conformance with the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>.</li>
                      <li class="test-"><a id="_t_14" class="defined" href="#_t_14">Test FCS_DTLSC_EXT.1:4.1.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and supports an <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuite, the evaluator shall ensure
                        the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends a compliant ServerHello message selecting <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and one of the supported <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr>
                        ciphersuites, a compliant server certificate message, and a key exchange message signed using a signature algorithm
                        and hash combination not included in the client’s hello message (e.g., <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> with <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr>-1). The evaluator shall observe
                        that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the handshake.
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the handshake, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                          the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a
                          fatal error alert message (e.g., handshake failure, illegal parameter, decryption error) in response to this, 
                          but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                      </p></li>
                      <li class="test-"><a id="_t_15" class="defined" href="#_t_15">Test FCS_DTLSC_EXT.1:4.1.3</a>:
      [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported, the evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server to respond to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>
                        with a compliant ServerHello message selecting <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and a server certificate message, 
                        but then also send a certificate verification message that uses a signature algorithm method not included in the
                        signature_algorithms extension. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> only includes supported signature algorithms
                        in the signature_algorithms extension in its ClientHello and silently drops the message or terminates the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>
                        handshake after receiving the server certificate message.
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the handshake, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the
                          message, the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that
                          the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure, illegal parameter, bad certificate,
                          decryption error) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently
                          (i.e., without logging a fatal error alert).  
                        </p></li>
                      <li class="test-"><a id="_t_16" class="defined" href="#_t_16">Test FCS_DTLSC_EXT.1:4.1.4</a>:
      
                        [conditional] If certificate-based authentication is supported, and for all supported versions for which
                        signature_algorithms_cert is not supported, the evaluator shall ensure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends 
                        a compliant ServerHello message for the tested version and a server certificate message containing a
                        valid certificate that represents the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server, but which is signed using a signature and hash
                        combination not included in the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s signature_algorithms extension (e.g., a certificate signed using
                        <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr>-1). The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session.
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the handshake, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops
                          the message, the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred
                          that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., unsupported certificate, bad certificate, decryption error,
                          handshake failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently
                          (i.e., without logging a fatal error alert).  
                        </p><p>
                        Certificate-based server authentication is required unless the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> only supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> with shared PSK. 
                        For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, this is the case if only TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442,
                        TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487,
                        TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442, or
                        TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487, are supported. For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, certificate-based server
                        authentication is required.
                        </p></li>
                    </ul></span>
                  </li>
                  <li class="test-"><a id="dtls-client-signature-algs-cert" class="defined" href="#dtls-client-signature-algs-cert">Test FCS_DTLSC_EXT.1:4.2</a>:
      (signature_algorithms_cert) [conditional]  
                    If signature_algorithms_cert is supported, then for each version that uses the signature_algorithms_cert extension, 
                    the evaluator shall ensure that the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends a compliant ServerHello message selecting the tested version
                    and indicating certificate-based server authentication.
                    <p>
                    The evaluator shall ensure that the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server forwards a certificate message containing a valid certificate
                    that represents the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server, but which is signed by a valid Certification Authority using a signature and
                    hash combination not included in the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s signature_algorithms_cert extension (e.g., a certificate signed using <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr>
                    and <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr>-1). The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                    </p><p>
                    <b>Note:</b> Support for certificate-based authentication is assumed if the signature_algorithms_cert is supported. 
                    For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, a non-PSK ciphersuite, or one of TLS_RSA_PSK_WITH_AES_256_GCM_SHA384  
                    or TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487 is used to indicate certificate-based server authentication. 
                    For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the test server completes a full handshake, even if a PSK is offered to indicate certificate-based server
                    authentication. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> only supports shared PSK authentication, <a href="#dtls-client-signature-algs-cert" class="dynref">Test FCS_DTLSC_EXT.1:4.2</a> is not
                    performed.
                    </p><p>
                    For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the server certificate message is encrypted. 
                    The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server with the indicated certificate and ensure that the certificate is 
                    indeed sent by observing the buffer of messages to be encrypted, or by inspecting one or both sets of logs from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>
                    and test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server.
                    </p><p>
                    If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the handshake, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the server certificate message,
                    the evaluator shall continue sending the message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out.
                    It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., unsupported certificate, bad certificate, 
                    decryption error, handshake failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection
                    silently (i.e., without logging a fatal error alert). 
                  </p></li>
                  <li class="test-"><a id="_t_18" class="defined" href="#_t_18">Test FCS_DTLSC_EXT.1:4.3</a>:
      (extended_master_secret) [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> (if so
                    configurable) to enforce server support of extended master secret computation and initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 session with
                    a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server configured to compute a master secret according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, section 8.
                    <p>
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ClientHello includes the extended master secret extension in accordance
                    with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7627, and ensures that the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server does not include the extended master secret extension in its server
                    hello. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the ServerHello or terminates the session.
                    </p><p>
                      <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                      the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs
                      a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>
                      terminates the connection silently (i.e., without logging a fatal error alert). 
                  </p></li>
                  <li class="test-"><a id="_t_19" class="defined" href="#_t_19">Test FCS_DTLSC_EXT.1:4.4</a>:
      (supported_groups for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, and supports <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites,
                    the evaluator shall perform the following tests.
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_20" class="defined" href="#_t_20">Test FCS_DTLSC_EXT.1:4.4.1</a>:
      For each supported group, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session with a compliant test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server
                      supporting <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7919. The evaluator shall ensure that the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server is configured to select <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and 
                      a ciphersuite using the supported group. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ClientHello lists the 
                      supported groups as indicated in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>, and that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully establishes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session.</li>
                    <li class="test-"><a id="_t_21" class="defined" href="#_t_21">Test FCS_DTLSC_EXT.1:4.4.2</a>:
      [conditional on <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 support for <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites]  The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session with
                      a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that is configured to negotiate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and use an explicit version of a named EC group
                      supported by the client. The evaluator shall ensure that the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server key exchange message includes 
                      the explicit formulation of the group in its key exchange message as indicated in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 4492, Section 5.4. 
                      The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                      <p>
                        <b>Note:</b>: If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the
                        message, the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that
                        the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable
                        that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                      </p></li>
                  </ul></span>
                  </li>
                </ul></span>
                </li>
                
                  
                <li class="test-"><a id="_t_22" class="defined" href="#_t_22">Test FCS_DTLSC_EXT.1:5</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 extensions) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the evaluator shall perform the following tests. 
                  For each test, the evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ClientHello includes the supported versions extension with
                  the value 'fe fc' indicating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3:
                <span class="testlist-"><ul>
                  <li class="test-"><a id="_t_23" class="defined" href="#_t_23">Test FCS_DTLSC_EXT.1:5.1</a>:
      (supported versions) The evaluator shall initiate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 sessions in turn from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server
                    configured as indicated in the sub-tests below: 
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_24" class="defined" href="#_t_24">Test FCS_DTLSC_EXT.1:5.1.1</a>:
      The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server to include the supported versions extension in the server
                      hello only containing the value 'fe fe.' The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or 
                      terminates the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session.
                      <p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                        the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a
                        fatal error alert message (e.g., illegal parameter, handshake failure, protocol version) in response to this, but 
                        it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).   
                      </p></li>
                    <li class="test-"><a id="_t_25" class="defined" href="#_t_25">Test FCS_DTLSC_EXT.1:5.1.2</a>:
      The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server to include the supported versions extension in the ServerHello containing the value 'fe fc' and complete a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 handshake. 
                      The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 handshake successfully.</li>
                    <li class="test-"><a id="_t_26" class="defined" href="#_t_26">Test FCS_DTLSC_EXT.1:5.1.3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is configurable to support both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, 
                      the evaluator shall follow operational guidance to configure this behavior. The evaluator shall ensure that the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 compliant server handshake and 
                      observe that the server random does not incidentally include any downgrade messaging. 
                      The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 handshake successfully.
                      <p>
                      <b>Note:</b> Enhanced downgrade protection defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 is optional, and if supported, is tested separately. 
                      The evaluator may configure the test server’s random, or may repeat the test until the server’s random does not match a downgrade indicator.
                      </p></li>
                  </ul></span>
                  </li>
                  <li class="test-"><a id="_t_27" class="defined" href="#_t_27">Test FCS_DTLSC_EXT.1:5.2</a>:
      (supported groups, key shares) The evaluator shall initiate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 sessions in turn with a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server configured as indicated in the following sub-tests:
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_28" class="defined" href="#_t_28">Test FCS_DTLSC_EXT.1:5.2.1</a>:
      For each supported group, the evaluator shall configure the compliant test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server to select a ciphersuite using the group. 
                      The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends an element of the group in its ClientHello key shares extension 
                      (after a hello retry message from the test server, if the key share for the group is not included in the initial ClientHello). 
                      The evaluator shall ensure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends an element of the group in its ServerHello and observes that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake successfully.</li>
                    <li class="test-"><a id="_t_29" class="defined" href="#_t_29">Test FCS_DTLSC_EXT.1:5.2.2</a>:
      For each supported group, the evaluator shall modify the ServerHello sent by the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server to include an invalid key share value claiming 
                      to be an element the group indicated in the supported groups extension. 
                      The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session.
                      <p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops
                        the message, the evaluator shall continue sending the ServerHello until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is 
                        preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., illegal parameter) in response to 
                        this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging
                        a fatal error alert). 
                      </p><p>
                      For <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites, a zero value, or a value greater or equal to the modulus is not a valid element. 
                      For <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> groups, an invalid point contains x and y coordinates of the correct size, 
                      but represents a point not on the curve. The evaluator shall construct such an invalid point by modifying
                      a byte in the y coordinate of a valid point and verify that the coordinates do not satisfy the curve equation.
                    </p></li>
                  </ul></span>
                    </li>
                  <li class="test-"><a id="_t_30" class="defined" href="#_t_30">Test FCS_DTLSC_EXT.1:5.3</a>:
      
                    (PSK support) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports pre-shared keys, the evaluator shall follow the operational guidance to use pre-shared keys, 
                    shall establish a pre-shared key between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server, and initiate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 sessions in turn 
                    between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server configured as indicated in the following sub-tests:
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_31" class="defined" href="#_t_31">Test FCS_DTLSC_EXT.1:5.3.1</a>:
      
                        <p>The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to use the pre-shared key and ensure that the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server 
                          functions as a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ClientHello includes
                          the pre_shared_key extension with the valid PSK indicator shared with the test server. The evaluator shall
                          also observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ClientHello also includes the psk_key_exchange_modes and the post_handshake_auth
                          extensions and that the psk_key_exchange_modes indicates psk_dhe_ke (the <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> mode) but does not 
                          include psk_ke (the PSK-only mode). The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 handshake
                          successfully in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147, to include the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sending appropriate key shares for one or more 
                          of the supported groups.
                        </p><p>
                        Once the handshake is successful, the evaluator shall cause the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server to send a certificate request and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> provides a certificate message and certificate verify message. 
                        </p><p>
                        <b>Note:</b> It may be necessary to complete a standard handshake and send a new-ticket message from the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server to establish a pre-shared key, 
                        or it might be possible to configure the pre-shared key manually via out-of-band mechanisms. 
                        This can be performed in conjunction with other testing that is not tested as part of this <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr>. 
                        It is not required at this time to support emerging standards on establishing PSK, but as such standards are finalized, this <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> may be updated to require such support.
                        </p><p>
                        <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> messages after the handshake are encrypted so it may not be possible to observe the certificate and certificate verify messages sent by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> directly. 
                        The evaluator may need to configure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server to use an application that requires post-handshake client authentication and 
                        terminates the session or otherwise has an observable effect if the certificate is not provided.
                      </p></li>
                      <li class="test-"><a id="_t_32" class="defined" href="#_t_32">Test FCS_DTLSC_EXT.1:5.3.2</a>:
      The evaluator shall attempt to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to send early data. 
                        If there is no indication from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> that this is blocked, the evaluator shall repeat test 
                        5.3.1 with the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> so configured and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not send application data prior to receiving the ServerHello. 
                        <p>
                        <b>Note:</b> Early data will be encrypted under the PSK and received by the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server prior to it sending a ServerHello message. 
                        </p></li>
                    </ul></span>
                  </li>
                </ul></span>
                </li>
                
                
                
                <li class="test-"><a id="_t_33" class="defined" href="#_t_33">Test FCS_DTLSC_EXT.1:6</a>:
      (corrupt finished message) For each supported version, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that sends a compliant set of server handshake messages, 
                  except for sending a modified finished message 
                  (modify a byte of the finished message that would have been sent by a compliant server). 
                  The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session and in either case, does not complete the handshake by 
                  observing that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not send application data provided to the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel.</li>
                
                
                <li class="test-"><a id="dtls-client-missing-finished" class="defined" href="#dtls-client-missing-finished">Test FCS_DTLSC_EXT.1:7</a>:
      (missing finished message) For each supported version, the evaluator shall initiate a session from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server providing a compliant handshake, 
                  except for sending a random <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> message (the five byte header indicates a correct <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> message for the negotiated version, but not indicating a finished message) as the final message. 
                  The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session and in either case, does not send application data.
                  <p>
                    <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the 
                    evaluator shall continue sending the server finished until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a 
                    fatal error alert message (e.g., decryption error) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates
                    the connection silently (i.e., without logging a fatal error alert).
                  </p><p>
                  For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, the modified message is sent after the change_cipher_spec message. For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the modified message is sent as the last message of the server’s second flight of messages.
                  </p></li>
                
                
                <li class="test-"><a id="_t_35" class="defined" href="#_t_35">Test FCS_DTLSC_EXT.1:8</a>:
      (unexpected/corrupt signatures within handshake) The evaluator shall perform the following tests, according to the versions supported.
                <span class="testlist-"><ul>
                  <li class="test-"><a id="_t_36" class="defined" href="#_t_36">Test FCS_DTLSC_EXT.1:8.1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and if the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates support for <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> or DSA ciphersuites, 
                    the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session with a compliant test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server and  modify the signature in the server key exchange. 
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the key exchange message or terminates the session.</li>
                  <li class="test-"><a id="_t_37" class="defined" href="#_t_37">Test FCS_DTLSC_EXT.1:8.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates support for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> 
                    and a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that is configured to send a compliant ServerHello message, encrypted extension message, and certificate message, 
                    but will send a certificate verify message with an invalid signature (e.g., by modifying a byte from a valid signature). 
                    The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.</li>
                  <li class="test-"><a id="_t_38" class="defined" href="#_t_38">Test FCS_DTLSC_EXT.1:8.3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and if the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates support for both <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> methods in the signature_algorithm 
                    (or, if supported, the signature_algorithms_cert) extension, 
                    and if the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates one or more <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ciphersuites indicating each of the <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> methods in its signature components, 
                    the evaluator shall choose two ciphersuites: one indicating an <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> signature (cipher 1) and one indicating an <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> signature (cipher 2).
                    The evaluator shall then establish two certificates that are trusted by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>: one representing the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server using an <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> signature (cert 1) and one 
                    representing the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server using an <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> signature (cert 2).
                    
                    The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server that is configured to select cipher 1 and to send cert 2. The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates this <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session.
                    The evaluator shall then initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server that is configured to select cipher 2 and to send cert 1. The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> also silently drops the message or terminates this <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session. 
                    <p>
                      <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the 
                      evaluator shall continue sending the server finished until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a 
                      fatal error alert message (e.g., bad certificate, decryption error, handshake failure) in response to this, but 
                      it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                    </p></li>
                </ul></span>
                </li>
                
                
                <li class="test-"><a id="_t_39" class="defined" href="#_t_39">Test FCS_DTLSC_EXT.1:9</a>:
      
                  [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports certificate-based server authentication, 
                  then for each supported version, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to the compliant test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server 
                  configured to negotiate the tested version, and to authenticate using a certificate trusted by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as specified in the following:
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_40" class="defined" href="#_t_40">Test FCS_DTLSC_EXT.1:9.1</a>:
      <p>(certificate extended key usage purpose) The evaluator shall send a server certificate that contains the Server Authentication purpose in the ExtendedKeyUsage extension 
                      and verify that a connection is established. 
                      The evaluator shall repeat this test using a different certificate that is otherwise valid and trusted but lacks the 
                      Server Authentication purpose in the ExtendedKeyUsage extension and observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the certificate 
                      message or terminates the session.
                    </p><p>
                      <b>Note:</b>This test is not performed if only <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 with PSK ciphersuites are supported; it is required if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported and ciphersuites other than PSK ciphersuites are supported, or if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported.
                    </p><p>
                      Depending on the selections in <a href="#FCS_DTLSC_EXT.1.5">FCS_DTLSC_EXT.1.5</a> and <a href="#FCS_DTLSC_EXT.1.6">FCS_DTLSC_EXT.1.6</a>, this test is performed in conjunction with testing of <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> or <abbr class="dyn-abbr"><a href="#abbr_SFR">SFRs</a></abbr> specific to the supported functions using <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>.
                      </p><p>
                        If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall
                        continue sending the server certificate and certificate verify messages until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred
                        that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., bad certificate, decryption error, handshake failure) in
                        response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging
                        a fatal error alert). 
                      </p><p>
                      Ideally, the two certificates should be similar in regards to structure, the types of identifiers used, and the chain of trust.
                    </p></li>
                    <li class="test-"><a id="_t_41" class="defined" href="#_t_41">Test FCS_DTLSC_EXT.1:9.2</a>:
      
                      (certificate identifiers) For each supported method of matching presented identifiers, 
                      and for each name type for which the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> parses the presented identifiers from the server certificate for the method, 
                      the evaluator shall establish a valid certificate trusted by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to represent the test server using only the tested name type.
                      The evaluator shall perform the following sub-tests: 
                      <span class="testlist-"><ul>
                        <li class="test-"><a id="_t_42" class="defined" href="#_t_42">Test FCS_DTLSC_EXT.1:9.2.1</a>:
      The evaluator shall prepare the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary to use the matching method and establish reference identifiers
                          for the test server for the tested name type. The evaluator shall ensure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends a certificate
                          with a matching name of the tested name type and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the connection.</li>
                        <li class="test-"><a id="_t_43" class="defined" href="#_t_43">Test FCS_DTLSC_EXT.1:9.2.2</a>:
      The evaluator shall prepare the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary to use the matching method and establish reference identifiers that do not match the name representing the test server. 
                          The evaluator shall ensure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends a certificate with a name of the type tested, and observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                          <p>
                            <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                            the evaluator shall continue sending the server finished until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>
                            logs a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, but it is 
                            acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                          </p></li>
                        <li class="test-"><a id="dtls-client-valid-wildcard" class="defined" href="#dtls-client-valid-wildcard">Test FCS_DTLSC_EXT.1:9.2.3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports wildcards for a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or SVR name type, the evaluator shall prepare the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary 
                          to use the matching method for the name type, and establish a reference identifier. 
                          The evaluator shall establish a certificate for the test server that includes a wildcard name for the <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion of 
                          the appropriate name type which matches the reference identifier. 
                          The evaluator shall ensure the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends the certificate containing the wildcard name of the type tested, 
                          and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the connection. </li>
                        <li class="test-"><a id="dtls-client-no-wildcard" class="defined" href="#dtls-client-no-wildcard">Test FCS_DTLSC_EXT.1:9.2.4</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or SVR name type, but does not support wildcards (in general, 
                          or specifically for internationalized names of the specified type), the evaluator shall prepare the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary 
                          to use the matching method and establish a reference identifier that matches a wildcard name for the <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion of the appropriate name type, 
                          in accordance with the appropriate <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr>, in a certificate representing the server. 
                          The evaluator shall ensure the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends the certificate containing the wildcard name of the type tested, 
                          and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the connection. 
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, 
                          the evaluator shall continue sending the server finished until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>'s ability to 
                          support wildcard certificates is configurable, 
                          both <a href="#dtls-client-valid-wildcard" class="dynref">Test FCS_DTLSC_EXT.1:9.2.3</a> and <a href="#dtls-client-no-wildcard" class="dynref">Test FCS_DTLSC_EXT.1:9.2.4</a> are performed under the appropriate configuration. 
                          This test is required if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports internationalized names of the specified type – in this case, the reference identifier only includes 
                          an internationalized encoding in the leftmost label. 
                          The certificate used is intended to match the certificate as if wildcards were supported and if the wildcard extended to internationalized names.
                        </p>
                        </li>
                        <li class="test-"><a id="dtls-client-invalid-wildcard" class="defined" href="#dtls-client-invalid-wildcard">Test FCS_DTLSC_EXT.1:9.2.5</a>:
      
                          [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports wildcards for a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or SVR name type, the evaluator shall prepare the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary to use the matching method. 
                          The evaluator shall establish a reference identifier and a certificate for the server as indicated in each of the sub-tests described below. 
                          The evaluator shall in turn, ensure the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends the certificate associated with the reference identifier 
                          and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session. 
                          <span class="testlist-"><ul>
                            <li class="test-"><a id="_t_47" class="defined" href="#_t_47">Test FCS_DTLSC_EXT.1:9.2.5.1</a>:
      The reference identifier contains a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion with two labels, and the certificate includes a name whose <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion includes 
                              a matching rightmost label and a wildcard in the leftmost label (e.g., *.com).</li>
                            <li class="test-"><a id="_t_48" class="defined" href="#_t_48">Test FCS_DTLSC_EXT.1:9.2.5.2</a>:
      The reference identifier contains a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion with four labels, 
                              and the certificate includes a name whose <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion includes two rightmost labels matching the reference identifier, 
                              and a wildcard in the third label, and a matching identifier in the fourth (leftmost) label (e.g., foo.*.example.com).</li>
                            <li class="test-"><a id="_t_49" class="defined" href="#_t_49">Test FCS_DTLSC_EXT.1:9.2.5.3</a>:
      The reference identifier contains a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion with three labels, 
                              and the certificate includes a name whose <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion includes two rightmost labels matching the reference identifier, 
                              and a wildcard in the third (leftmost) label (e.g., *.example.com).</li>
                            <p>
                              <b>Note:</b> For negative sub-tests, if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>
                              silently drops the message, the evaluator shall continue sending the server finished until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out.
                            </p>
                          </ul></span>
                        </li>
                        <li class="test-"><a id="_t_50" class="defined" href="#_t_50">Test FCS_DTLSC_EXT.1:9.2.6</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports wildcards and supports embedded <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or SVR name types in the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>, 
                          then for each supported name type, the evaluator shall repeat 
                          <a href="#dtls-client-valid-wildcard" class="dynref">Test FCS_DTLSC_EXT.1:9.2.3</a>, <a href="#dtls-client-no-wildcard" class="dynref">Test FCS_DTLSC_EXT.1:9.2.4</a>, and <a href="#dtls-client-invalid-wildcard" class="dynref">Test FCS_DTLSC_EXT.1:9.2.5</a>
                          using certificates with the prescribed name embedded in the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>. 
                        </li>
                        <li class="test-"><a id="dtls-client-ip-wildcard" class="defined" href="#dtls-client-ip-wildcard">Test FCS_DTLSC_EXT.1:9.2.7</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses as an embedded name type in the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>, 
                          the evaluator shall establish an <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address as a reference identifier and establish a certificate with a valid <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name in the subject field, 
                          including a <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> whose value is the digital formatting of the octets of the reference identifier. 
                          The evaluator shall ensure the server sends the certificate and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully completes the session.</li>
                        <li class="test-"><a id="_t_52" class="defined" href="#_t_52">Test FCS_DTLSC_EXT.1:9.2.8</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses and any embedded name type in the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>, 
                          the evaluator shall establish an <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address as a reference identifier and establish a certificate with a valid <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name in the subject field, 
                          including a <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> whose value is the digital formatting of the octets of the reference identifier (as in <a href="#dtls-client-ip-wildcard" class="dynref">Test FCS_DTLSC_EXT.1:9.2.7</a>) 
                          except that one of the octets is replaced by the ‘*’ character. 
                          The evaluator shall ensure the server sends the certificate and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.</li>
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue
                          sending the server certificate and certificate verify messages until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out.
                        </p>
                      </ul></span>
                    </li>                    
                    
                    <li class="test-"><a id="_t_53" class="defined" href="#_t_53">Test FCS_DTLSC_EXT.1:9.3</a>:
      (mixed identifiers)[conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports a name matching method where the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> performs matching of both <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-encoded name types and <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> names of the same type, 
                      then for each such method, and for each such name type, the evaluator shall establish a valid certificate trusted by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> 
                      to represent the test server using one name for the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-encoded name type and a different name for the <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name type The evaluator shall perform the following tests: 
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_54" class="defined" href="#_t_54">Test FCS_DTLSC_EXT.1:9.3.1</a>:
      The evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to use the name matching method and establish reference identifiers matching only the <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr>. 
                        The evaluator shall ensure that the test server sends the certificate with the matching <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> and non-matching <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-encoded name, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the connection.
                        <p>
                        <b>Note:</b> Configuration of the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> may depend on the application using <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>.
                        </p></li>
                      <li class="test-"><a id="_t_55" class="defined" href="#_t_55">Test FCS_DTLSC_EXT.1:9.3.2</a>:
      The evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to use the name matching method and establish reference identifiers matching only the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-encoded name. 
                        The evaluator shall ensure that the test server sends the certificate with the matching <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-encoded name and matching <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the 
                        message or terminates the session.
                        <p>
                          If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall
                          continue sending the server certificate and certificate verify messages until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out.
                          It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., bad certificate, unknown certificate) in response
                          to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                        </p></li>
                    </ul></span>
                    </li>
                    <li class="test-"><a id="_t_56" class="defined" href="#_t_56">Test FCS_DTLSC_EXT.1:9.4</a>:
      (empty certificate) The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server to supply an empty certificate message and verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                      <p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                        the evaluator shall continue sending the server certificate and certificate verify messages until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out.
                        It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                      </p></li>
                    <li class="test-"><a id="_t_57" class="defined" href="#_t_57">Test FCS_DTLSC_EXT.1:9.5</a>:
      (invalid certificate) [conditional] If validity exceptions are supported, 
                      then for each exception for certificate validity supported, 
                      the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to allow the exception and ensure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server sends a certificate that is valid and trusted, 
                      except for the allowed exception. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the session. 
                      <p>
                      Without modifying the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> configuration, the evaluator shall initiate a new session with the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that includes an additional validation error, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                      </p><p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                        the evaluator shall continue sending the server certificate and certificate verify messages until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out.
                        It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., decode error, bad certificate) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                      </p><p>
                      The intent of this test is to verify the scope of the exception processing. 
                      If verifying certificate status information is claimed as an exception, then this test will verify that a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session succeeds when all supported methods for obtaining certificate status information is blocked from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>, 
                      to include removing any status information that might be cached by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>. 
                      If the exception is limited to specific certificates 
                      (e.g., only leaf certificates are exempt, or only certain leaf certificates are exempt) 
                      the additional validation error could be unavailable revocation information for a non-exempt certificate 
                      (e.g., revocation status information from an intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> is blocked for the issuing <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> of an exempt leaf certificate, 
                      or revocation information from the issuing <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> is blocked for a non-exempt leaf certificate). 
                      If the only option for the exception is for all revocation information for all certificates, another validation error from <span class="no-link">FIA_X509_EXT.1</span> (e.g., certificate expiration, extended key usage, etc.) may be used. 
                    </p></li>
                  </ul></span>
                </li>
                 <li class="test-"><a id="_t_58" class="defined" href="#_t_58">Test FCS_DTLSC_EXT.1:10</a>:
      
                   <p>
                     For each version supported, the evaluator shall establish a connection using a compliant handshake negotiating the 
                     version. The evaluator shall then cause the test server to send application data with at least one byte in a record 
                     message modified from what a compliant test server would send, and verify that the client discards the record or 
                     terminates the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session as described in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr>. If multiple behaviors are supported, the evaluator shall repeat 
                     the test for each behavior.
                  </p>
                 </li>
              </ul></span>
         
        </div></div></div></div></div>
      

  <div class="comp" id="FCS_DTLSC_EXT.2"><h4>FCS_DTLSC_EXT.2 DTLS Client Support for Mutual Authentication</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_DTLSC_EXT.1.1">FCS_DTLSC_EXT.1.1</a>.
      </i></b></div>
    
    
    
    
    
    
    
          <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.2.1"><a href="#FCS_DTLSC_EXT.2.1" class="abbr">FCS_DTLSC_EXT.2.1</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support mutual <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> authentication using X.509v3 certificates during the handshake and 
              [<b>selection</b>: <span class="selectable-content" id="_s_75">in support of post-handshake authentication requests</span>, <span class="selectable-content" id="_s_76">at no other time</span>], in accordance with [<b>selection</b>: <span class="selectable-content" id="_s_77"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, Section 7.4.4</span>, <span class="selectable-content" id="_s_78"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, Section 4.3.2</span>].
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "mutual authentication" is selected in <a href="#FCS_DTLSC_EXT.1.1">FCS_DTLSC_EXT.1.1</a>.
              </p>
              <p>
                Clients that support <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and post-handshake authentication should claim "in support of post-handshake authentication
                requests" in the first selection. The "at no other time" selection is claimed for clients only supporting <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 or for
                <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 clients that do not support post-handshake authentication.                  
              </p>
              <p>
                The certificate request message sent by the server specifies the signature algorithms and certification authorities supported
                by the server. If the client does not possess a matching certificate, it sends an empty certificate message. The structure of
                the certificate request message is changed in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 to use the signature_algorithm, signature_algorithms_cert (optional), 
                and certificate_authorities extensions, and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 allows for (D)<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 implementations to use the new message structure. The "<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, section 4.3.2" option is claimed in the second selection if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported or if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported and the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 method is supported for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 servers. The "<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, section 7.4.4" option is claimed if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported and the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246 method is supported for interoperability with <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 servers that do not adopt the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 method. When mutual authentication is supported, at least one of these methods must be claimed, per the selection.      
              </p>
      </span></div></div></div>
	  
  <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSC_EXT.2">FCS_DTLSC_EXT.2</a></div>
        
        
        
      <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
          <p>
            The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> description required per <span class="no-link">FIA_X509_EXT.2.1</span> includes the use of client-side certificates for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> mutual authentication. 
            The evaluator shall also ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes any factors beyond configuration that are necessary in order for the client to engage in mutual authentication using X.509v3 certificates.
          </p>
        </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
          <p>
            The evaluator shall ensure that the operational guidance includes any instructions necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to perform mutual authentication. 
            The evaluator shall also verify that the operational guidance required per <span class="no-link">FIA_X509_EXT.2.1</span> includes instructions for configuring the client-side certificates for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> mutual authentication.
          </p>
        </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
          For each supported <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version, the evaluator shall perform the following tests:
          <span class="testlist-"><ul>
            <li class="test-"><a id="_t_59" class="defined" href="#_t_59">Test FCS_DTLSC_EXT.2:1</a>:
      The evaluator shall establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> connection from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that negotiates the tested version 
              and which is not configured for mutual authentication (i.e., does not send a Server’s Certificate Request (type 13) message). 
              The evaluator shall observe negotiation of a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel and confirm that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> did not send a Client’s Certificate message (type 11) during handshake.</li>
            <li class="test-"><a id="_t_60" class="defined" href="#_t_60">Test FCS_DTLSC_EXT.2:2</a>:
      The evaluator shall establish a connection to a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server with a shared trusted root that is configured for mutual authentication 
              (i.e., it sends a Server’s Certificate Request (type 13) message). 
              The evaluator shall observe negotiation of a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel and confirm that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> responds with a non-empty Client’s Certificate message (type 11) and Certificate Verify (type 15) message.</li>
            <li class="test-"><a id="_t_61" class="defined" href="#_t_61">Test FCS_DTLSC_EXT.2:3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports post-handshake authentication, 
              the evaluator shall establish a pre-shared key between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server. 
              The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session using the pre-shared key and confirm the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server successfully complete the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake and both support post-handshake authentication. 
              After the session is successfully established, the evaluator shall initiate a certificate request message from the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server. 
              The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> receives that authentication request 
              and shall take necessary actions, in accordance with the operational guidance, to complete the authentication request. 
              The evaluator shall confirm that the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server receives certificate and certificate verification messages from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> over the channel that authenticates the client.
              <p>
                <b>Note:</b> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 certificate requests from the test server and client certificate and certificate verify messages are encrypted. 
                The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends the appropriate messages by examining the messages received at the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server and by inspecting any relevant server logs. 
                The evaluator may also take advantage of the calling application to demonstrate that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> receives data configured at the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server. 
              </p></li>
          </ul></span>
        </div></div></div></div></div>


        <div class="comp" id="FCS_DTLSC_EXT.3"><h4>FCS_DTLSC_EXT.3 DTLS Client Downgrade Protection</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_DTLSC_EXT.1.1">FCS_DTLSC_EXT.1.1</a>.
      </i></b></div>
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.3.1"><a href="#FCS_DTLSC_EXT.3.1" class="abbr">FCS_DTLSC_EXT.3.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel if the ServerHello message includes a
              [<b>selection</b>: <span class="selectable-content" id="_s_79"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator</span>, <span class="selectable-content" id="_s_80"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade indicator</span>]
              in the server random field. <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "supplemental downgrade protection" is selected in <a href="#FCS_DTLSC_EXT.1.1">FCS_DTLSC_EXT.1.1</a>.
              </p>
              <p>
                <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> uses the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> downgrade indicators. 
              </p>
              <p>
                The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims the “<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator” when <a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a> indicates support for both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3
                and implements supplemental downgrade protection. This option is not claimed if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is not supported. The “<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or
                below downgrade indicator” option may also be claimed if supported, but should only be claimed if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is capable of 
                detecting the indicator. This package requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to always terminate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0 sessions based on the ServerHello 
                negotiated version field; it is acceptable to ignore any downgrade indicator. However, a <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> that is capable of detecting
                the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade indicator may claim this option if it takes different actions depending on whether the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1
                or below downgrade indicator is set.
              </p>
            </span></div></div></div> 
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSC_EXT.3">FCS_DTLSC_EXT.3</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall review the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and confirm that the description of the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client protocol includes the downgrade protection mechanism in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147 
                  and identifies any configurable features of the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> needed to meet the requirements. 
                  If the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> claims that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 and below indicator is processed in the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 implementation to prevent downgrade to <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0, 
                  the evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> indicates which configurations allow processing of the downgrade indicator 
                  and the specific response of the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> when it receives the downgrade indicator as opposed to simply terminating the session for the unsupported version.
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall review the operational guidance and confirm that any instructions to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to meet the requirements are included.
                </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall perform the following tests to confirm the response to downgrade indicators from a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server:
                <span class="testlist-"><ul>
                  <li class="test-"><a id="_t_62" class="defined" href="#_t_62">Test FCS_DTLSC_EXT.3:1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 session with a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server 
                    configured to send a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ServerHello (not including any <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 extensions) 
                    but including the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 downgrade indicator ‘44 4F 57 4E 47 52 44 01’ in the last eight bytes of the server random field. 
                    The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the ServerHello message or terminates the session.
                    <p>  
                      <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                      the evaluator shall continue sending the server message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs
                      a fatal error alert message (e.g., illegal parameter), but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminate the session 
                      without logging an error alert.
                    </p></li>
                  <li class="test-"><a id="_t_63" class="defined" href="#_t_63">Test FCS_DTLSC_EXT.3:2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade indicator to prevent downgrade to <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0, and if the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates a configuration where the indicator is processed, 
                    the evaluator shall follow operational guidance instructions to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> so it parses a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.1 ServerHello message to detect and process the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> downgrade indicator. 
                    The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that is configured to send a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0 ServerHello message 
                    with the downgrade indicator ‘44 4F 57 4E 47 52 44 00’ in the last eight bytes of the server random field, 
                    but which is otherwise compliant with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 4347. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the ServerHello 
                    message or terminates the session as described in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>.
                    <p>
                      <b>Note:</b> The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is required not to accept a negotiation of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0. This test confirms the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is able to
                      distinguish attempts to negotiate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0 when the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 and below downgrade indicator is provided, and is only 
                      performed when the indicator is processed resulting in a different behavior than other attempts to negotiate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0.
                      If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session according to the unique behavior indicated in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>, the test is successful. If the
                      <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the server finished until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> demonstrates the 
                      unique response to the downgrade indicator as described in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error 
                      alert message (illegal parameter or unsupported version), but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminate the session
                      without logging an error alert. 
                    </p><p>
                      Use of the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 and below indicator as a redundant mechanism 
                      where there is no configuration that actually processes the value does not require additional testing, 
                      since this would be addressed by <a href="#dtls-client-obsolete-versions" class="dynref">Test FCS_DTLSC_EXT.1:2</a><a href="#dtls-client-obsolete-versions" class="dynref">Test FCS_DTLSC_EXT.1:2</a> for <a href="#FCS_DTLSC_EXT.1.1">FCS_DTLSC_EXT.1.1</a>. 
                      This test is only required if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> responds differently (e.g., a different error alert) when the downgrade indicator is present than when <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0 or below is negotiated and the downgrade indicator is not present.
                    </p></li>
                </ul></span>
              </div></div></div></div></div>
        
        <div class="comp" id="FCS_DTLSC_EXT.4"><h4>FCS_DTLSC_EXT.4 DTLS Client Support for Renegotiation</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
      </i></b></div>
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.4.1"><a href="#FCS_DTLSC_EXT.4.1" class="abbr">FCS_DTLSC_EXT.4.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support secure <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> renegotiation through use of [<b>selection</b>: <span class="selectable-content" id="_s_81">the “renegotiation_info” <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extension in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746</span>, <span class="selectable-content" id="_s_82">the TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuite signaling value in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746</span>, <span class="selectable-content" id="_s_83">rejection of all renegotiation attempts</span>]
              and shall
              [<b>selection</b>: <span class="selectable-content" id="_s_84">terminate the session</span>, <span class="selectable-content" id="_s_85">discard the message</span>]
              if an unexpected ServerHello is received or
              [<b>selection</b>: <span class="selectable-content" id="_s_86">hello request message is received</span>, <span class="selectable-content" id="_s_87">in no other case</span>].
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a client" is selected in <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
              </p>
              <p>
                A client supporting <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 must claim “rejection of all renegotiation attempts.” This option may also be claimed as a
                method for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 renegotiation protection.
              </p>
              <p>
                The TLS_EMPTY_RENEGOTIATION_INFO_SCSV is the preferred mechanism for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 protection against insecure renegotiation when
                the client does not renegotiate. The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author will claim "a hello request message is received" in the second selection to
                indicate support for this mechanism.
              </p>
              <p>
                <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 allows the client to accept connections with servers that do not support the extension; this <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> refines <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746
                and requires the client to terminate sessions with such servers. Thus, unexpected ServerHello messages include
                <ul>
                  <li>
                    an initial ServerHello negotiating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 that does not contain a renegotiation_info extension
                  </li>
                  <li>
                    an initial ServerHello negotiating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 that has a renegotiation_info extension that is non-empty
                  </li>
                  <li>
                    a subsequent ServerHello renegotiating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 that does not contain a renegotiation_info extension
                  </li>
                  <li>
                    a subsequent ServerHello negotiating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 that has a renegotiation_info extension with an incorrect renegotiated_connection value
                  </li>
                 and
                  <li>
                    a ServerHello request message when renegotiation is not allowed (for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 or when the option is claimed for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2).
                  </li>
              </ul>
              </p>
              <p>
                <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 provides protection against insecure renegotiation by not allowing renegotiation. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is claimed in
                <a href="#FCS_DTLSC_EXT.1.1">FCS_DTLSC_EXT.1.1</a>, the client receives a ServerHello that attempts to negotiate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, and the ServerHello also contains
                a non-empty renegotiation_info extension; the client will terminate the connection or silently discard the message.
              </p>
            </span></div></div></div> 
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSC_EXT.4">FCS_DTLSC_EXT.4</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure that <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> renegotiation protections are described in accordance with the requirements. 
                  The evaluator shall ensure that any configurable features of the renegotiation protections are identified.
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall examine the operational guidance to confirm that instructions for any configurable features of the renegotiation protection mechanisms are included.
                </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall perform the following tests as indicated. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported and one or more of the secure renegotiation methods
                defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 is claimed, <a href="#dtls-client-accepts-renegotiation" class="dynref">Test FCS_DTLSC_EXT.4:1</a> is required. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported and the
                <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> (has a configuration that) rejects all <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 renegotiation attempts, or if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported, <a href="#dtls-client-prevents-renegotiation" class="dynref">Test FCS_DTLSC_EXT.4:2</a> is required.
                <span class="testlist-"><ul>
                  <li class="test-"><a id="dtls-client-accepts-renegotiation" class="defined" href="#dtls-client-accepts-renegotiation">Test FCS_DTLSC_EXT.4:1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and supports a configuration to accept renegotiation requests for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, 
                    the evaluator shall follow any operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>. The evaluator shall perform the following tests:  
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="dtls-client-offers-renegotiation" class="defined" href="#dtls-client-offers-renegotiation">Test FCS_DTLSC_EXT.4:1.1</a>:
      The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> connection with a test server configured to negotiate a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 handshake. 
                        The evaluator shall inspect the messages received by the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server. 
                        The evaluator shall observe that either the “renegotiation_info” field or the <abbr class="dyn-abbr"><a href="#abbr_SCSV">SCSV</a></abbr> ciphersuite is included in the ClientHello message during the initial handshake.</li>
                      <li class="test-"><a id="_t_66" class="defined" href="#_t_66">Test FCS_DTLSC_EXT.4:1.2</a>:
      For each of the following sub-tests, the evaluator shall initiate a new <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> connection with a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server configured to send a renegotiation_info extension as specified, 
                        but otherwise complete a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 session:
                        <span class="testlist-"><ul>
                          <li class="test-"><a id="_t_67" class="defined" href="#_t_67">Test FCS_DTLSC_EXT.4:1.2.1</a>:
      The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server to send a renegotiation_info extension whose value indicates a non-zero length. 
                            The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the ServerHello message or terminates the connection. 
                            <p>
                              <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                              the evaluator shall continue sending the ServerHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that 
                              the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable
                              that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                            </p>
                          </li>
                          <li class="test-"><a id="_t_68" class="defined" href="#_t_68">Test FCS_DTLSC_EXT.4:1.2.2</a>:
      The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server to send a compliant renegotiation_info extension and observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully completes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 connection.</li>
                          <li class="test-"><a id="_t_69" class="defined" href="#_t_69">Test FCS_DTLSC_EXT.4:1.2.3</a>:
      The evaluator shall initiate a session renegotiation after completing a successful handshake with a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server that completes a successful <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 handshake 
                            (as in <a href="#dtls-client-offers-renegotiation" class="dynref">Test FCS_DTLSC_EXT.4:1.1</a>) and then sends a hello reset request from the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server with a 
                            “renegotiation_info” extension that has an unexpected “client_verify_data” or “server_verify_data” 
                            value (modify a byte from a compliant response). The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the ServerHello message or 
                            terminates the connection.
                            <p>
                              <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                              the evaluator shall continue sending the ServerHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that 
                              the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., illegal parameter, handshake error) in response to this, but 
                              it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                            </p>
                          </li>
                        </ul></span>
                      </li>
                    </ul></span>
                  </li>
                  <li class="test-"><a id="dtls-client-prevents-renegotiation" class="defined" href="#dtls-client-prevents-renegotiation">Test FCS_DTLSC_EXT.4:2</a>:
      [conditional] if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports a configuration that prevents renegotiation, the evaluator shall perform the following tests:
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_71" class="defined" href="#_t_71">Test FCS_DTLSC_EXT.4:2.1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and supports a configuration to reject <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 renegotiation, 
                        the evaluator shall follow the operational guidance as necessary to prevent renegotiation. 
                        The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session between the so-configured <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server that is configured to perform a compliant handshake, 
                        followed by a hello reset request. The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the initial handshake successfully but silently drops the hello reset
                        request message or terminates the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session after receiving the hello reset request.
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                          the evaluator shall continue sending the hello reset request message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that
                          the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that
                          the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                        </p>
                      </li>
                      <li class="test-"><a id="_t_72" class="defined" href="#_t_72">Test FCS_DTLSC_EXT.4:2.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server that completes a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 handshake, 
                        followed by a hello reset message. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the initial <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 handshake successfully, but silently drops the hello reset message or 
                        terminates the session on receiving the hello reset message.
                        <p>
                          If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                          the evaluator shall continue sending the server finished until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred
                          that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., unexpected message) in response to this, but
                          it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                        </p>
                      </li>
                    </ul></span>
                  </li>
                </ul></span>
              </div></div></div></div></div>
        
        <div class="comp" id="FCS_DTLSC_EXT.5"><h4>FCS_DTLSC_EXT.5 DTLS Client Support for Session Resumption</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_DTLSC_EXT.1.1">FCS_DTLSC_EXT.1.1</a>.
      </i></b></div>
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.5.1"><a href="#FCS_DTLSC_EXT.5.1" class="abbr">FCS_DTLSC_EXT.5.1</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support session resumption as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client via the use of [<b>selection</b>: <span class="selectable-content" id="_s_88">session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246</span>, <span class="selectable-content" id="_s_89">tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077</span>, <span class="selectable-content" id="dtlsc_v13_resumption">PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span>]. 
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "session resumption" is selected in <a href="#FCS_DTLSC_EXT.1.1">FCS_DTLSC_EXT.1.1</a>.
              </p><p>
                The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates which session resumption mechanisms are supported. One or both of the first two options, "session ID
                in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246" and "tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077" are claimed if resumption of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 sessions is
                supported. If resumption of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 sessions is supported, "PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446" is selected, 
                and the selection-based <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> <a href="#FCS_DTLSC_EXT.6">FCS_DTLSC_EXT.6</a> must also be claimed.
              </p><p>
                While it is possible to perform session resumption using PSK ciphersuites in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, this is uncommon. 
                Validation of key exchange and session negotiation rules for PSK ciphersuites is independent of the source of the pre-shared key and is covered in <a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a>. 
              </p>
            </span></div></div></div>  
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSC_EXT.5">FCS_DTLSC_EXT.5</a></div>
              
              
                          
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and confirm that the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client protocol description includes a description of the supported resumption mechanisms.
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall ensure the operational guidance describes instructions for any configurable features of the resumption mechanism.
                </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall perform the following tests:
                <span class="testlist-"><ul>
                  <li class="test-"><a id="dtls-client-successful-resumption" class="defined" href="#dtls-client-successful-resumption">Test FCS_DTLSC_EXT.5:1</a>:
      For each supported <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version and for each supported resumption mechanism that is supported for that version, 
                    the evaluator shall establish a new <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and a compliant test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server that is configured to negotiate the indicated version 
                    and perform resumption using the indicated mechanism. 
                    The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the initial <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake and shall cause the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to close the session normally. 
                    The evaluator shall then cause the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to resume the session with the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server using the indicated method and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully establishes the session.
                    <p>
                      <b>Note:</b> For each method, successful establishment refers to proper use of the mechanism, to include compliant extensions and behavior, as indicated in the referenced <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr>.
                    </p>
                  </li>
                  <li class="test-"><a id="_t_74" class="defined" href="#_t_74">Test FCS_DTLSC_EXT.5:2</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 session id echo) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the evaluator shall initiate a new <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 session with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server. 
                    The evaluator shall cause the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server to send a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ServerHello message 
                    (or a hello retry request if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not include the key share extension) that contains a different value in the legacy_session_id field from the expected 32-byte value, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the ServerHello message or terminates the session.
                    <p>
                      <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message,
                      the evaluator shall continue sending the ServerHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the 
                      <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the
                      <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                    </p>
                  </li>
                </ul></span>
              </div></div></div></div></div>
        
        
        <div class="comp" id="FCS_DTLSC_EXT.6"><h4>FCS_DTLSC_EXT.6 DTLS Client DTLS 1.3 Resumption Refinements</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_DTLSC_EXT.5.1">FCS_DTLSC_EXT.5.1</a>.
      </i></b></div>
           
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.6.1"><a href="#FCS_DTLSC_EXT.6.1" class="abbr">FCS_DTLSC_EXT.6.1</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall send a psk_key_exchange_modes extension with value psk_dhe_ke when <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 session resumption is offered. 
            </div></div>
          <div class="element"><div class="reqid" id="FCS_DTLSC_EXT.6.2"><a href="#FCS_DTLSC_EXT.6.2" class="abbr">FCS_DTLSC_EXT.6.2</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not send early data in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 sessions. 
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446" is selected in <a href="#FCS_DTLSC_EXT.5.1">FCS_DTLSC_EXT.5.1</a>.
              </p>
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed when session resumption is supported for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3. <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 allows pre-shared keys to be used directly
                and also allows early data to be protected using only the pre-shared key. This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> refines the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> to use PSK only with a
                supplemental <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> key exchange to ensure perfect forward secrecy for all sessions.
              </p>
            </span></div></div></div>  
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSC_EXT.6">FCS_DTLSC_EXT.6</a></div>
          
          
                
        <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
            <p>
              The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to verify that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client protocol description indicates that the PSK exchange requires <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> mode and prohibits sending early data. 
              The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to verify it lists all applications that can be secured by <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 using pre-shared keys and 
              describes how each <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 client application ensures data for the application is not sent using early data.
            </p>
          </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
            <p>
              The evaluator shall examine the operational guidance to verify that instructions for any configurable features that are required to meet the requirement are included. 
              The evaluator shall ensure the operational guidance includes any instructions required to configure applications so the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 client implementation does not send early data.
            </p>
          </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
            [conditional] For each application that is able to be secured via <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 using PSK, 
            the evaluator shall follow operational guidance to configure the application not to send early data. 
            The evaluator shall cause the application to initiate a resumed <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 session between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and a compliant test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3
            server as in <a href="#dtls-client-successful-resumption" class="dynref">Test FCS_DTLSC_EXT.5:1</a> in <a href="#FCS_DTLSC_EXT.5">FCS_DTLSC_EXT.5</a>. 
            The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> ClientHello for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 includes the psk_mode extension with the value psk_dhe_ke
            and sends a key share value for a supported group. 
            The evaluator shall confirm that early data is not received by the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server.
            <p>
              <b>Note:</b> If no applications supported by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> provide data to <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 that can be sent using PSK, this test is omitted.
            </p>
          </div></div></div></div></div> 
        
        
   
   
        
  <div class="comp" id="FCS_DTLSS_EXT.1"><h4>FCS_DTLSS_EXT.1 DTLS Server Protocol</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
      </i></b></div>
    
    
    
    
    
     
    
    <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.1.1"><a href="#FCS_DTLSS_EXT.1.1" class="abbr">FCS_DTLSS_EXT.1.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement 
      [<b>selection</b>: <span class="selectable-content" id="_s_91"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6347)</span>, <span class="selectable-content" id="_s_92"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147)</span>] as a server that supports additional functionality for session renegotiation protection and
        [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="dtlss_mutual_auth">mutual authentication</span></li><li style=""><span class="selectable-content" id="dtlss_downgrade_protection">supplemental downgrade protection</span></li><li style=""><span class="selectable-content" id="dtlss_resumption">session resumption</span></li><li style=""><span class="selectable-content" id="_s_96">no optional functionality</span></li></ul>]
        and shall reject connection attempts from clients supporting only <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0.
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
          This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a server" is selected in <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
        </p><p>
          The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author will claim supported <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> versions and optional functionality as appropriate for the claimed versions. 
        </p><p>
          Session renegotiation protection is required for both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, and the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the requirements from
          <a href="#FCS_DTLSS_EXT.4">FCS_DTLSS_EXT.4</a>. Within <a href="#FCS_DTLSS_EXT.4">FCS_DTLSS_EXT.4</a>, options for implementation of secure session renegotiation in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, or rejecting
          renegotiation requests required in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and optionally supported in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 are claimed.  
        </p>
        <p>
          If "mutual authentication" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include the requirements from <a href="#FCS_DTLSS_EXT.2">FCS_DTLSS_EXT.2</a>. 
          If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> with mutual authentication, this selection must be made.
        </p><p>
          Supplemental downgrade protection is claimed if both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 are supported. If "supplemental downgrade protection" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include the requirements from <a href="#FCS_DTLSS_EXT.3">FCS_DTLSS_EXT.3</a>. 
        
        </p><p>
          If "session resumption" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include the requirements from <a href="#FCS_DTLSS_EXT.5">FCS_DTLSS_EXT.5</a>.
        </p><p>
          <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version numbers are denoted on the wire as the 1’s complement of the corresponding textual <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> versions as described in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6347, Section 4.1. 
          <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version 1.2 is 0xfefd; <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version 1.3 is 0xfefc. 
        </p>
      </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.1.2"><a href="#FCS_DTLSS_EXT.1.2" class="abbr">FCS_DTLSS_EXT.1.2</a></div><div class="reqdesc">
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_97"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites: [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_98">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8422</span></li><li style=""><span class="selectable-content" id="_s_99">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8422</span></li><li style=""><span class="selectable-content" id="_s_100">TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5288</span></li><li style=""><span class="selectable-content" id="_s_101">TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5288</span></li><li style=""><span class="selectable-content" id="_s_102">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289</span></li><li style=""><span class="selectable-content" id="_s_103">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289</span></li><li style=""><span class="selectable-content" id="_s_104">ciphersuites using pre-shared secrets:
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_105">TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442</span></li><li style=""><span class="selectable-content" id="_s_106">TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487</span></li><li style=""><span class="selectable-content" id="_s_107">TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487</span></li></ul>]</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_108"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites: [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_109">TLS_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span></li><li style=""><span class="selectable-content" id="_s_110">[<b>assignment</b>: 
     <span class="assignable-content">other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites</span>]</span></li></ul>]</span></li></ul>]
        using a preference order based on [<b>selection</b>: <span class="selectable-content" id="_s_111"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9151 priority</span>, <span class="selectable-content" id="_s_112">ClientHello ordering</span>, <span class="selectable-content" id="_s_113">[<b>assignment</b>: 
     <span class="assignable-content">additional priority</span>]</span>].
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
          <P>
            <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ciphersuites. The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author selects the ciphersuites that are supported and must select at least one ciphersuite
            suitable for each supported <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> version – <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3. It is necessary
            to limit the ciphersuites that can be used administratively in an evaluated configuration on the server in the test environment. If
            administrative steps need to be taken so that the ciphersuites negotiated by the implementation are limited to those in this
            requirement, then the appropriate instructions need to be contained in the guidance.
          </P>
          <p>
            While indicated as mandatory in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, the ciphersuite TLS_AES_128_GCM_SHA256 is deprecated by this <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> and should not be
            included in “other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites.” The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author may list additional <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites as they are registered.
          </p>
          <p>
            The final selection indicates the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>’s preference for negotiating a ciphersuite. <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9151 indicates the required ciphersuites for
            NSS systems and "<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9151 priority" is claimed if those ciphersuites are selected whenever offered by the client.
          </p>
          <p>
            The "ClientHello ordering" option is claimed if client priority is considered; if both are claimed, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author should indicate
            which is primary and which is secondary, and whether the priority scheme is configurable. If other priority schemes or tertiary
            priority is used, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author will claim the third option and describe the scheme in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>.
          </p>
        </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.1.3"><a href="#FCS_DTLSS_EXT.1.3" class="abbr">FCS_DTLSS_EXT.1.3</a></div><div class="reqdesc">
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a connection with a client that does not indicate support for at least one of the supported cryptographic
        parameter sets.
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
          <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> uses <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> cryptographic parameters. In <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 handshakes, the cryptographic parameters are determined by the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2
          ciphersuite components passed in the ClientHello. In <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the cryptographic parameters are determined by the ciphersuite
          components and the supported group extension. When both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 are supported, cryptographic parameters are
          determined by the highest version supported by the client.
        </p>
        <p>
          Ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 are of the form TLS_(key exchange algorithm)_WITH_(encryption algorithm)_(message digest algorithm) and
          are listed in the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters section of the internet assignments at iana.org.
        </p>
        <p>
          Ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 are of the form TLS_(AEAD)_(HASH), where (AEAD) is of the form (encryption algorithm)_(symmetric key
          length)_(mode) for an authenticated encryption with associated data specification (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5116).
        </p>
      </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.1.4"><a href="#FCS_DTLSS_EXT.1.4" class="abbr">FCS_DTLSS_EXT.1.4</a></div><div class="reqdesc">
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to process the following <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ClientHello message extensions: 
        <ul>
          <li>signature_algorithms extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for 
            [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_114">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_115">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_116">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_117">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_118">no other signature algorithms</span></li></ul>]
          </li>
        </ul>
          
           and the following other extensions: [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_119">signature_algorithms_cert extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_120">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_121">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_122">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_123">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_124">no other signature algorithms</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_125">supported_versions extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and [<b>selection</b>: <span class="selectable-content" id="_s_126"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2</span>, <span class="selectable-content" id="_s_127">no other versions</span>]</span></li><li style=""><span class="selectable-content" id="_s_128">supported_groups extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7919, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_129">secp384r1</span></li><li style=""><span class="selectable-content" id="_s_130">secp521r1</span></li><li style=""><span class="selectable-content" id="_s_131">ffdhe3072(257)</span></li><li style=""><span class="selectable-content" id="_s_132">ffdhe4096(258)</span></li><li style=""><span class="selectable-content" id="_s_133">ffdhe6144(259)</span></li><li style=""><span class="selectable-content" id="_s_134">ffdhe8192(260)</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_135">key_share extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_136">extended_master_secret extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7627) enforcing client support and
                [<b>selection</b>: <span class="selectable-content" id="_s_137">allowing legacy clients</span>, <span class="selectable-content" id="_s_138">no other enforcement mode</span>]</span></li><li style=""><span class="selectable-content" id="_s_139">no other extensions</span></li></ul>].
         
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
        <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> uses <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extensions. 
        </p>
        <p>
          Support for the signature_algorithms extension is optional in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246 but is mandated for this functional package. Support for the signature_algorithms extension is mandatory in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 and remains so in this functional package. Whether the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>'s implementation conforms to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, or both is dependent on whether the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, or both.
        </p>
        <p>
        If support for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is claimed in <a href="#FCS_DTLSS_EXT.1.1">FCS_DTLSS_EXT.1.1</a>, the selections for supported_versions, supported_groups, and key_share are claimed. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is not claimed, supported_versions and key_share are not claimed.
        </p>
        <p>
          If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is claimed, extended_master_secret extension is claimed, with the ability to enforce client support, and optionally, the ability to support legacy clients. 
        </p>
        <p>
          If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported and <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites are claimed in <a href="#FCS_DTLSS_EXT.1.2">FCS_DTLSS_EXT.1.2</a>, the entry for supported_groups is claimed. Support for additional extensions is acceptable. For signature_algorithms and signature_algorithms_certs (if supported), at least one of the signature schemes presented in the first sub-selection is claimed.
        </p>
      </span></div></div></div>    
    <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.1.5"><a href="#FCS_DTLSS_EXT.1.5" class="abbr">FCS_DTLSS_EXT.1.5</a></div><div class="reqdesc">
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall perform key establishment for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> using [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_145"><abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> with size [<b>selection</b>: <span class="selectable-content" id="_s_146">3072</span>, <span class="selectable-content" id="_s_147">4096</span>] bits and no other sizes</span></li><li style=""><span class="selectable-content" id="_s_148">Diffie-Hellman groups [<b>selection</b>: <span class="selectable-content" id="_s_149">ffdhe3072</span>, <span class="selectable-content" id="_s_150">ffdhe4096</span>, <span class="selectable-content" id="_s_151">ffdhe6144</span>, <span class="selectable-content" id="_s_152">ffdhe8192</span>] and no other groups,
            consistent with the client's supported groups extension and [<b>selection</b>: <span class="selectable-content" id="_s_153">key share</span>, <span class="selectable-content" id="_s_154">no other</span>] extension
          </span></li><li style=""><span class="selectable-content" id="_s_155"><abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> parameters using elliptic curves [<b>selection</b>: <span class="selectable-content" id="_s_156">secp384r1</span>, <span class="selectable-content" id="_s_157">secp521r1</span>] and no other curves,  
            consistent with the client's supported groups extension and [<b>selection</b>: <span class="selectable-content" id="_s_158">key share</span>, <span class="selectable-content" id="_s_159">no other</span>] extension and using non-compressed formatting for points
          </span></li></ul>].
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
          <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> uses key establishment mechanisms from the equivalent <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> version.  
        </p>
        <p>
          If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> ciphersuites are supported, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims the “<abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> with key size …” option and the key
          sizes supported. The requirements apply to the <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> key size for the server’s certificate and in the key exchange messages received
          by the server.
        </p>
        <p>
          If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and supported groups extension are supported (for <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> groups), the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims either the
          “Diffie_Hellman groups…” or “<abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> parameters...” option according to the supported ciphersuites and supported groups extension
          values. This is required when <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites are supported and recommended when <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites are supported.
        </p>
        <p>
          If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims one or both of “Diffie-Hellman groups…” or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> parameters…” options and the “key
          share” options in the sub-selections. The requirements apply to the values of the supported groups extension and the key
          share extension contained in the ServerHello messages.
        </p>
      </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.1.6"><a href="#FCS_DTLSS_EXT.1.6" class="abbr">FCS_DTLSS_EXT.1.6</a></div><div class="reqdesc">
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not proceed with a connection handshake attempt if the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client fails validation.
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        The process to validate the <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address of a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client is specified in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6347, Section 4.2.1 (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2) and in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147, Section 5.1 (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3). 
        The server validates the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client during connection establishment (handshaking) and prior to sending a ServerHello message. 
        After receiving a ClientHello, a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 server sends a HelloVerifyRequest along with a cookie, 
        whereas a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 server sends a HelloRetryRequest message along with a cookie. 
        In both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the cookie is a signed message using a keyed hash function. 
        The <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client then sends another ClientHello with the cookie attached. 
        If the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server successfully verifies the signed cookie, the client is not using a spoofed <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address.
      </span></div></div></div>
  	
  <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a></div>
        
        
              
                
      <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
          <p>
            The evaluator shall check the description of the implementation of this protocol in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure the supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> versions, features, ciphersuites, and extensions, are specified in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6347 (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2) and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147 (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and updates to <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2) as appropriate. The evaluator shall check the description to see if beta <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 versions are supported.
          </p>       
          <p>
            The evaluator shall verify that ciphersuites indicated in <a href="#FCS_DTLSS_EXT.1.2">FCS_DTLSS_EXT.1.2</a> are included in the description, and that none of the following ciphersuites are supported: ciphersuites indicating NULL, RC2, RC4, DES, IDEA, TDES, or <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>-128 in the encryption algorithm component, indicating 'anon,' or indicating MD5 or <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr> in the message digest algorithm component.
          </p>        
          <p>
            The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> implementation description includes the extensions as required in <a href="#FCS_DTLSS_EXT.1.4">FCS_DTLSS_EXT.1.4</a>.
          </p>        
          <p>
            The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> description includes the number and types of certificates that can be installed to represent the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>.
          </p>          
        </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
          <p>
            The evaluator shall check the operational guidance to ensure that it contains instructions on configuring the product so that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> conforms to the requirements. If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates that beta versions of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 are supported for backward compatibility, the evaluator shall ensure that the operational guidance provides instructions for disabling these versions.
          </p>
          <p>
            The evaluator shall review the operational guidance to ensure instructions on installing certificates representing the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> are provided.
          </p>
        </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
          The evaluator shall perform the following tests:
          <span class="testlist-"><ul>
            
            <li class="test-"><a id="_t_75" class="defined" href="#_t_75">Test FCS_DTLSS_EXT.1:1</a>:
       (supported configurations) The evaluator shall perform the following tests:
              <span class="testlist-"><ul>
                <li class="test-"><a id="dtls-server-supported-configurations" class="defined" href="#dtls-server-supported-configurations">Test FCS_DTLSS_EXT.1:1.1</a>:
      
                  [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, for each supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite, the evaluator shall send a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ClientHello with the highest version or legacy version of 1.2 (value 'fe fd'), a single entry in the ciphersuites field consisting of the specific ciphersuite, and no supported version extension or key share extension. The evaluator shall observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ServerHello indicates <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 in the highest version or legacy version field, does not include a supported version or key share extension, and indicates the specific ciphersuite in the ciphersuite field. If the ciphersuite requires certificate-based authentication, the evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a valid certificate representing the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and successfully completes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake.
                  <p>
                    <b>Note:</b> The ciphersuites TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487, TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442, and TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487, if supported, do not require certificate-based authentication of the server.
                  </p>
                </li>
                <li class="test-"><a id="_t_77" class="defined" href="#_t_77">Test FCS_DTLSS_EXT.1:1.2</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 support for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 clients) [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported and the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is configurable to support only <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 (or if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is not supported), and if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites, the evaluator shall follow any operational guidance instructions necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to only support <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2. For each supported <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ciphersuite with <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> indicated as the key exchange method, the evaluator shall send a ClientHello with the highest version or legacy version of 1.2 (value 'fe fd'), a list of ciphersuites consisting of one or more <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites followed by the specific <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite and no other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites in the ciphersuites field, and including a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 supported group and key share extension with consistent values. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ServerHello indicates <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 in the highest version or legacy version field, does not include a supported version or key share extension, and indicates the specific <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite in the ciphersuite field. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 handshake successfully.
                      <p>
                        <b>Note:</b> Supported ciphersuites using <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> key exchange should not be included in this test. The supported groups extension sent by the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client should be consistent with the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite (e.g., it should be an EC group if the ciphersuite is <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr>).
                      </p>
                </li>
        <li class="test-"><a id="_t_78" class="defined" href="#_t_78">Test FCS_DTLSS_EXT.1:1.3</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 support) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, then for each supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuite and key exchange group, the evaluator shall send a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ClientHello indicating a list of one or more <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites followed by the specific <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuite and no other ciphersuites in the ciphersuites field, a supported version extension indicating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 (value 'fe fc’) only, a supported groups extension indicating the selected group, and a key share extension containing a value representing an element of the specific group. The evaluator shall observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ServerHello contains the supported versions extension indicating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the specific ciphersuite in the selected ciphersuite field, and a key share extension containing an element of the specific supported group. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 handshake successfully.
          <p>
            <b>Note:</b> The connections in Test <a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a>:1.1 may be established as part of the establishment of a higher-level protocol, e.g., as part of an <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> session.
          </p>
          <p>
            It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr> and not 256-bit <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>).
          </p>
          <p>
            It is not necessary to pair every supported ciphersuite with every supported group. It is sufficient to use a set of ciphersuite and supported group pairs such that each ciphersuite and each supported group are included in this set.
          </p>
          <p>
            <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 includes the supported_groups extension in the encrypted_extensions message. This message may be observed at the test client after it is decrypted to help verify the key_share is actually a member of the supported group requested.
          </p>
        </li></ul></span>
        </li>             
                              
                
        <li class="test-"><a id="_t_79" class="defined" href="#_t_79">Test FCS_DTLSS_EXT.1:2</a>:
      (obsolete versions) The evaluator shall perform the following tests:
        <span class="testlist-"><ul> 
          <li class="test-"><a id="dtls-server-obsolete-versions" class="defined" href="#dtls-server-obsolete-versions">Test FCS_DTLSS_EXT.1:2.1</a>:
      For each of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 if it is not supported, the evaluator shall send a ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> indicating the selected version as the highest version. The evaluator shall observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the ClientHello message or terminates the connection.
            <p>
              <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ServerHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., protocol version, insufficient security) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
            </p></li>
          <li class="test-"><a id="dtls-server-beta-versions" class="defined" href="#dtls-server-beta-versions">Test FCS_DTLSS_EXT.1:2.2</a>:
      [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is not supported, or if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported and the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates that it processes the legacy version field, then the evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to ensure any supported beta <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 versions are disabled, as necessary. The evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a ClientHello message indicating the supported version (referred to as the legacy version in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147) with the value 'fe fc' and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> responds with a ServerHello indicating the highest version of ‘fe fd’ supported.
            <p>
              <b>Note:</b> Test <a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a>:2.2 is intended to test the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> response to non-standard versions, including beta versions of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports such beta versions, the evaluator shall follow the operational guidance instructions to disable them prior to conducting Test <a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a>:2.2.
            </p>
            <p>
              Some <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 implementations ignore the legacy version field and only check for the supported_versions extension to determine <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 support by a client. It is preferred that the legacy version field should still be set to a standard version ('fe fd') in the ServerHello, but it is acceptable that presence of the supported_versions indicating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 (value 'fe fc') overrides the legacy_version indication to determine highest supported version. In this case, this test is not performed.
            </p></li>
        </ul></span>
        </li>
          
          <li class="test-"><a id="_t_82" class="defined" href="#_t_82">Test FCS_DTLSS_EXT.1:3</a>:
      (ciphersuites) The evaluator shall perform the following tests on handling unexpected ciphersuites using a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client sending handshake messages compliant with the negotiated version except as indicated in the test:
              <span class="testlist-"><ul>
                <li class="test-"><a id="_t_83" class="defined" href="#_t_83">Test FCS_DTLSS_EXT.1:3.1</a>:
      (ciphersuite not supported) For each supported version, the evaluator shall follow the operational guidance, if available, to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to disable a supported ciphersuite. The evaluator shall send a compliant ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> indicating support for the specific version and a ciphersuites field containing this single disabled ciphersuite. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently ignores the message or rejects the connection.
                  <p>
                    <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                  </p>
                  <p>
                    If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ciphersuites are not configurable, it is acceptable to use a named ciphersuite from the IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> protocols associated with the tested version. Additional special cases of this test for special ciphersuites are performed separately.
                  </p>
                </li>
                <li class="test-"><a id="dtls-server-version-confusion" class="defined" href="#dtls-server-version-confusion">Test FCS_DTLSS_EXT.1:3.2</a>:
      (version confusion) For each supported version, the evaluator shall send a ClientHello that is compliant for the specific version that includes a list of ciphersuites consisting of a single ciphersuite not associated with that version. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently drops the message or rejects the connection.
                  <p>
                    <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                  </p>
                  <p>If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, Test <a href="#dtls-server-version-confusion" class="dynref">Test FCS_DTLSS_EXT.1:3.2</a> sends a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuite to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as a server negotiating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, using a supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuite if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported, Test <a href="#dtls-server-version-confusion" class="dynref">Test FCS_DTLSS_EXT.1:3.2</a> sends a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites with compatible supported_group, signature_algorithms, and key_ share extensions to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as a server negotiating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, using a supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2.
               </p>
                </li>
                <li class="test-"><a id="_t_85" class="defined" href="#_t_85">Test FCS_DTLSS_EXT.1:3.3</a>:
      (null ciphersuite) For each supported version, the evaluator shall send a ClientHello indicating support for the version and include a ciphersuite list consisting of only the null ciphersuite (TLS_NULL_WITH_NULL_NULL, with the value '00 00') and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently drops the message or rejects the connection.
                  <p>
                    <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                  </p>
                </li>
                <li class="test-"><a id="_t_86" class="defined" href="#_t_86">Test FCS_DTLSS_EXT.1:3.4</a>:
      
                  <p>
                    (anonymous connection request) The evaluator shall perform one or more of the following tests according to the supported <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> versions:
                  </p>
                  <p>
                    [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 handshake that is compliant, except that the ciphersuites field includes a ciphersuite list consisting only of ciphersuites using the anonymous server authentication method and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently drops the message or rejects the connection.
                  </p>
                  <p>
                    <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                  </p>
                <p>
                  See IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters for available ciphersuites to be included in the ClientHello. The test ciphersuites list should include ciphersuites using supported cryptographic algorithms in as many of the other components as possible. For example, if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports the ciphersuite TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the evaluator should include TLS_DH_ANON_WITH_AES_256_GCM_SHA_384.
                </p>
                  <p>
                    [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> (if necessary) to not support anonymous server requests, and send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a ClientHello containing the server_cert_type extension indicating only ‘raw public key’ type. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> either ignores the extension (the extension is not supported), proceeding with a normal <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake, to include sending a valid certificate and certificate verify message, it silently drops the message, or it terminates the session (the extension is supported, but the anonymous server functionality is not supported).
                  </p>
                  <p>
                    <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates the extension is not supported and the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> ignores the extension and completes the expected handshake, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates the server_cert_type extension is supported and the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., unsupported_certificate) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                  </p>
                </li>
                <li class="test-"><a id="dtls-server-deprecated-encryption" class="defined" href="#dtls-server-deprecated-encryption">Test FCS_DTLSS_EXT.1:3.5</a>:
      
                  <p>
                    (deprecated encryption algorithm) The evaluator shall perform one or more of the following, depending on the supported versions:
                  </p>
                    <p>
                    [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ClientHello that is compliant with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9151, except that the ciphersuites field is a list consisting only of ciphersuites indicating a deprecated encryption algorithm, including at least one each of NULL, RC2, RC4, DES, IDEA, TDES, and <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>-128. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently drops the message or rejects the connection.
                  </p>
                  <p>
                    <b>Note:</b> See IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters for available <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites to be included. The test ciphersuite should use supported cryptographic algorithms for as many of the other components as possible. For example, if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test could include TLS_ECDHE_PSK_WITH_NULL_SHA_384, TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5, TLS_ECDHE_RSA_WITH_RC4_128_SHA, TLS_DHE_DSS_WITH_DES_CBC_SHA, TLS_RSA_WITH_IDEA_CBC_SHA, and TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA.
                  </p>
                    <p>
                      If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                    </p>        
                  <p>
                    [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ClientHello that is compliant with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9151, except that the ciphersuites field contains the single ciphersuite TLS_AES_128_GCM_SHA256. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> silently drops the message or rejects the connection. 
                  </p>
              <p>
                <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
              </p>
              </li>
              </ul></span>
          </li>
                
                
                <li class="test-"><a id="_t_88" class="defined" href="#_t_88">Test FCS_DTLSS_EXT.1:4</a>:
      (extensions)
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_89" class="defined" href="#_t_89">Test FCS_DTLSS_EXT.1:4.1</a>:
      
                      (signature algorithms) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports certificate-based authentication, 
                      then for each supported signature algorithm indicated in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>, the evaluator shall perform the following sub-tests with certificates that represent the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>. 
                      For each sub-test, the evaluator shall establish a certificate
                      representing the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and using a public-private key pair suitable for the specific signature algorithm value, and signed by a certification authority
                      that uses the same signature algorithm.
                      <p>
                        If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> also supports the signature_algorithms_cert extension, then for each value of the signature_algorithms_cert extension, 
                        the evaluator shall repeat the sub-tests 
                        
                        using a certificate representing the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and using a key pair consistent with the signature algorithm, 
                        but signed by a certification authority using the signature algorithm specified in the signature_algorithms_cert extension. 
                      </p><p>
                        <b>Note:</b> If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports certificate-based server authentication if the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 supported ciphersuites include ciphersuites other than 
                        TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487, 
                        TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442, and TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487. 
                        If these are the only supported ciphersuites, this test is omitted. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported, certificate-based server authentication is required, and the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ClientHello for the test should not include the PSK extension.
                      </p><p>
                        The evaluator shall follow operational guidance instructions to provision the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> with one or more of these certificates as indicated in the following sub-tests:
                      </p>
                      <span class="testlist-"><ul>
                        <li class="test-"><a id="dtls-server-correct-signature" class="defined" href="#dtls-server-correct-signature">Test FCS_DTLSS_EXT.1:4.1.1</a>:
      [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, then for each supported value of the signature_algorithms extension, the evaluator shall provision a certificate with a key pair compatible with the specific signature_algorithm value and 
                          send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ClientHello that indicates all supported ciphersuites and has a signature_algorithms extension consisting of a single value matching the specific signature algorithm.
                          <p>
                            If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports the signature_algorithms_cert extension, the ClientHello also contains the value consistent with the provisioned certificate.
                          </p><p>
                            The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> negotiates <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 with
                            a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ciphersuite that is compatible with the signature algorithm, and that it sends a certificate message containing the provisioned certificate with a key pair that is consistent 
                            with the specific signature_algorithm value (and signed using the signature_algorithms_cert extension value, if supported). 
                          </p><p>
                            <b>Note:</b> For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, the ciphersuite describes the signature algorithm as <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> 
                            and is compatible with the certificate used if the signature algorithm component of the ciphersuite is of the same type as the signature value of the signature_algorithms extension. 
                          </p>
                        </li>
                        <li class="test-"><a id="dtls-server-correct-1-3-signature" class="defined" href="#dtls-server-correct-1-3-signature">Test FCS_DTLSS_EXT.1:4.1.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, then for each supported value of the signature_algorithm, 
                          the evaluator shall provision a certificate with a key pair that is compatible with the specific signature_algorithm value, 
                          send a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ClientHello that indicates a supported ciphersuite and has a signature_algorithms extension consisting of a single value matching the specific signature algorithm. 
                          <p>
                            If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports the signature_algorithms_cert extension, the ClientHello also contains a signature_algorithms_cert extension with a value consistent with the provisioned certificate.
                          </p><p>
                            The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a certificate message containing the provisioned certificate consistent with the 
                            specific signature_algorithm value (and signed using the signature_algorithms_cert extension value) and a certificate verify message using the signature_algorithms extension value.
                          </p><p>
                            <b>Note:</b> For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the certificate message and certificate verify is encrypted. The evaluator shall confirm the values of these messages as received at the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client, using logs, or using a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client designed to expose the certificates after they are decrypted. 
                          </p><p>
                            It is not necessary to manually verify the signature used in the key exchange message (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2) or certificate verify message (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3). 
                          </p></li>
                        <li class="test-"><a id="_t_92" class="defined" href="#_t_92">Test FCS_DTLSS_EXT.1:4.1.3</a>:
      
                          [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports provisioning of multiple certificates, 
                          the evaluator shall conduct the following sub-tests:
                          <span class="testlist-"><ul>
                            <li class="test-"><a id="dtls-server-mismatch-signature" class="defined" href="#dtls-server-mismatch-signature">Test FCS_DTLSS_EXT.1:4.1.3.1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, the evaluator shall repeat <a href="#dtls-server-correct-signature" class="dynref">Test FCS_DTLSS_EXT.1:4.1.1</a> with both the provisioned certificate indicated for 
                              <a href="#dtls-server-correct-signature" class="dynref">Test FCS_DTLSS_EXT.1:4.1.1</a> and a provisioned certificate using a public key that is not consistent with the 
                              signature_algorithm value, but signed by a <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> using the signature algorithm specified in the ClientHello. 
                              The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s certificate message does not include the certificate that does not match 
                              the signature_algorithm value in the ClientHello. </li>
                            <li class="test-"><a id="dtls-server-mismatch-1-3-signature" class="defined" href="#dtls-server-mismatch-1-3-signature">Test FCS_DTLSS_EXT.1:4.1.3.2</a>:
      [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, 
                              the evaluator shall similarly repeat <a href="#dtls-server-correct-1-3-signature" class="dynref">Test FCS_DTLSS_EXT.1:4.1.2</a> 
                              with both the provisioned certificate indicated for <a href="#dtls-server-correct-1-3-signature" class="dynref">Test FCS_DTLSS_EXT.1:4.1.2</a> and a provisioned certificate 
                              with public keys that are not consistent with the signature_algorithm value but which are signed by a <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> 
                              using the signature_algorithm value specified in the ClientHello, 
                              and observe that the certificate message sent by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not include the certificate that 
                              does not match the value of the signature_algorithm entry in the ClientHello. </li>
                            <li class="test-"><a id="_t_95" class="defined" href="#_t_95">Test FCS_DTLSS_EXT.1:4.1.3.3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> also indicates support for the signature_algorithms_cert extension, 
                              the evaluator shall repeat <a href="#dtls-server-mismatch-signature" class="dynref">Test FCS_DTLSS_EXT.1:4.1.3.1</a> (if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported) and <a href="#dtls-server-mismatch-1-3-signature" class="dynref">Test FCS_DTLSS_EXT.1:4.1.3.2</a> 
                              (if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported) using additional provisioned certificates 
                              representing the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> that use public keys consistent with the signature_algorithm value, 
                              but which are signed by CAs using signature algorithms that do not match the value of the signature_algorithms_cert in the ClientHello 
                              and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s certificate message does not include the certificate that does not match 
                              the signature_algorithms_cert values in the ClientHello.</li>
                          </ul></span>  
                        </li>
                        <li class="test-"><a id="_t_96" class="defined" href="#_t_96">Test FCS_DTLSS_EXT.1:4.1.4</a>:
      [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, the evaluator shall provision a certificate as in <a href="#dtls-server-correct-signature" class="dynref">Test FCS_DTLSS_EXT.1:4.1.1</a>, 
                          but shall send a ClientHello that only offers ciphersuites whose signature component does not match the value of the signature_algorithms extension. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the handshake.
                          <p>
                            <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure, illegal parameter) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                          </p></li>
                      </ul></span>
                    </li>
                    <li class="test-"><a id="_t_97" class="defined" href="#_t_97">Test FCS_DTLSS_EXT.1:4.2</a>:
      (extended master secret) [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary to enforce client support for extended master secret. The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 session with the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> from a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client for which the ClientHello does not include the extended master secret extension and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                      <p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake error) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                      </p>
                    </li>
                  </ul></span>
                </li>
                
                
                <li class="test-"><a id="dtls-server-key-exchange" class="defined" href="#dtls-server-key-exchange">Test FCS_DTLSS_EXT.1:5</a>:
      
                  (key exchange) The evaluator shall perform the following tests to confirm compliant key exchange:
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_99" class="defined" href="#_t_99">Test FCS_DTLSS_EXT.1:5.1</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> key exchange) [conditional] If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported and if any of the supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> includes <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> for the key exchange method, the evaluator shall perform the following sub-tests:
                      <span class="testlist-"><ul>
                        <li class="test-"><a id="_t_100" class="defined" href="#_t_100">Test FCS_DTLSS_EXT.1:5.1.1</a>:
      For each supported <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> key size, the evaluator shall provision the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> with a valid certificate that has an <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> public key of that size. 
                          The evaluator shall initiate a valid <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 handshake from a compliant test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 client and observe that the server certificate message matches the provisioned certificate.</li>
                        <li class="test-"><a id="_t_101" class="defined" href="#_t_101">Test FCS_DTLSS_EXT.1:5.1.2</a>:
      For each supported <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> key size, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ClientHello, 
                          but in place of the client’s key exchange message, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a (non-compliant) key exchange message that is properly formatted but uses an invalid EncryptedPreMasterSecret 
                          field in the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake (e.g., modify a byte of a properly computed value). 
                          The evaluator shall attempt to complete the handshake using compliant client change cipher spec and finished messages and verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the handshake in a manner that is indistinguishable 
                          from a finished message error and does not send application data.
                          <p>
                            <b>Note:</b> Mitigations for oracle attacks described in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246 Appendix D require the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to exhibit the same behavior for key exchange failures as it does for finished message failures.
                            While <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> generally allows invalid messages to be silently dropped, this behavior may produce an oracle. Recommended approaches include generating a random key and continuing the handshake until after
                            the finished message is received. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session and sends an error alert message, it is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> send a fatal decrypt failure error alert at the end of the handshake in both this case and for a finished message error,  
                            but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminate the session with another error alert, or without sending an error alert in either case. 
                            If the failure error alert is not for a decryption failure, the evaluator shall note that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s response agrees with the response observed 
                            in the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 iteration of <a href="#dtls-server-rejects-bad-client-finished" class="dynref">Test FCS_DTLSS_EXT.1:5.2</a>. 
                          </p>
                        </li>
                      </ul></span>
                    </li>
                    <li class="test-"><a id="dtls-server-rejects-bad-client-finished" class="defined" href="#dtls-server-rejects-bad-client-finished">Test FCS_DTLSS_EXT.1:5.2</a>:
      For each supported version, the evaluator shall initiate a compliant handshake up through the (implied for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3) change cipher spec message. 
                      The evaluator shall then send a (non-compliant) client finished handshake message with an invalid ‘verify data’ value and 
                      verify that the server silently drops the message or terminates the session and does not send any application data.
                      <p>
                        <b>Note:</b> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 handshakes include explicit change cipher spec messages, 
                        but <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 omits the change cipher spec message. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported, the modified finished message is sent as the final message from the client 
                        after receiving the server’s second flight of handshake messages [encrypted extensions, (new ticket), (certificate, certificate verify), (certificate request)].
                      </p><p>
                        <b>Note:</b>
                        If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects the connection, and no application data is sent, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the client finished message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out, noting that no application data is sent. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal decryption failure error alert, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminate the session using another error alert or without logging an error alert.
                      </p><p>
                        The finished message is encrypted. The invalid ‘verify data’ can be constructed by modifying a byte of a compliant finished message payload.
                      </p>
                    </li>                    
                        <li class="test-"><a id="_t_103" class="defined" href="#_t_103">Test FCS_DTLSS_EXT.1:5.3</a>:
      
                          (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> key exchange) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and supports <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, then the evaluator shall perform
                          the following sub-tests:
                          <span class="testlist-"><ul>
                          <li class="test-"><a id="_t_104" class="defined" href="#_t_104">Test FCS_DTLSS_EXT.1:5.3.1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, supports <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites, and supports <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> groups in the supported
                          groups extension, then for each supported <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> group, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 client
                          hello indicating a single ciphersuite that is compatible with the group and indicating the group in the supported
                          groups extension. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> negotiates <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 using the indicated ciphersuite and
                          that the server key exchange message indicates the specific group. The evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> a client key 
                          exchange with a valid point in the group and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully completes the session.
                          </li><li class="test-"><a id="_t_105" class="defined" href="#_t_105">Test FCS_DTLSS_EXT.1:5.3.2</a>:
      
                            The evaluator shall send a ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as in the previous test with identical ciphersuite and supported
                            group extension values. After the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> responds with a valid key exchange message, the evaluator shall send the 
                            <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a client key exchange with the public key value '0.' The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops
                            the message or terminates the session.
                          </li><li class="test-"><a id="_t_106" class="defined" href="#_t_106">Test FCS_DTLSS_EXT.1:5.3.3</a>:
      
                            The evaluator shall send a ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as in the previous two tests including the same ciphersuite, but now instead indicating a group not supported by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> in the supported groups extension. 
                            The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                            <p>
                            <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the sessions for the second and third handshake, the test is successful.
                              If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the key exchange message (second handshake) and ClientHello message (third 
                              handshake), the evaluator shall continue sending the respective messages until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is 
                              preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., decryption failure, illegal parameter, 
                              handshake error) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently
                              (i.e., without logging a fatal error alert). 
                          </p>                                                    
                        </li>
                            
                        <li class="test-"><a id="_t_107" class="defined" href="#_t_107">Test FCS_DTLSS_EXT.1:5.3.4</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites (and therefore supports <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> groups in the supported groups extension), 
                          the evaluator shall send a ClientHello message indicating a single supported <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuite and including the supported <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> group in the supported groups extension. 
                          The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a key exchange message with a valid point of the specified group. 
                          The evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a client key exchange message to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> consisting of a valid element in the supported group and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully completes the session.
                        </li><li class="test-"><a id="_t_108" class="defined" href="#_t_108">Test FCS_DTLSS_EXT.1:5.3.5</a>:
      
                            The evaluator shall send a ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as in the previous test with identical ciphersuite and supported
                            group extension values. After the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends the valid key exchange message, the evaluator shall send a client key 
                            exchange message consisting of an invalid element of the supported group and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops
                            the key exchange message or terminates the handshake.
                        </li><li class="test-"><a id="_t_109" class="defined" href="#_t_109">Test FCS_DTLSS_EXT.1:5.3.6</a>:
      
                            The evaluator shall send a third ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as in the previous two tests indicating the same supported <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuite, but now instead including an <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> group that is not supported. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the ClientHello message or terminates the session. 
                          <p>
                            <b>Note:</b> Note: If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the sessions for the second and third handshake, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the key exchange message (second handshake) and ClientHello message (third handshake), the evaluator shall continue sending the respective messages until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., decryption failure, illegal parameter, handshake error, insufficient security) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).  
                          </p><p>
                            An invalid <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> point consists of properly formatted x and y components, but for which the equation of the curve is not satisfied. To obtain an invalid point, the evaluator shall modify a byte of the y coordinate value of a valid point and confirm that the point is not on the curve. 
                          </p><p>
                            The IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters website lists registered <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> groups for use in selecting a non-supported group. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports all registered <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> groups, it is acceptable to send the ClientHello without a supported groups extension. The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> should reject such a ClientHello, but it is acceptable for the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to default to a supported group. In this case, the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> passes the test.
                          </p>
                        </li>                      
                          </ul></span>
                        </li>  
                    <li class="test-"><a id="_t_110" class="defined" href="#_t_110">Test FCS_DTLSS_EXT.1:5.4</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 key exchange) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, then for each supported group the evaluator shall perform the following sub-tests: 
                      <span class="testlist-"><ul>
                        <li class="test-"><a id="_t_111" class="defined" href="#_t_111">Test FCS_DTLSS_EXT.1:5.4.1</a>:
      The evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ClientHello indicating a single key share value from the supported group and shall observe that the ServerHello 
                          includes valid elements of the supported group.</li>
                        <li class="test-"><a id="_t_112" class="defined" href="#_t_112">Test FCS_DTLSS_EXT.1:5.4.2</a>:
      The evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ClientHello indicating a supported groups value supported by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> 
                          but containing a key share extension indicating an element claiming to be in the supported group that does not represent a 
                          valid element of the group. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                          <p>
                            <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., illegal parameter, handshake failure, decryption failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                          </p><p>
                            For <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> groups, the invalid element may be of the wrong length; 
                            for <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> groups, the invalid element has coordinates (x and y) that do not satisfy the equation of the elliptic curve. 
                            To obtain an invalid <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> point, the evaluator shall modify a byte of the y coordinate value of a valid point and confirm that the point is not on the curve.
                          </p></li>
                      </ul></span>
                    </li>
                    
                          <li class="test-"><a id="tls-server-no-finished-msg" class="defined" href="#tls-server-no-finished-msg">Test FCS_DTLSS_EXT.1:5.5</a>:
      For each supported version, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake from a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client 
                      with compliant handshake messages negotiating the version and supported parameters 
                      to include the change cipher spec message (implied for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3), but which omits the finished message and instead 
                      sends an application message containing random data. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or 
                      terminates the connection.
                      <p>
                        <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the application message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., decryption failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                      </p><p>
                        Application data is indicated by the TLSCipherText ContentType field having value 23 (application data). 
                        The legacy record version '03 03' and length fields should match a valid TLSCipherText message of the same size.
                      </p>
                    </li>
                    </ul></span> 
                </li>
                <li class="test-"><a id="_t_114" class="defined" href="#_t_114">Test FCS_DTLSS_EXT.1:6</a>:
      
                  [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, the evaluator shall send a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ClientHello message from a test client and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a HelloVerifyRequest message. The evaluator shall modify at least one byte in the cookie from the server's HelloVerifyRequest message and include the modified value as a cookie in the test client’s second ClientHello message. The evaluator shall verify that the server rejects the client's handshake message.
                </li>
                <li class="test-"><a id="_t_115" class="defined" href="#_t_115">Test FCS_DTLSS_EXT.1:7</a>:
      
                  [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the evaluator shall send a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 ClientHello message from a test client and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a HelloRetryRequest message. The evaluator shall modify at least one byte in the cookie from the server's HelloRetryRequest message and include the modified value as a cookie in the test client’s second ClientHello message. The evaluator shall verify that the server rejects the client's handshake message.
                </li>
          </ul></span>
        </div></div></div></div></div>

  <div class="comp" id="FCS_DTLSS_EXT.2"><h4>FCS_DTLSS_EXT.2 DTLS Server Support for Mutual Authentication</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_DTLSS_EXT.1.1">FCS_DTLSS_EXT.1.1</a>.
      </i></b></div>
    
    
    
    
    
    
    
          <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.2.1"><a href="#FCS_DTLSS_EXT.2.1" class="abbr">FCS_DTLSS_EXT.2.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support authentication of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> clients using X.509v3 certificates during the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake and [<b>selection</b>: <span class="selectable-content" id="_s_160">during post-handshake requests</span>, <span class="selectable-content" id="_s_161">at no other time</span>] 
                using the certificate types indicated in the client’s signature_algorithms and [<b>selection</b>: <span class="selectable-content" id="_s_162">signature_algorithms_cert</span>, <span class="selectable-content" id="_s_163">no other</span>] extension.
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
              This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "mutual authentication" is selected in <a href="#FCS_DTLSS_EXT.1.1">FCS_DTLSS_EXT.1.1</a>.
              </p><p>
              All application notes for <a href="#FCS_TLSS_EXT.2.1">FCS_TLSS_EXT.2.1</a> apply to this requirement, with references to <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> replaced by the equivalent reference to <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>.
              </p>
      </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.2.2"><a href="#FCS_DTLSS_EXT.2.2" class="abbr">FCS_DTLSS_EXT.2.2</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support authentication of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> clients using X.509v3 certificates in accordance with <span class="no-link">FIA_X509_EXT.1</span>.</div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.2.3"><a href="#FCS_DTLSS_EXT.2.3" class="abbr">FCS_DTLSS_EXT.2.3</a></div><div class="reqdesc">
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to reject the establishment of a trusted channel if the requested client certificate is invalid and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_164">continue establishment of a server-only authenticated <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel in accordance with <a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a> in support of [<b>selection</b>: <span class="selectable-content" id="_s_165">all applications</span>, <span class="selectable-content" id="_s_166">[<b>assignment</b>: 
     <span class="assignable-content">list of calling applications that accept both authenticated and unauthenticated client sessions</span>]</span>] 
            when an empty certificate message is provided by the client</span></li><li style=""><span class="selectable-content" id="_s_167">continue establishment of a mutually authenticated <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel when revocation status information for the
            [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_168">client's leaf certificate</span></li><li style=""><span class="selectable-content" id="_s_169">[<b>assignment</b>: 
     <span class="assignable-content">specific intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificates</span>]</span></li><li style=""><span class="selectable-content" id="_s_170">any non-trust store certificate in the certificate chain</span></li></ul>]  
            is not available in support of
            [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_171">all applications</span></li><li style=""><span class="selectable-content" id="_s_172">[<b>assignment</b>: 
     <span class="assignable-content">list of calling applications configurable to perform certificate status information bypass processing
              </span>]</span></li></ul>]
            as [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_173">configured by an administrator</span></li><li style=""><span class="selectable-content" id="_s_174">confirmed by the supported function user</span></li><li style=""><span class="selectable-content" id="_s_175">a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>-specific default for [<b>assignment</b>: 
     <span class="assignable-content">subset of supported function</span>]</span></li></ul>]
          </span></li><li style=""><span class="selectable-content" id="_s_176">no other processing options for missing or invalid client certificates</span></li></ul>]. 
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
                <p>
                  The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims any certificate processing exceptions that are allowed for specific calling applications. The 
                  "continue establishment of a server-only authenticated <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel…" selection is claimed if the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> product supports
                  applications that can provide services to unauthenticated users if the user does not possess an appropriate certificate.
                  Within this selection, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates which applications are able to support both authenticated and unauthenticated
                  users.
                </p>
                <p>
                  The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims "continue establishment of a mutually authenticated <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel…" if there is an administrator
                  configuration or user confirmation that revocation status information is not available for one or more of the certificates
                  in the client’s certificate chain. If claimed, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author will describe in the assignment for intermediate values which
                  <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificates are included in the exception (for example, “all intermediates but the issuing <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>” or “specific end-entity
                  certificates as configured”). Within this selection, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author specifies which applications are impacted and which
                  supported function or authorized user is allowed to approve continuing with the session when revocation information is not
                  available. If an administrator configures that a user may accept a certificate without status information, both selections
                  are claimed. The "as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>-specific default..." should only be selected for applications that do not have access to revocation
                  information. This is not claimed when alternate revocation methods are claimed in <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> that apply to <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client
                  certificates. Methods for obtaining revocation information are included in <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>.
                </p>
              </span></div></div></div>
    <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.2.4"><a href="#FCS_DTLSS_EXT.2.4" class="abbr">FCS_DTLSS_EXT.2.4</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_177">not establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session if an entry of the Distinguished Name or a [<b>selection</b>: <span class="selectable-content" id="_s_178">rfc822_name</span>, <span class="selectable-content" id="_s_179">dns_name</span>, <span class="selectable-content" id="_s_180">[<b>assignment</b>: 
     <span class="assignable-content">supported name types</span>]</span>]
          in the Subject Alternate Name extension contained in the client certificate does not match one of the expected identifiers for the client in accordance with [<b>selection</b>: <span class="selectable-content" id="_s_181"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822</span>, <span class="selectable-content" id="_s_182"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span>, <span class="selectable-content" id="_s_183"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280</span>, <span class="selectable-content" id="_s_184">[<b>assignment</b>: 
     <span class="assignable-content"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> for the supported name type</span>]</span>]
          matching rules</span></li><li style=""><span class="selectable-content" id="_s_185">pass the [<b>selection</b>: <span class="selectable-content" id="_s_186">validated certificate</span>, <span class="selectable-content" id="_s_187"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822 name normalized according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822</span>, <span class="selectable-content" id="_s_188"><abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name normalized according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span>, <span class="selectable-content" id="_s_189">[<b>assignment</b>: 
     <span class="assignable-content">list of <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280 name types and normalization rules</span>]</span>, <span class="selectable-content" id="_s_190">[<b>assignment</b>: 
     <span class="assignable-content">list of 'other' name types and standard normalization rules</span>]</span>] 
          to [<b>assignment</b>: 
     <span class="assignable-content">list of calling applications capable of making access decisions</span>]</span></li><li style=""><span class="selectable-content" id="_s_191">pass initial name constraints of type [<b>selection</b>: <span class="selectable-content" id="_s_192">directory name</span>, <span class="selectable-content" id="_s_193">rfc_822_name</span>, <span class="selectable-content" id="_s_194">dns_name</span>, <span class="selectable-content" id="_s_195">[<b>assignment</b>: 
     <span class="assignable-content">supported name types</span>]</span>]
          to the certification path processing function to verify, in accordance with <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>, that the presented identifier matches an
          expected client identifier
        </span></li></ul>].     
      <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
        <p>
          Authorization for services provided by the applications that are protected by the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session is determined by the supported
          function establishing a set of reference identifiers, by passing the received identifiers to the supported function, or by passing
          initial name constraints to the certification path validation function. The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates the methods supported, and for each
          method supported, indicates all name types supported; if name types are processed by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>, at least one name type is required.
          In the assignment of the first option, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates all name types and the corresponding method for matching in the
          sub-selections. In the second method option, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates which name type normalizations the product supports. If the
          product passes the entire validated certificate to the application, no normalization of the names contained in the certificate is
          expected. If the third method is claimed, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates which name types are supported for formulating initial name
          constraints.
        </p>
        <p>
          If name normalization is claimed, care should be taken regarding wildcards and <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses. <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses embedded in <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> host names
          and in Directory Name <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> components have been observed to include non-standard wildcard designations including the asterisk (*). Any
          embedded <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses should use standard CIDR notation and should not include nonstandard encoding.
        </p>
      </span></div></div></div>
	  
      <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSS_EXT.2">FCS_DTLSS_EXT.2</a></div>
        
        
        
      <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
          <p>
            The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> description required per <span class="no-link">FIA_X509_EXT.2.1</span> includes the use of client-side certificates for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> mutual authentication, 
            and that the description includes any certificate validation exception rules and the name types supported for matching to reference identifiers for all applications that use <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>. 
            The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure that any <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-embedded name types that are used include a description of the encoding and matching rules.</p><p>
              The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> includes a description of each response option claimed in <a href="#FCS_DTLSS_EXT.2.3">FCS_DTLSS_EXT.2.3</a>, to include the supporting functions using the option, and the behavior of functions exercising a non-authenticated option or exception processing (if claimed).
            </p>
        </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
          <p>
            The evaluator shall verify that the operational guidance includes instructions for configuring trust stores for client-side certificates used in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> mutual authentication. 
            The evaluator shall ensure that the operational guidance includes instructions for configuring the server to require mutual authentication of clients using these certificates and for configuring any certificate validation exception rules. 
            The evaluator shall ensure that the operational guidance includes instructions for configuring reference identifiers normalized or matched by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and matching rules for the supported name types.
          </p>
        </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
          The evaluator shall use <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a function to verify that the validation rules in <span class="no-link">FIA_X509_EXT.1</span> are adhered to and shall perform the tests listed below in conjunction with testing for <span class="no-link">FIA_X509_EXT.1</span>. 
          The evaluator shall apply the operational guidance to configure the server to require <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> mutual authentication of clients for these tests unless overridden by instructions in the test activity.
          <p>
            <b>Note:</b> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is a fundamentally different protocol than <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, so even though the certificate validation and name checking tests are identical for both versions, it is likely that early deployments of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 may use a different code-base that warrants independent testing. If both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 are supported and the evaluator can verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> uses the same code-base for certificate validation and name checking for both <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, it is acceptable that testing be performed for only one version for these tests.
          </p>
          <span class="testlist-"><ul>
            <li class="test-"><a id="_t_116" class="defined" href="#_t_116">Test FCS_DTLSS_EXT.2:1</a>:
      
              For each supported version, the evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to require valid client authentication with no exceptions in support of a function (configured, as necessary) that does not allow unauthenticated sessions, and initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session from a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> test client 
              supporting that version. The evaluator shall ensure that the test client sends a certificate_list structure which has a length of zero. The evaluator shall verify the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session, and that no application data flows. 
              <p>
                <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the client certificate message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure, bad certificate, unknown certificate, unknown <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
              </p>
            </li>
            <li class="test-"><a id="_t_117" class="defined" href="#_t_117">Test FCS_DTLSS_EXT.2:2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports establishment of a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session for missing or invalid certificates, then for each supported version, 
              and for each supported response option for a missing or invalid certificate indicated in <a href="#FCS_DTLSS_EXT.2.3">FCS_DTLSS_EXT.2.3</a>, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> according to the operational guidance 
              to respond as indicated for the calling application. The evaluator shall send client handshake messages from a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client as indicated for each sub-test. The evaluator shall perform the following sub-tests:
              <span class="testlist-"><ul>
                <li class="test-"><a id="_t_118" class="defined" href="#_t_118">Test FCS_DTLSS_EXT.2:2.1</a>:
      [conditional]: If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports non-authenticated session establishment when receiving an empty certificate message, 
                  the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake from a compliant test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client supporting the version and providing a certificate message 
                  containing a certificate_list structure of length zero. The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> notifies the calling application that the user is unauthenticated.
                  <p>
                    <b>Note:</b> Specific procedures for determining that the calling application is notified will vary based on the application. 
                    If an API to the calling application is not available, the evaluator may attempt to configure the calling application to provide a different response 
                    (e.g., require authentication for flagged data) for authenticated and non-authenticated users and make a request at the test client that results in a response 
                    indicating the application is treating the client as non-authenticated.
                  </p></li>
                <li class="test-"><a id="_t_119" class="defined" href="#_t_119">Test FCS_DTLSS_EXT.2:2.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports exceptions for when revocation status information is unavailable, 
                  then the evaluator shall follow the operational guidance to attempt to establish a narrowly defined exception for which both exempt and non-exempt certificates can be established. 
                  The evaluator shall establish a primary certificate chain for the test client that only exhibits the allowed exception 
                  and one or more alternate certificate chains for the test client that do not pass the exception rule, as necessary to test the boundaries of the exception rules. 
                  <p>
                    The evaluator shall follow the operational guidance to remove any cached revocation status information for the test client’s primary certificate chain. 
                    The evaluator shall initiate a valid <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session from the test client that presents the primary certificate for the test client, 
                    provide any feedback requested by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to confirm the exception, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> allows the certificate and completes the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake successfully. 
                  </p><p>
                    For each alternate certificate chain, the evaluator shall repeat the session initiation from the test client but present the alternate certificate chain and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                  </p><p>
                    <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the client certificate and certificate verify messages until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., bad certificate, unknown certificate, access denied, handshake error) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                  </p><p>
                    The alternate certificate chains are intended to test the boundaries of the exception rules. 
                    For example, if the exception rule indicates that only leaf certificates are exempt, the evaluator shall include an alternate certificate chain for which a <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate’s revocation information is advertised but is not available; 
                    if the exception can be configured for an explicit leaf certificate, or particular subjects, an alternate chain will be included that does not include an excepted certificate or subject. 
                    If the exception rules can be configured for all certificates having advertised revocation information, an alternate certificate chain can include an expired certificate – only one additional validity failure 
                    (e.g., expired certificate) is required in this case. More comprehensive validity failure handling is addressed by testing for <span class="no-link">FIA_X509_EXT.1</span>.
                  </p></li>
              </ul></span>
            </li>
            <li class="test-"><a id="_t_120" class="defined" href="#_t_120">Test FCS_DTLSS_EXT.2:3</a>:
      For each supported version, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to negotiate the version and require client authentication and perform the following steps: <ul>
              <li>For each supported name matching method indicated in <a href="#FCS_DTLSS_EXT.2.4">FCS_DTLSS_EXT.2.4</a>, and for each name type supported by the matching method,
                the evaluator shall establish a valid primary certificate chain with a leaf certificate containing a single name of the supported type matching a reference ID and a valid alternate certificate chain with a leaf certificate containing a single name indicating a different name of the same type not matching a reference ID.</li>
              <li>[conditional] If any of the supported name types include <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> encoding of a name type also supported as a <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> entry, the evaluator shall                 
                establish additional certificate chains:
                <ul>
                  <li>The evaluator shall establish a primary certificate chain with multiple names, to include a leaf certificate with: 
                    <ul>
                      <li>a <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> entry that matches the name in the primary certificate chain with single names, of the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name type; and </li>
                      <li>a <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> entry encoding the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> type which matches the name in the alternate certificate chain with single names of the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> encoding of the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name type;</li>
                    </ul></li>
                  <li>The evaluator shall establish an alternate certificate chain with multiple names, to include a leaf certificate with:
                    <ul>
                      <li>a <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> entry that matches the name in the alternate certificate chain with single names, of the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name type; and</li> 
                      <li>a <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> entry encoding the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> type which matches the name in the primary certificate chain with single names, of the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> encoding of the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name type.</li>
                    </ul></li>
                </ul></li>
              <li>[conditional] If any of the supported name types include <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> encoding, the evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>, 
                establishing trust in the root <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> for all primary and alternate certificate chains. 
                The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and any relevant <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> applications that use <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> for client authentication as necessary to establish reference identifiers that match the names in the client’s primary certificate chains 
                with single names, but not matching any of the names in the alternate certificate chains with single names.</li>
              <li>For each primary certificate chain (with single or multiple names), the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session from the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client that is configured to present the primary certificate chain 
                in a certificate message and a valid certificate verify message in response to the server’s certificate request message. 
                The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> accepts the certificate and completes the authenticated <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session successfully.</li>
              <li>For each alternate certificate chain (with single or multiple names), the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session from the test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client that is configured 
                to present the alternate certificate chain in a certificate message and a valid certificate verify message in response to the server’s certificate request message. 
                The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.</li>
            </ul>
              <p>
                <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the client certificate and certificate verify messages until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., access denied) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
              </p><p>
                The intent of this test is to confirm that for each method that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> uses to match name types presented in validated certificates, 
                it is able to recognize both matching and non-matching names. 
                Names of special types implicitly encoded in the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> entry of the certificate subject name are especially prone to error since they may only be validated 
                by the issuing <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> as a directory name (RDN) type, especially if the issuing <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> is unaware of the intended encoding as a different name type. 
                It is a best practice that when the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> is interpreted as an embedded name type other than RDN, an explicitly encoded <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> entry should take precedence.
              </p></li>
          </ul></span>
        </div></div></div></div></div>
        
        <div class="comp" id="FCS_DTLSS_EXT.3"><h4>FCS_DTLSS_EXT.3 DTLS Server Downgrade Protection</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_DTLSS_EXT.1.1">FCS_DTLSS_EXT.1.1</a>.
      </i></b></div>
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.3.1"><a href="#FCS_DTLSS_EXT.3.1" class="abbr">FCS_DTLSS_EXT.3.1</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall set the ServerHello extension to a random value concatenated with the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator when
              negotiating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 as indicated in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, Section 4.1.3.
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "supplemental downgrade protection" is selected in <a href="#FCS_DTLSS_EXT.1.1">FCS_DTLSS_EXT.1.1</a>. 
              </p>
              <p>
                <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 requires both the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator as well as an indicator for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 and below. This <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> requires the
                server to reject attempts to establish <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 and below, making this mechanism redundant. However, products may still
                implement both indicators to be compliant with the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr>.              
              </p>
            </span></div></div></div>
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSS_EXT.3">FCS_DTLSS_EXT.3</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and confirm that the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> description includes details on the session downgrade protections that are supported.
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall examine the operational guidance to confirm that instructions are included to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support only <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and to provide the associated downgrade indications.
                </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall follow the operational guidance as necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to negotiate only <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and to provide the associated downgrade indications. 
                The evaluator shall send a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> that indicates support for only <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2. 
                The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a ServerHello with the last eight bytes of the server random value equal to 44 4F 57 4E 47 52 44 01.
              </div></div></div></div></div>
        
        <div class="comp" id="FCS_DTLSS_EXT.4"><h4>FCS_DTLSS_EXT.4 DTLS Server Support for Renegotiation</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
      </i></b></div>
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.4.1"><a href="#FCS_DTLSS_EXT.4.1" class="abbr">FCS_DTLSS_EXT.4.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support secure <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> renegotiation through the use of [<b>selection</b>: <span class="selectable-content" id="_s_196">the "renegotiation_info" <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extension in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746</span>, <span class="selectable-content" id="_s_197">not allowing session renegotiation</span>].
            </div></div>
          <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.4.2"><a href="#FCS_DTLSS_EXT.4.2" class="abbr">FCS_DTLSS_EXT.4.2</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_198">indicate support for renegotiating a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 session by including the renegotiation_info extension in the ServerHello
                message and shall terminate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 session if neither of the renegotiation_info or TLS_EMPTY_RENEGOTIATION_INFO_SCSV
                signaling ciphersuites are indicated in the ClientHello</span></li><li style=""><span class="selectable-content" id="_s_199">not allow renegotiation</span></li></ul>].
            </div></div>
          <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.4.3"><a href="#FCS_DTLSS_EXT.4.3" class="abbr">FCS_DTLSS_EXT.4.3</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall [<b>selection</b>: <span class="selectable-content" id="_s_200">terminate the session</span>, <span class="selectable-content" id="_s_201">silently ignore the message</span>] if an unexpected ClientHello is received during an active <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session.
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "<abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a server" is selected in <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
              </p>
              <p>
                If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims either method of protecting against insecure renegotiation attempts. The
                first selection refines <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746, which defines an extension to (D)<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 that binds renegotiation handshakes to the
                cryptography in the original handshake, but allows interoperability with clients that do not follow <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746. As a
                refinement of the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr>, servers that support <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 renegotiation will terminate a session if neither of the methods
                described in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 are offered by the client. Alternatively, a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>  server supporting <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 may negotiate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2
                without any <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 client renegotiation indicators, if it always terminates an existing session when a new ClientHello is
                received or silently ignores unexpected ClientHello messages, similar to the implementation of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3.
              </p>
              <p>
                If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author must claim “does not allow renegotiation.” <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 does not allow renegotiation. 
              </p>
              <p>
                Termination of the session or silently ignoring the unexpected message, as indicated in <a href="#FCS_DTLSS_EXT.4.3">FCS_DTLSS_EXT.4.3</a>, covers <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3
                sessions as well as <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 sessions where the ClientHello received does not comply with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 or when configured to
                reject renegotiation (if the product is configurable).
              </p>
            </span></div></div></div>
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSS_EXT.4">FCS_DTLSS_EXT.4</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to confirm that the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> description includes details on session renegotiation protection methods supported, 
                  to include when renegotiation is prohibited.
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall examine the operational guidance to confirm that any instructions that are needed to meet the requirements are included. 
                  If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, and the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is configurable to use <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 methods or to deny renegotiation, 
                  the evaluator shall ensure that the operational guidance includes instructions for configuring the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> in this manner.
                </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall perform the following tests, as indicated based on supported secure renegotiation methods. The 
                conditions: ‘support for renegotiation’, ‘allowing renegotiation,’ or ‘supporting <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 methods’ imply that the
                <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2. <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 does not allow renegotiation. For each test, the evaluator shall use a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client
                able to construct the indicated messages and expose messages received from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>.
                <span class="testlist-"><ul>
                  <li class="test-"><a id="_t_121" class="defined" href="#_t_121">Test FCS_DTLSS_EXT.4:1</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 initial handshake) [conditional] 
                    If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 renegotiation, the evaluator shall follow the operational guidance as
                    necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to enforce <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 methods. 
                    The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 session from a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client for each of the following sub-tests:
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_122" class="defined" href="#_t_122">Test FCS_DTLSS_EXT.4:1.1</a>:
      The evaluator shall send an initial ClientHello without the renegotiation_info extension and without including the signaling ciphersuite value, TLS_EMPTY_RENEGOTIATION_INFO_SCSV. 
                        The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                        </p>
                      </li>
                      <li class="test-"><a id="_t_123" class="defined" href="#_t_123">Test FCS_DTLSS_EXT.4:1.2</a>:
      
                        The evaluator shall send an initial ClientHello with the renegotiation_info extension indicating a renegotiated_connection length greater than zero. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session. 
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                        </p>
                      </li>
                    </ul></span>
                  </li>
                  <li class="test-"><a id="_t_124" class="defined" href="#_t_124">Test FCS_DTLSS_EXT.4:2</a>:
      
                    (renegotiation attempt) For each of the following sub-tests, the evaluator shall establish a compliant <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel with an initial handshake that uses the indicated secure renegotiation method for the version indicated. 
                    Without closing the session, the evaluator shall send a second ClientHello within the channel specific to the version as indicated:
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_125" class="defined" href="#_t_125">Test FCS_DTLSS_EXT.4:2.1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> allows renegotiation, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 methods, 
                        send an initial handshake with a valid renegotiation extension, 
                        send a new <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ClientHello on the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 channel containing the renegotiation_info extension indicating valid client_verify_data, and observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully completes the handshake.</li>
                      <li class="test-"><a id="_t_126" class="defined" href="#_t_126">Test FCS_DTLSS_EXT.4:2.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> allows renegotiation, the evaluator shall send an initial ClientHello containing a valid renegotiation extension, 
                        send a new <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ClientHello on the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 channel with the signaling ciphersuite value, TLS_ EMPTY_RENEGOTIATION_INFO_SCSV, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                        </p>
                      </li>
                      <li class="test-"><a id="_t_127" class="defined" href="#_t_127">Test FCS_DTLSS_EXT.4:2.3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> allows renegotiation, for each <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 renegotiation method claimed in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746, 
                        the evaluator shall send an initial ClientHello indicating the method, send a new <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ClientHello on the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 channel
                        without a renegotiation_info extension, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                        </p>
                      </li>
                      <li class="test-"><a id="_t_128" class="defined" href="#_t_128">Test FCS_DTLSS_EXT.4:2.4</a>:
      [conditional]: If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> allows renegotiation, for each <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 renegotiation method claimed in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746, 
                        the evaluator shall send an initial ClientHello indicating the method, 
                        send a new <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 ClientHello on the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 channel with a renegotiation_info extension indicating an invalid 
                        client_verify_data value (modify a byte of a valid value), and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or 
                        terminates the session.
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                        </p></li>
                      <li class="test-"><a id="_t_129" class="defined" href="#_t_129">Test FCS_DTLSS_EXT.4:2.5</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, or if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects renegotiation for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, then for each such version, 
                        the evaluator shall follow the operational guidance as necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to negotiate the version and reject renegotiation. 
                        The evaluator shall initiate a valid initial session for the specified version, send a valid ClientHello on the non-renegotiable <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message or terminates the session.
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert).
                        </p></li>
                    </ul></span>
                  </li>
                </ul></span>
              </div></div></div></div></div>
        
        
        <div class="comp" id="FCS_DTLSS_EXT.5"><h4>FCS_DTLSS_EXT.5 DTLS Server Support for Session Resumption</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_DTLSS_EXT.1.1">FCS_DTLSS_EXT.1.1</a>.
      </i></b></div>
           
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.5.1"><a href="#FCS_DTLSS_EXT.5.1" class="abbr">FCS_DTLSS_EXT.5.1</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support session resumption as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server via the use of [<b>selection</b>: <span class="selectable-content" id="_s_202">session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246</span>, <span class="selectable-content" id="_s_203">tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077</span>, <span class="selectable-content" id="dtlss_v13_resumption">PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span>]. 
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "session resumption" is selected in <a href="#FCS_DTLSS_EXT.1.1">FCS_DTLSS_EXT.1.1</a>.
              </p>
              <p>
                The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates which session resumption mechanisms are supported. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 is supported, one or both of the first
                two options, "session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246" and "tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077" are claimed. If <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is
                supported, "PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446" is selected, and the selection-based <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> <a href="#FCS_DTLSS_EXT.6">FCS_DTLSS_EXT.6</a> must also
                be claimed.
              </p>
              <p>
                While it is possible to perform session resumption using PSK ciphersuites in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, this is uncommon. Validation of key
                exchange and session negotiation rules for PSK ciphersuites is independent of the source of the pre-shared key and is covered
                in <a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a>.
              </p>
            </span></div></div></div>
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSS_EXT.5">FCS_DTLSS_EXT.5</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and confirm that the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server protocol description includes a description of the supported resumption mechanisms.
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall ensure the operational guidance describes instructions for any configurable features of the resumption mechanism.
                </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall perform the following tests:
                <span class="testlist-"><ul>
                  <li class="test-"><a id="dtls-server-successful-resumption" class="defined" href="#dtls-server-successful-resumption">Test FCS_DTLSS_EXT.5:1</a>:
      For each supported version, and for each supported resumption method for that version, 
                    the evaluator shall establish a compliant initial <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session with the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> for the version using the specified method. 
                    The evaluator shall close the successful session and initiate resumption using the specified mechanism. 
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully establishes the resumed session in accordance with the requirements. </li>
                  <li class="test-"><a id="_t_131" class="defined" href="#_t_131">Test FCS_DTLSS_EXT.5:2</a>:
      For each supported version and each supported resumption method for that version, 
                    the evaluator shall send a compliant ClientHello message supporting only the specific version and indicating support for the resumption method. 
                    The evaluator shall allow the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and test client to continue with the compliant handshake until resumption information is established but then cause a fatal error to terminate the session. 
                    The evaluator shall then send a new ClientHello in an attempt to resume the session with the resumption information provided 
                    and verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not resume the session, but instead silently drops the message, terminates the session, or completes a full handshake, ignoring the resumption information.
                    <p>
                      <b>Note:</b> For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2, resumption information should be established at the point the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a ServerHello, either acknowledging the session-based resumption 
                      or acknowledging support for ticket-based resumption and sending a new_ticket message. 
                      A <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 session can then be terminated by sending a modified finished message. 
                      For <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, the new_ticket message is sent after the finished message; once received by the client, the session can be terminated by modifying a byte of the encrypted application data. 
                    </p>
                    <p>
                      To terminate the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session, it might be necessary to continue sending the invalid finished or application message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session or responds with a full handshake ignoring the resumption information, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the ClientHello containing the resumption information of the failed session, the evaluator shall continue sending the message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out.
                    </p>
                  </li>
                </ul></span>
              </div></div></div></div></div>
        
        
        <div class="comp" id="FCS_DTLSS_EXT.6"><h4>FCS_DTLSS_EXT.6 DTLS Server DTLS 1.3 Resumption Refinements</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_DTLSS_EXT.5.1">FCS_DTLSS_EXT.5.1</a>.
      </i></b></div>
           
          
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.6.1"><a href="#FCS_DTLSS_EXT.6.1" class="abbr">FCS_DTLSS_EXT.6.1</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 resumption using PSK with psk_key_exchange_modes extension with the value psk_dhe_ke.  
            </div></div>
          <div class="element"><div class="reqid" id="FCS_DTLSS_EXT.6.2"><a href="#FCS_DTLSS_EXT.6.2" class="abbr">FCS_DTLSS_EXT.6.2</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall ignore early data received in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 sessions.
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 is supported and "PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446" is selected in <a href="#FCS_DTLSS_EXT.5.1">FCS_DTLSS_EXT.5.1</a>.
              </p>
              <p>
                <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 allows pre-shared keys to be used directly and also allows early data to be protected using only the pre-shared key.
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> refines the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> to use PSK only with a supplemental <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> key exchange to ensure perfect forward secrecy for
                all sessions.
              </p>
            </span></div></div></div>  
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_DTLSS_EXT.6">FCS_DTLSS_EXT.6</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to confirm that the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> description includes details on session resumption for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, 
                  describes each application capable of using <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 with PSK, and describes how the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and application respond to client attempts to use early data (including via logging or observable responses). 
                  The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> description shows that only the psk_dhe_ke psk_key_exchange_modes is supported and that early information is ignored. 
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                  The evaluator shall examine the operational guidance to verify that instructions for any configurable features that are required to meet the requirement are included. 
                </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to negotiate <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and shall perform the following tests:
                <span class="testlist-"><ul>
                  
                  
                  <li class="test-"><a id="_t_132" class="defined" href="#_t_132">Test FCS_DTLSS_EXT.6:1</a>:
      The evaluator shall attempt a resumed session (see <a href="#FCS_DTLSS_EXT.5">FCS_DTLSS_EXT.5</a> <a href="#dtls-server-successful-resumption" class="dynref">Test FCS_DTLSS_EXT.5:1</a>) but using psk_ke mode as the value for the psk_key_exchange_modes extension in the resumption ClientHello. 
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> refuses to resume the session, by silently dropping the message, by completing a full <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 handshake, or by terminating the session.
                    <p>
                      <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session or completes a full <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 handshake, the test is successful. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the message, the evaluator shall continue sending the ClientHello message until the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> times out. It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> logs a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without logging a fatal error alert). 
                    </p>
                  </li>
                  
                  <li class="test-"><a id="_t_133" class="defined" href="#_t_133">Test FCS_DTLSS_EXT.6:2</a>:
      
                    
                    The evaluator shall establish a valid <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 session with the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and send the data as application data after the finished messages have been verified, 
                    and observe the response. The evaluator shall then configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to clear the response and initiate a resumed session
                    (see <a href="#FCS_DTLSS_EXT.5">FCS_DTLSS_EXT.5</a> <a href="#dtls-server-successful-resumption" class="dynref">Test FCS_DTLSS_EXT.5:1</a>) with a test <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 client attempting to provide
                    the same data in early data. 
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not react to the early data as it did when presented as application data 
                    after the finished messages, indicating that the data was ignored.
                    <p>
                      <b>Note:</b> The specific early data used may depend on the applications calling the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session and should be selected to initiate an observable response in the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> or calling application as described in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>. 
                      For HTTPS, for example, the early data can be an <abbr class="dyn-abbr"><a href="#abbr_HTTP">HTTP</a></abbr> POST that updates data at the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>, which can then be observed via a user interface for the application if the data was 
                      posted or via application logging indicating that the operation failed.
                    </p>
                  </li>
                </ul></span>
              </div></div></div></div></div>   


   

        <div class="comp" id="FCS_TLSC_EXT.1"><h4>FCS_TLSC_EXT.1 TLS Client Protocol</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
      </i></b></div>
		  
          
          
          
          
          
           
          
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.1.1"><a href="#FCS_TLSC_EXT.1.1" class="abbr">FCS_TLSC_EXT.1.1</a></div><div class="reqdesc"> The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement
              [<b>selection</b>: <span class="selectable-content" id="_s_205"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246)</span>, <span class="selectable-content" id="_s_206"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span>] as a client that supports additional functionality for session renegotiation protection and
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="tlsc_mutual_auth">mutual authentication</span></li><li style=""><span class="selectable-content" id="tlsc_downgrade_protection">supplemental downgrade protection</span></li><li style=""><span class="selectable-content" id="tlsc_resumption">session resumption</span></li><li style=""><span class="selectable-content" id="_s_210">no optional functionality</span></li></ul>]
              and shall abort attempts by a server to negotiate all other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> or SSL versions. 
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a client" is selected in <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
              </p><p>
              Session renegotiation protection is required for both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, and the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the requirements from
              <a href="#FCS_TLSC_EXT.4">FCS_TLSC_EXT.4</a>. Within <a href="#FCS_TLSC_EXT.4">FCS_TLSC_EXT.4</a>, options for implementation of secure session renegotiation for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, or rejecting
              renegotiation requests are claimed.  
              </p><p>
              The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author will claim supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> versions and optional functionality as appropriate for the claimed versions. 
              </p><p>
                If "mutual authentication" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include the requirements from <a href="#FCS_TLSC_EXT.2">FCS_TLSC_EXT.2</a>. 
                If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> with mutual authentication, this selection must be made.
              </p><p>
                If "supplemental downgrade protection" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include the requirements from <a href="#FCS_TLSC_EXT.3">FCS_TLSC_EXT.3</a>.
                This is claimed when both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 are supported. Note that <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade protection in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> is used
                to notify a client that the server is capable of supporting <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 or <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3, when it negotiates a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 session
                because it received a ClientHello indicating maximum support for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1. Since this <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> does not allow negotiation of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>
                1.1 or below, it is not necessary to claim such support.
              </p><p>
                If "session resumption" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include the requirements from <a href="#FCS_TLSC_EXT.5">FCS_TLSC_EXT.5</a>. 
              </p>
            </span></div></div></div>
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.1.2"><a href="#FCS_TLSC_EXT.1.2" class="abbr">FCS_TLSC_EXT.1.2</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following
          [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_211"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites:
          [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_212">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8422</span></li><li style=""><span class="selectable-content" id="_s_213">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8422</span></li><li style=""><span class="selectable-content" id="_s_214">TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5288</span></li><li style=""><span class="selectable-content" id="_s_215">TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5288</span></li><li style=""><span class="selectable-content" id="_s_216">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289</span></li><li style=""><span class="selectable-content" id="_s_217">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289</span></li><li style=""><span class="selectable-content" id="_s_218">ciphersuites using pre-shared secrets:
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_219">TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442</span></li><li style=""><span class="selectable-content" id="_s_220">TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487</span></li><li style=""><span class="selectable-content" id="_s_221">TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487</span></li></ul>]</span></li></ul>]
              and shall not offer other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites,</span></li><li style=""><span class="selectable-content" id="_s_222"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites: [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_223">TLS_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span></li><li style=""><span class="selectable-content" id="_s_224">[<b>assignment</b>: 
     <span class="assignable-content">other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites</span>]</span></li></ul>]</span></li></ul>]
              offering the supported ciphersuites in a ClientHello message in preference order: 
              [<b>assignment</b>: 
     <span class="assignable-content">list of supported ciphersuites</span>].
          <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
              The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author should select the ciphersuites that are supported, and must select at least one ciphersuite for each <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> version
              supported. Pre-shared secret ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 are only claimed as required by a specific <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>. The ciphersuites to be
              tested in the evaluated configuration are limited by this requirement. However, this requirement does not restrict the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>'s
              ability to propose additional non-deprecated ciphersuites beyond the ones listed in this requirement in its ClientHello
              message as indicated in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>. That is, the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> may propose any ciphersuite not excluded by this element, but the evaluation
              will only test ciphersuites from the above list. It is necessary to limit the ciphersuites that can be used administratively in
              an evaluated configuration on the server in the test environment. 
              </p>
              <p>
              <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites are claimed if support for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is claimed in <a href="#FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</a>. 
              The assignment of preference order provides an ordered list of all supported ciphersuites with the most preferred ciphersuites
              listed first. 
              </p>
              <p>
              While mandatory for <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, TLS_AES_128_GCM_SHA256 is deprecated by this <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> and should not be included in “other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3
              ciphersuites.” The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author may list additional <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites as they are registered.
              </p>
              <p>
              In addition to the supported ciphersuites, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates the order of ciphersuites included in the ClientHello,
              indicating the preferred ciphersuites for server negotiation.  To eliminate the need to produce duplicate lists, it is recommended to complete the selected list of ciphersuites in the order that they are presented and then complete the following assignment by saying that the presentation order is the same as in the previous list. It is recommended, but not required, that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites
              claimed are listed before <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites, and that any other ciphersuites are listed last among the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites.
              </p>
            </span></div></div></div>
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.1.3"><a href="#FCS_TLSC_EXT.1.3" class="abbr">FCS_TLSC_EXT.1.3</a></div><div class="reqdesc">
            The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not offer ClientHello messages indicating the following: 
            <ul>
              <li>null encryption</li>
              <li>support for anonymous servers</li>
              <li>use of deprecated or export-grade cryptography including DES, 3DES, RC2, RC4, or IDEA for encryption</li>
              <li>use of MD-5 or <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr>-1 for key derivation</li>
            </ul> and shall abort sessions where a server attempts to negotiate ciphersuites not enumerated in the ClientHello message.
          <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This element explicitly excludes ciphersuites defined for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and previous <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> or SSL versions that might be included in the 
                ClientHello from a <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> that supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 (as the only supported version, or as a fallback version for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 clients 
                negotiating with potential <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 servers). The requirement also constrains the choice of "other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites" when
                <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported. In addition, this requirement prohibits Using Raw Public Keys in Transport Layer Security and Datagram
                Transport Layer Security (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7250) for server certificates.
              </p>
              <p>
                Ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 are of the form TLS_(key exchange algorithm)_WITH_(encryption algorithm)_(message digest algorithm), and
                are listed in the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters section of the internet assignments at iana.org. This requirement constrains the value of 
                (encryption algorithm) and (message digest algorithm).
              </p>
              <p>
                Ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 are of the form TLS_(AEAD)_(HASH), where (AEAD) is of the form (encryption algorithm)_(symmetric key 
                length)_(mode) for an authenticated encryption with associated data specification (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5116). This requirement constrains the 
                value of the (encryption algorithm) component of (AEAD) and the value of (HASH). 
              </p> 
            </span></div></div></div>
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.1.4"><a href="#FCS_TLSC_EXT.1.4" class="abbr">FCS_TLSC_EXT.1.4</a></div><div class="reqdesc">
           The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ClientHello message extensions: 
           <ul>
             <li>signature_algorithms extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for 
               [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_225">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_226">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_227">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_228">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_229">no other signature algorithms</span></li></ul>]
               and
             </li>
           </ul>
               [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_230">signature_algorithms_cert extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_231">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_232">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_233">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_234">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_235">no other signature algorithms</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_236">supported_versions extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 and [<b>selection</b>: <span class="selectable-content" id="_s_237"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2</span>, <span class="selectable-content" id="_s_238">no other versions</span>]</span></li><li style=""><span class="selectable-content" id="_s_239">supported_groups extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7919, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_240">secp384r1</span></li><li style=""><span class="selectable-content" id="_s_241">secp521r1</span></li><li style=""><span class="selectable-content" id="_s_242">ffdhe3072(257)</span></li><li style=""><span class="selectable-content" id="_s_243">ffdhe4096(258)</span></li><li style=""><span class="selectable-content" id="_s_244">ffdhe6144(259)</span></li><li style=""><span class="selectable-content" id="_s_245">ffdhe8192(260)</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_246">key_share extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_247">post_handshake_auth (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446), pre_shared_key (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446), and psk_key_exchange_modes (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating psk_dhe_ke
                   (<abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr>) mode</span></li><li style=""><span class="selectable-content" id="_s_248">extended_master_secret extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7627) enforcing server support, and
                   [<b>selection</b>: <span class="selectable-content" id="_s_249">allowing legacy servers</span>, <span class="selectable-content" id="_s_250">no other enforcement mode</span>]</span></li><li style=""><span class="selectable-content" id="_s_251">no other extensions</span></li></ul>]
               and shall not send the following extensions: <ul>
                 <li>early_data</li>
                 <li>psk_key_exchange_modes indicating PSK only mode.</li>
               </ul>
         <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
           <p>
             Support for the signature_algorithms extension is optional in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246 but is mandated for this functional package. Support for the signature_algorithms extension is mandatory in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 and remains so in this functional package. Whether the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>'s implementation conforms to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, or both is dependent on whether the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, or both.
           </p>
           <p>
           If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is claimed in <a href="#FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</a>, supported_versions, supported_groups, and key_share extensions are claimed in
           accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446. If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is not claimed, supported_versions and key_share extensions are not claimed. 
           </p><p>
           If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is
           claimed, extended_master_secret extension is claimed, with the ability to enforce server support, and optionally, the ability to
           support legacy servers.
           </p>
           <p>
             If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is claimed and if <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites are claimed in <a href="#FCS_TLSC_EXT.1.2">FCS_TLSC_EXT.1.2</a>, the supported_groups extension is claimed here with appropriate secp or ffdhe groups claimed.
           </p>
           <p>
             Other extensions may be supported; certain extensions and values may need to be claimed for <abbr class="dyn-abbr"><a href="#abbr_SFR">SFRs</a></abbr> defined outside of this package related to the calling applications.
           </p>
         
         </span></div></div></div>
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.1.5"><a href="#FCS_TLSC_EXT.1.5" class="abbr">FCS_TLSC_EXT.1.5</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_257">verify that a presented identifier of name type: [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_258">dNSName according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span></li><li style=""><span class="selectable-content" id="_s_259">uniformResourceIdentifier according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span></li><li style=""><span class="selectable-content" id="_s_260">SRVname according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span></li><li style=""><span class="selectable-content" id="_s_261">Common Name conversion to dNSName according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span></li><li style=""><span class="selectable-content" id="_s_262">directoryName according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280</span></li><li style=""><span class="selectable-content" id="_s_263">iPAddress according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280</span></li><li style=""><span class="selectable-content" id="_s_264">rfc822Name according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280</span></li><li style=""><span class="selectable-content" id="_s_265">[<b>assignment</b>: 
     <span class="assignable-content">other name type</span>] according to [<b>assignment</b>: 
     <span class="assignable-content"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> number</span>]</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_266">interface with a supported function requesting the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel to pass 
                  [<b>selection</b>: <span class="selectable-content" id="_s_267">the validated certification path</span>, <span class="selectable-content" id="_s_268">names of [<b>assignment</b>: 
     <span class="assignable-content">specified types</span>] extracted from the leaf certificate of a validated certification path</span>, <span class="selectable-content" id="_s_269">normalized representations of names of [<b>assignment</b>: 
     <span class="assignable-content">specified types</span>] extracted from the leaf certificate of a validated certification path</span>] for verification that a presented identifier</span></li><li style=""><span class="selectable-content" id="_s_270">pass initial name constraints to the certification path processing function to verify, in accordance with 
                  <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>, that the presented identifier</span></li><li style=""><span class="selectable-content" id="_s_271">associate a PSK with a valid server with an identifier that</span></li></ul>] 
              matches a reference identifier for the requested <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server and shall abort the session if no match is found.
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims the supported options for verifying that the server is associated with an expected reference identifier. The first option is claimed if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> implements name matching. The option “interface with a supported function…” is claimed if the validated certification path, names extracted from the subject field and/or subject alternate name extension of a leaf certificate of a validated certification path, or normalized representations of names extracted from the leaf certificate are passed to a supported function for matching. The option “pass initial name constraints…” is claimed if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> formulates initial name constraints from the reference identifiers used by the certification path processing function. The final option is claimed if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and PSK ciphersuites are supported, and is used to associate the shared PSK with a known identifier.
              </p>
              <br/><br/>
              <p>
                If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> matches names, the rules for verification of identity are described in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125, Section 6 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280, Section 7. If "Common name conversion..."
              is claimed, both the subject field and the converted common name are matched.
              The reference identifier is established by the user (e.g., entering a <abbr class="dyn-abbr"><a href="#abbr_URL">URL</a></abbr> into a web browser or clicking a link), 
              by configuration (e.g., configuring the name of a mail or authentication server), 
              or by an application (e.g., a parameter of an API) depending on the supported function. 
              The client establishes all acceptable reference identifiers for matching against the presented identifiers as validated in the
              server’s certificate. 
              If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> performs matching of the reference identifiers to the identifiers provided in the server’s certificate, 
              the first option is claimed and all supported name types are claimed. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> presents the certificate 
              or the presented identifiers from the certificate to the supported function, the second option is claimed.
              If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> constructs initial name constraints derived from the reference identifiers for validation during certification path
              validation, the third option is claimed.
              </p>
              <p>
              In most cases where <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> servers are represented by <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>-type names, 
              the preferred method for verification is the Subject Alternative Name using <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or Service Names. 
              Verification using a conversion of the Common Name relative distinguished name from a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name type in the subject field is allowed for the purposes of backward compatibility. 
              </p>
              <p>
              The client should avoid constructing reference identifiers using wildcards. However, if the presented identifiers include wildcards, 
              the client must follow the best practices regarding matching; these best practices are captured in the evaluation activity. 
              If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports wildcards, and allows names with <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portions containing internationalized names, 
              the internationalized name should not match any wildcard, in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125 section 7.2.
              </p><p>  
              Support for other name types is rare, but may be claimed for specific applications. 
              If specified, the assignment includes both the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> describing normalization and matching rules, 
              and any refinements necessary to resolve options available in the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr>.
              </p>  
            </span></div></div></div>
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.1.6"><a href="#FCS_TLSC_EXT.1.6" class="abbr">FCS_TLSC_EXT.1.6</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a trusted channel if 
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_279">the server certificate is invalid [<b>selection</b>: <span class="selectable-content" id="s-tlsc-no-excep">with no <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>-specific exceptions</span>, <span class="selectable-content" id="_s_281">except when override is authorized in accordance with [<b>assignment</b>: 
     <span class="assignable-content">override rules</span>] in the case where valid revocation information is not available</span>]
              </span></li><li style=""><span class="selectable-content" id="_s_282">a PSK associated with the server is invalid</span></li></ul>]. 
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                The option “the server certificate…” is claimed if certificate-based server authentication is performed (if non-PSK ciphersuites are supported in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, or if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is claimed). Within this selection, the option “except when…” is claimed if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> specific exception rules are implemented to allow server certificates with no
                valid revocation status information to be accepted. This is claimed only when <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a>.2 includes the option
                “supported function determines acceptance via…”. The assignment for when override is authorized describes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>-specific processing to include the privileged users authorized to configure an override, and the duration of an override. It is preferred that overrides are minimized in scope and time.
                Otherwise, “with no <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>-specific exceptions” is claimed.
              </p>
              <p>
                The option “a PSK associated with the server is invalid” is claimed if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and PSK ciphersuites are supported, or <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported and if PSK handshakes are supported.
              </p>
              <p>
              Note that <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> may allow methods other than CRL or OCSP to validate the revocation status of a certificate. A
              certificate that exclusively uses these alternate methods may not advertise revocation status information locations. 
              Thus, a certificate that is valid according to <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> and does not advertise revocation status information in a CRL_DP
              or AIA extension is considered to be not revoked. <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>-specific override mechanisms are for use with certificates with published
              revocation status information that is not accessible, whether temporarily or because the information cannot be accessed during
              the state of the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> (e.g., for verifying signatures on boot code). The circumstances should be described by the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author, who
              should indicate the override mechanism and conditions that apply to the override, including system state, user or admin actions, etc. 
              </p>
            </span></div></div></div> 
	    
	    
	    
	 
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                The evaluator shall check the description of the implementation of this protocol in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure the supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> versions, features, ciphersuites, and extensions 
                are specified in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246 (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2) and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 and updates to <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2) and as refined in <a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a> as appropriate. 
                </p>
                <p>
                The evaluator shall verify that ciphersuites indicated in <a href="#FCS_TLSC_EXT.1.2">FCS_TLSC_EXT.1.2</a> are included in the description, and that none of the following ciphersuites are supported: ciphersuites indicating 
                NULL, RC2, RC4, DES, IDEA, TDES, or <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>-128 in the encryption algorithm component, indicating 'anon,' or indicating MD5 or <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr> in the message digest algorithm component.
                </p>
                <p>
                The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> implementation description includes the extensions as required in <a href="#FCS_TLSC_EXT.1.4">FCS_TLSC_EXT.1.4</a>.
                </p>
                <p>
                The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes applications that use the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> functions and how they establish reference identifiers.
                </p>
                <p>
                If name matching is supported, the evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> includes a description of matching methods used for each supported name type to 
                the supported application defined reference identifiers. 
                The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> includes a description 
                of wildcards recognized for each name type claimed in <a href="#FCS_TLSC_EXT.1.5">FCS_TLSC_EXT.1.5</a>, if any, and shall verify that the matching rules meet or exceed best practices. 
                In particular, the evaluator shall ensure that the matching rules are as restrictive as, or more restrictive than the following: 
                <ul>
                <li><abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> names: The ‘*’ character used in the complete leftmost label of a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name represents any valid name that has the same number of labels, 
                  and that matches all remaining labels. The ‘*’ character must only be used in the leftmost complete label of a properly formatted <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name. 
                  The ‘*’ must not be used to represent a public suffix, or in the leftmost label immediately following a public suffix. </li>
                <li><abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr> or SRV names: The ‘*’ character can only occur in the domain name portion of the name represented as a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name. 
                  All restrictions for wildcards in <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> names apply to the <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion of the name.
                <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr> host names presented as an <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address are matched according to <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address matching rules – see best practices for <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses below. 
                In accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125, it is preferred that such URIs are presented a matching name of type <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address in the <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr>. </li>
                <li><abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses: <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280 does not support <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address ranges as presented names, 
                  but indicates that presented names may be compared to <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address ranges present in name constraints. 
                  If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address ranges as reference identifiers, the reference identifier matches if the presented name is in the range. 
                  <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> ranges in name constraints (including reference identifiers) should be presented in CIDR format. </li>
                <li><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822 names: <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280 and updates <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8398 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8399 do not support special indicators representing 
                  more than a single mailbox as a presented name, but indicates that presented names may be compared to a single mailbox, 
                  ‘any’ email address at a host, or ‘any’ email address on a domain 
                  (e.g., “example.com” matches any email address on the host example.com and “.example.com” matches any email address in the domain example.com, 
                  but does not match email addresses at the host “example.com”). Such matching is prohibited for internationalized <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822 names.</li>
                  <li>Embedded <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> name types: The <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> relative distinguished name of a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name type included in the subject field is not strongly typed. Attempts to match both the name type and wildcard specifications can result in matches not intended, and therefore, not authoritatively asserted by a certification authority. It is preferred that no matching of <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> embedded names be supported, but if necessary for backward compatibility, the description should clearly indicate how different name types are interpreted in the matching algorithm. If an embedded <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> is present, the <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr> structure containing the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> as an RDN is matched, and the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> component is further matched according to the specific rules for the implied name type. In particular, the ‘*’ character in a <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> is not to be interpreted as representing more than a single entity unless the entirety of the RDN is properly formatted as a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or SVR name, and represents a wildcard meeting best practices as described above.</li>
                </ul>
                </p>
                <p>
                  If name types are passed to the supported functions, the evaluator shall verify that for each claimed supported function, the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> includes a description of the information used to validate the identifier that is passed to that function.
                </p>
                <p>
                  If override rules are claimed in <a href="#FCS_TLSC_EXT.1.6">FCS_TLSC_EXT.1.6</a>, the evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> identifies the subjects authorized to configure the override as well as the scope or duration of any overrides.
                </p>
                <p>
                  If name constraints are passed to the certificate verification function, the evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes
                  the initial allow and deny tables for each reference identity reference name supported.
                </p>
	      </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                The evaluator shall check the operational guidance to ensure that it contains instructions on configuring the product so that <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> conforms to the description in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and that 
                it includes any instructions on configuring the version, ciphersuites, or optional extensions that are supported.
                </p><p>
                The evaluator shall verify that all configurable features for matching identifiers in certificates presented in the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake to application specific reference identifiers are described.
                </p>
                <p>
                  If override rules are claimed in <a href="#FCS_TLSC_EXT.1.6">FCS_TLSC_EXT.1.6</a>, the evaluator shall verify the operational guidance has instructions for applying them.
                </p>
	      </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
		The evaluator shall perform the following tests:
              <span class="testlist-"><ul>
                
                <li class="test-"><a id="tls-client-supported-configurations" class="defined" href="#tls-client-supported-configurations">Test FCS_TLSC_EXT.1:1</a>:
      (supported configurations) For each supported version, and for each supported ciphersuite associated with the version:
                  <p>
                  The evaluator shall establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> connection between the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server that is configured to negotiate the tested version and ciphersuite in accordance with the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> for the version.
                  </p><p>
                  The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> presents a ClientHello indicating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 (value '03 03') in the highest or legacy version field and, if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, the supported versions extension is present and contains the value '03 04' for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3.
                  </p><p>
                  The evaluator shall observe that the ClientHello indicates the supported ciphersuites in the order indicated, 
                  and that it includes only the extensions supported, with appropriate values, for that version in accordance with the requirement.
                  </p><p>
                  The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> successfully completes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake.
                  </p><p>
                    <b>Note:</b> The highest version field is renamed to the legacy version field for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3. Regardless of the versions supported, this field is required to indicate <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2. If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the ClientHello should indicate all ciphersuites and all extensions as required for either version. In particular, the supported versions extension is required and must include the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 value ('03 04') and may also include the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 indicator ('03 03').
                  </p>
                  <p>
                    If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is configurable to support only <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, only <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, or both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, <a href="#tls-client-supported-configurations" class="dynref">Test FCS_TLSC_EXT.1:1</a> should be performed in each configuration, with ciphersuites and extensions appropriate for the configured version.
                  </p><p>
                  The connection in <a href="#tls-client-supported-configurations" class="dynref">Test FCS_TLSC_EXT.1:1</a> may be established as part of the establishment of a higher-level protocol, 
                  e.g., as part of an <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> session. 
                  </p><p>
                  It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; 
                  it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used 
                  (for example, that the cryptographic algorithm is 128-bit <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr> and not 256-bit <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>).
                  </p>
                </li>
                
                
                <li class="test-"><a id="_t_135" class="defined" href="#_t_135">Test FCS_TLSC_EXT.1:2</a>:
      (obsolete versions) The evaluator shall perform the following tests:
                
                <span class="testlist-"><ul>
                  
                    <li class="test-"><a id="tls-client-obsolete-versions" class="defined" href="#tls-client-obsolete-versions">Test FCS_TLSC_EXT.1:2.1</a>:
      For each of SSL version 2, SSL version 3, <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.0, <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1, and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>
                      1.2 if it is not supported, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> connection from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> 
                    to a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server that is configured to negotiate the obsolete version and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection.
                      <p>
                    <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., protocol version, insufficient security) in response to this, 
                    but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                      </p>
                    </li>
                  
                  <li class="test-"><a id="tls-client-nonstandard-versions" class="defined" href="#tls-client-nonstandard-versions">Test FCS_TLSC_EXT.1:2.2</a>:
      
                    The evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to
                  ensure any supported beta <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 versions are disabled, as necessary. The evaluator
                    shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a ClientHello message indicating the supported version (referred to
                    as the legacy version in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) with the value '03 04' but without including the
                    supported_versions extension and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> either
                    responds with a ServerHello indicating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 or terminates the connection.
                    <p>
                    <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., protocol version) in response to this, 
                    but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                    </p><p>
                      <a href="#tls-client-nonstandard-versions" class="dynref">Test FCS_TLSC_EXT.1:2.2</a> is intended to test the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> response to non-standard versions, higher than indicated in the ClientHello's "highest version/legacy version" supported, including early proposals for 'beta <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3' versions. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports such beta versions, the
                      evaluator shall follow the operational guidance instructions to disable them prior to
                      conducting <a href="#tls-client-nonstandard-versions" class="dynref">Test FCS_TLSC_EXT.1:2.2</a>.
                    </p>
                  </li>
                </ul></span>
                </li>
                
                
                <li class="test-"><a id="_t_138" class="defined" href="#_t_138">Test FCS_TLSC_EXT.1:3</a>:
      
                  (ciphersuites)  The evaluator shall perform the following tests on handling unexpected ciphersuites using a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server 
                  sending handshake messages compliant with the negotiated version except as indicated in the test: 
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_139" class="defined" href="#_t_139">Test FCS_TLSC_EXT.1:3.1</a>:
      (supported ciphersuite not offered) For each supported version, the evaluator shall attempt to establish a connection with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server configured to negotiate the supported version and a ciphersuite 
                      not included in the ClientHello and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                    <p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                    </p><p>
                      This test is intended to test the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s generic ability to recognize non-offered ciphersuites. 
                      If the ciphersuites in the ClientHello are configurable, 
                      the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> not to offer a supported ciphersuite and then use that ciphersuite in the test. 
                      If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> ciphersuite list is not configurable, it is acceptable to use a named ciphersuite from the IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> protocols associated with the tested version. 
                      Additional special cases of this test for special ciphersuites are performed separately.
                    </p></li>
                    <li class="test-"><a id="tls-client-version-confusion" class="defined" href="#tls-client-version-confusion">Test FCS_TLSC_EXT.1:3.2</a>:
      (version confusion) For each supported version, 
                      the evaluator shall attempt to establish a connection with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server that is configured to negotiate the supported version 
                      and a ciphersuite that is not associated with that version and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                      <p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                      </p><p>
                      If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, the evaluator shall use <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites for a server negotiating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2. If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, the test server negotiating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 should select a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite consistent with the client's supported groups and signature algorithm indicated by extensions in the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ClientHello. 
                      </p><p>
                      If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is configurable to allow both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 servers, the evaluator should use this configuration for the test, and configure the test server to use ciphersuites offered by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> in its ClientHello message.
                    </p></li>
                    <li class="test-"><a id="_t_141" class="defined" href="#_t_141">Test FCS_TLSC_EXT.1:3.3</a>:
      (null ciphersuite) For each supported version, the evaluator shall attempt to establish a connection with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server 
                      configured to negotiate the null ciphersuite (TLS_NULL_WITH_NULL_NULL) and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection. 
                      <p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                        </p></li>
                    
                    
                    <li class="test-"><a id="_t_142" class="defined" href="#_t_142">Test FCS_TLSC_EXT.1:3.4</a>:
      The evaluator shall perform one or more of the following tests to demonstrate the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> does not connect with anonymous servers:
                      <p>
                        [conditional] (anon ciphersuite) If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, the evaluator shall attempt to establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 connection with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server configured to negotiate a ciphersuite using the anonymous server authentication method 
                      and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                      </p>
                      <p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                      </p>
                    <p>
                    See IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters for available ciphersuites to be selected by the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server. 
                    The test ciphersuite should use supported cryptographic algorithms for as many of the other components as possible. 
                    For example, if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> only supports the ciphersuite TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test server could select TLS_DH_ANON_WITH_AES_256_GCM_SHA_384.
                    </p>
                    <p>
                      [conditional] (anon ciphersuite) If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the evaluator shall attempt to establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 connection with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server
                      configured to assert a ‘raw public key’ in the server_certificate_type as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7250, and to send its certificate message including the raw public key indicator
                      for the public key information field (regardless of the client's support for this extension). The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not send the server_certificate_type
                      extension indicating support for raw public keys in its ClientHello message and terminates the session when receiving the
                      server’s certificate message.
                    </p><p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., bad_certificate, unsupported_certificate) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                    </p><p>
                      It is acceptable for the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support the extensions defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7250. If so, it must not include the value indicating support for raw public keys in the server_certificate_type extension.
                    </p>
                    </li>
                    <li class="test-"><a id="tls-client-deprecated-encryption" class="defined" href="#tls-client-deprecated-encryption">Test FCS_TLSC_EXT.1:3.5</a>:
      
                      <p>
                        The evaluator shall perform one or more of the following tests to demonstrate that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> does not accept connections using deprecated ciphersuites:
                      </p>
                      <p>
                        [conditional] (deprecated encryption algorithm) If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ClientHello that is compliant with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9151, except that for each 
                        deprecated encryption algorithm (NULL, RC2, RC4, DES, IDEA, TDES, and <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>-128), the evaluator shall attempt to establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 connection with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>
                        server configured to negotiate a ciphersuite using the deprecated encryption algorithm and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                      </p><p>
                        [conditional] (deprecated encryption algorithm) If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, for each <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuite registered in IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters using <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>-128 as the encryption algorithm, the evaluator shall attempt to establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 connection with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server configured to negotiate a ciphersuite using the deprecated encryption algorithm and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.   
                      </p><p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                      </p><p>
                      See IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters for available ciphersuites to be tested. The test ciphersuite should use supported cryptographic algorithms for as many of the other components as possible. 
                      For example, if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> only supports TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test server could select
                      TLS_ECDHE_PSK_WITH_NULL_SHA_384, TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5, TLS_ECDHE_RSA_WITH_RC4_128_SHA, TLS_DHE_DSS_WITH_DES_CBC_SHA, TLS_RSA_WITH_IDEA_CBC_SHA, and TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA.  
                      </p>
                   
                      <p>
                        [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ClientHello that is compliant with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9151, except that the ciphersuites field contains the single ciphersuite TLS_AES_128_GCM_SHA256. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                      </p>
                    </li>
                  </ul></span>
                </li>
                
                
                <li class="test-"><a id="_t_144" class="defined" href="#_t_144">Test FCS_TLSC_EXT.1:4</a>:
      (extensions) For each supported version indicated in the following tests, 
                  the evaluator shall establish a connection from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> with a test server negotiating the tested version and providing 
                  server handshake messages as indicated when performing the following tests for validating proper extension handling:
                <span class="testlist-"><ul>
                  <li class="test-"><a id="_t_145" class="defined" href="#_t_145">Test FCS_TLSC_EXT.1:4.1</a>:
      
                    (signature_algorithms) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports certificate-based server authentication, the evaluator shall perform the following tests:
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_146" class="defined" href="#_t_146">Test FCS_TLSC_EXT.1:4.1.1</a>:
      For each supported version, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session with a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> test server and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s 
                        ClientHello includes the signature_algorithms extension with values in conformance with the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>.</li>
                      <li class="test-"><a id="_t_147" class="defined" href="#_t_147">Test FCS_TLSC_EXT.1:4.1.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and supports an <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuite, the evaluator shall ensure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends 
                        a compliant ServerHello message selecting <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and one of the supported <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites, 
                        a compliant server certificate message, and a key exchange message signed using a signature algorithm and hash combination not included in the client’s hello message 
                        (e.g., <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> with <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr>-1). The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the handshake.
                        <p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure, illegal parameter, decryption error) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                      </p></li>
                      <li class="test-"><a id="_t_148" class="defined" href="#_t_148">Test FCS_TLSC_EXT.1:4.1.3</a>:
      [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, the evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server to respond to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> with a compliant ServerHello message selecting <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 
                        and a server certificate message, 
                        but then also send a certificate verification message that uses a signature algorithm method not included in the signature_algorithms extension. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> only includes supported signature algorithms in the signature_algorithms extension in its ClientHello and terminates the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake after receiving the server certificate message.
                        <p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure, illegal parameter, bad certificate, decryption error) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).  
                        </p></li>
                      <li class="test-"><a id="_t_149" class="defined" href="#_t_149">Test FCS_TLSC_EXT.1:4.1.4</a>:
      
                        [conditional] If certificate-based authentication is supported, and for all supported versions for which signature_algorithms_cert is not supported, the evaluator shall ensure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends 
                        a compliant ServerHello message for the tested version and a server certificate message containing a valid certificate that represents the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server, 
                        but which is signed using a signature and hash combination not included in the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s signature_algorithms extension 
                        (e.g., a certificate signed using <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr>-1). The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session.
                        <p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., unsupported certificate, bad certificate, decryption error, handshake failure) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).  
                        </p><p>
                        Certificate-based server authentication is required unless the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> only supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> with shared PSK. 
                        For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, this is the case if only TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442,
                        TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487,
                        TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442, or
                        TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487, are supported. For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, certificate-based server authentication is required.
                        </p></li>
                    </ul></span>
                  </li>
                  <li class="test-"><a id="tls-client-signature-algs-cert" class="defined" href="#tls-client-signature-algs-cert">Test FCS_TLSC_EXT.1:4.2</a>:
      (signature_algorithms_cert) [conditional]  
                    If signature_algorithms_cert is supported, then for each version that uses the signature_algorithms_cert extension, 
                    the evaluator shall ensure that the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends a compliant ServerHello message selecting the tested version and indicating certificate-based server authentication.
                    <p>
                    The evaluator shall ensure that the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server forwards a certificate message containing a valid certificate that represents the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server, 
                    but which is signed by a valid Certification Authority using a signature and hash combination not included in the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s signature_algorithms_cert extension 
                    (e.g., a certificate signed using <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr>-1). The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                    </p><p>
                    <b>Note:</b> Support for certificate-based authentication is assumed if the signature_algorithms_cert is supported. 
                    For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, a non-PSK ciphersuite, or one of TLS_RSA_PSK_WITH_AES_256_GCM_SHA384  
                    or TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487 is used to indicate certificate-based server authentication. 
                    For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the test server completes a full handshake, even if a PSK is offered to indicate certificate-based server authentication. 
                    If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> only supports shared PSK authentication, <a href="#tls-client-signature-algs-cert" class="dynref">Test FCS_TLSC_EXT.1:4.2</a> is not performed.
                    </p><p>
                    For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the server certificate message is encrypted. 
                    The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server with the indicated certificate and ensure that the certificate is 
                    indeed sent by observing the buffer of messages to be encrypted, or by inspecting one or both sets of logs from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server.
                    </p><p>
                    It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., unsupported certificate, bad certificate, decryption error, handshake failure) in response to this, 
                    but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                  </p></li>
                  <li class="test-"><a id="_t_151" class="defined" href="#_t_151">Test FCS_TLSC_EXT.1:4.3</a>:
      (extended_master_secret) [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> (if so configurable) to enforce server support of extended master secret computation and initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 session with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server configured to compute a master secret according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, section 8.
                    <p>
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ClientHello includes the extended master secret extension in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7627, 
                    and ensures that the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server does not include the extended master secret extension in its ServerHello. 
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                    </p><p>
                    <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure) in response to this, 
                    but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                  </p></li>
                  <li class="test-"><a id="_t_152" class="defined" href="#_t_152">Test FCS_TLSC_EXT.1:4.4</a>:
      (supported_groups for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, and supports <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites, the evaluator shall perform the following tests.
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_153" class="defined" href="#_t_153">Test FCS_TLSC_EXT.1:4.4.1</a>:
      For each supported group, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session with a compliant test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server supporting <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7919. 
                      The evaluator shall ensure that the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server is configured to select <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and a ciphersuite using the supported group. 
                      The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ClientHello lists the supported groups as indicated in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>, and that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully establishes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session.</li>
                    <li class="test-"><a id="_t_154" class="defined" href="#_t_154">Test FCS_TLSC_EXT.1:4.4.2</a>:
      [conditional on <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 support for <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites]  The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server that is configured to use an explicit version of a named EC group supported by the client. 
                      The evaluator shall ensure that the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server key exchange message includes the explicit formulation of the group in its key exchange message 
                      as indicated in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 4492, Section 5.4. The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                      <p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., illegal parameter) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                      </p></li>
                  </ul></span>
                  </li>
                </ul></span>
                </li>
                
                  
                <li class="test-"><a id="_t_155" class="defined" href="#_t_155">Test FCS_TLSC_EXT.1:5</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 extensions) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the evaluator shall perform the following tests. 
                  For each test, the evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ClientHello includes the supported versions extension with the value '03 04' indicating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3:
                <span class="testlist-"><ul>
                  <li class="test-"><a id="_t_156" class="defined" href="#_t_156">Test FCS_TLSC_EXT.1:5.1</a>:
      (supported versions) The evaluator shall initiate <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 sessions in turn from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server configured as indicated in the sub-tests below: 
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_157" class="defined" href="#_t_157">Test FCS_TLSC_EXT.1:5.1.1</a>:
      The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server to include the supported versions extension in the ServerHello only containing the value '03 03.' The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session.
                      <p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., illegal parameter, handshake failure, protocol version) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).   
                      </p></li>
                    <li class="test-"><a id="_t_158" class="defined" href="#_t_158">Test FCS_TLSC_EXT.1:5.1.2</a>:
      The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server to include the supported versions extension in the ServerHello containing the value '03 04' and complete a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 handshake. 
                      The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 handshake successfully.</li>
                    <li class="test-"><a id="_t_159" class="defined" href="#_t_159">Test FCS_TLSC_EXT.1:5.1.3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is configurable to support both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, 
                      the evaluator shall follow operational guidance to configure this behavior. The evaluator shall ensure that the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 compliant server handshake and 
                      observe that the server random does not incidentally include any downgrade messaging. 
                      The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 handshake successfully.
                      <p>
                      <b>Note:</b> Enhanced downgrade protection defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 is optional, and if supported, is tested separately. 
                      The evaluator may configure the test server’s random, or may repeat the test until the server’s random does not match a downgrade indicator.
                      </p></li>
                  </ul></span>
                  </li>
                  <li class="test-"><a id="_t_160" class="defined" href="#_t_160">Test FCS_TLSC_EXT.1:5.2</a>:
      (supported groups, key shares) The evaluator shall initiate <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 sessions in turn with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server configured as indicated in the following sub-tests:
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_161" class="defined" href="#_t_161">Test FCS_TLSC_EXT.1:5.2.1</a>:
      For each supported group, the evaluator shall configure the compliant test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server to select a ciphersuite using the group. 
                      The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends an element of the group in its ClientHello key shares extension 
                      (after a hello retry message from the test server, if the key share for the group is not included in the initial ClientHello). 
                      The evaluator shall ensure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends an element of the group in its ServerHello and observes that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake successfully.</li>
                    <li class="test-"><a id="_t_162" class="defined" href="#_t_162">Test FCS_TLSC_EXT.1:5.2.2</a>:
      For each supported group, the evaluator shall modify the ServerHello sent by the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server to include an invalid key share value claiming 
                      to be an element the group indicated in the supported groups extension. 
                      The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session.
                      <p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., illegal parameter) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                      </p><p>
                      For <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites, a zero value, or a value greater or equal to the modulus is not a valid element. 
                      For <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> groups, an invalid point contains x and y coordinates of the correct size, 
                      but represents a point not on the curve. The evaluator shall construct such an invalid point by modifying a byte in the y coordinate of a valid point and verify that the coordinates do not satisfy the curve equation.
                    </p></li>
                  </ul></span>
                    </li>
                  <li class="test-"><a id="_t_163" class="defined" href="#_t_163">Test FCS_TLSC_EXT.1:5.3</a>:
      
                    (PSK support) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports pre-shared keys, the evaluator shall follow the operational guidance to use pre-shared keys, 
                    shall establish a pre-shared key between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server, and initiate <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 sessions in turn 
                    between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server configured as indicated in the following sub-test:
                    <span class="testlist-"><ul>                      
                      <li class="test-"><a id="_t_164" class="defined" href="#_t_164">Test FCS_TLSC_EXT.1:5.3.1</a>:
      The evaluator shall attempt to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to send early data. 
                        If there is no indication from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> that this is blocked, the evaluator shall repeat test 
                        5.3.1 with the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> so configured and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not send application data prior to receiving the ServerHello. 
                        <p>
                        <b>Note:</b> Early data will be encrypted under the PSK and received by the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server prior to it sending a ServerHello message. 
                        </p></li>
                    </ul></span>
                  </li>
                </ul></span>
                </li>
                
                
                
                <li class="test-"><a id="_t_165" class="defined" href="#_t_165">Test FCS_TLSC_EXT.1:6</a>:
      (corrupt finished message) For each supported version, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server that sends a compliant set of server handshake messages, 
                  except for sending a modified finished message 
                  (modify a byte of the finished message that would have been sent by a compliant server). 
                  The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session and does not complete the handshake by 
                  observing that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not send application data provided to the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel.</li>
                
                
                <li class="test-"><a id="tls-client-missing-finished" class="defined" href="#tls-client-missing-finished">Test FCS_TLSC_EXT.1:7</a>:
      (missing finished message) For each supported version, the evaluator shall initiate a session from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server providing a compliant handshake, 
                  except for sending a random <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> message (the five byte header indicates a correct <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> message for the negotiated version, but not indicating a finished message) as the final message. 
                  The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session and does not send application data.
                  <p>
                  <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., decryption error) in response to this, 
                  but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                  </p><p>
                  For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, the modified message is sent after the change_cipher_spec message. For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the modified message is sent as the last message of the server’s second flight of messages.
                  </p></li>
                
                
                <li class="test-"><a id="_t_167" class="defined" href="#_t_167">Test FCS_TLSC_EXT.1:8</a>:
      (unexpected/corrupt signatures within handshake) The evaluator shall perform the following tests, according to the versions supported.
                <span class="testlist-"><ul>
                  <li class="test-"><a id="_t_168" class="defined" href="#_t_168">Test FCS_TLSC_EXT.1:8.1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and if the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates support for <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> or DSA ciphersuites, 
                    the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session with a compliant test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server and modify the signature in the server key exchange. 
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> silently drops the key exchange message or terminates the session.</li>
                  <li class="test-"><a id="_t_169" class="defined" href="#_t_169">Test FCS_TLSC_EXT.1:8.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates support for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> 
                    and a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server that is configured to send a compliant ServerHello message, encrypted extension message, and certificate message, 
                    but will send a certificate verify message with an invalid signature (e.g., by modifying a byte from a valid signature). 
                    The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.</li>
                  <li class="test-"><a id="_t_170" class="defined" href="#_t_170">Test FCS_TLSC_EXT.1:8.3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and if the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates support for both <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> methods in the signature_algorithm 
                    (or, if supported, the signature_algorithms_cert) extension, 
                    and if the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates one or more <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites indicating each of the <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> methods in its signature components, 
                    the evaluator shall choose two ciphersuites: one indicating an <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> signature (cipher 1) and one indicating an <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> signature (cipher 2).
                    The evaluator shall then establish two certificates that are trusted by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>: one representing the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server using an <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> signature (cert 1) and one 
                    representing the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server using an <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> signature (cert 2).
                    
                    The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server that is configured to select cipher 1 and to send cert 2. The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates this <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session.
                    The evaluator shall then initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server that is configured to select cipher 2 and to send cert 1. The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> also terminates this <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session. 
                    <p>
                    <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., bad certificate, decryption error, handshake failure) in response to these tests, 
                    but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                    </p></li>
                </ul></span>
                </li>
                
                
                <li class="test-"><a id="_t_171" class="defined" href="#_t_171">Test FCS_TLSC_EXT.1:9</a>:
      
                  [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports certificate-based server authentication, 
                  then for each supported version, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to the compliant test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server 
                  configured to negotiate the tested version, and to authenticate using a certificate trusted by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as specified in the following:
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_172" class="defined" href="#_t_172">Test FCS_TLSC_EXT.1:9.1</a>:
      <p>(certificate extended key usage purpose) The evaluator shall send a server certificate that contains the Server Authentication purpose in the ExtendedKeyUsage extension 
                      and verify that a connection is established. 
                      The evaluator shall repeat this test using a different certificate that is otherwise valid and trusted but lacks the 
                      Server Authentication purpose in the ExtendedKeyUsage extension and observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                    </p><p>
                      <b>Note:</b>This test is not performed if only <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 with PSK ciphersuites are supported; it is required if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and ciphersuites other than PSK ciphersuites are supported, or if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported.
                    </p><p>
                      Depending on the selections in <a href="#FCS_TLSC_EXT.1.5">FCS_TLSC_EXT.1.5</a> and <a href="#FCS_TLSC_EXT.1.6">FCS_TLSC_EXT.1.6</a>, this test is performed in conjunction with testing of <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> or <abbr class="dyn-abbr"><a href="#abbr_SFR">SFRs</a></abbr> specific to the supported functions using <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>.
                      </p><p>
                      It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., bad certificate, decryption error, handshake failure) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                      </p><p>
                      Ideally, the two certificates should be similar in regards to structure, the types of identifiers used, and the chain of trust.
                    </p></li>
                    <li class="test-"><a id="_t_173" class="defined" href="#_t_173">Test FCS_TLSC_EXT.1:9.2</a>:
      
                      (certificate identifiers) For each supported method of matching presented identifiers, 
                      and for each name type for which the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> parses the presented identifiers from the server certificate for the method, 
                      the evaluator shall establish a valid certificate trusted by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to represent the test server using only the tested name type. The evaluator shall perform the following sub-tests: 
                      <span class="testlist-"><ul>
                        <li class="test-"><a id="_t_174" class="defined" href="#_t_174">Test FCS_TLSC_EXT.1:9.2.1</a>:
      The evaluator shall prepare the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary to use the matching method and establish reference identifiers
                          for the test server for the tested name type. The evaluator shall ensure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends a certificate with a matching name of the tested name type 
                          and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the connection.</li>
                        <li class="test-"><a id="_t_175" class="defined" href="#_t_175">Test FCS_TLSC_EXT.1:9.2.2</a>:
      The evaluator shall prepare the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary to use the matching method and establish reference identifiers that do not match the name representing the test server. 
                          The evaluator shall ensure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends a certificate with a name of the type tested, and observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                          <p>
                          <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, 
                          but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                          </p></li>
                        <li class="test-"><a id="tls-client-valid-wildcard" class="defined" href="#tls-client-valid-wildcard">Test FCS_TLSC_EXT.1:9.2.3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports wildcards for a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or SVR name type, the evaluator shall prepare the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary 
                          to use the matching method for the name type, and establish a reference identifier. 
                          The evaluator shall establish a certificate for the test server that includes a wildcard name for the <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion of 
                          the appropriate name type which matches the reference identifier. 
                          The evaluator shall ensure the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends the certificate containing the wildcard name of the type tested, 
                          and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the connection. </li>
                        <li class="test-"><a id="tls-client-no-wildcard" class="defined" href="#tls-client-no-wildcard">Test FCS_TLSC_EXT.1:9.2.4</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or SVR name type, but does not support wildcards (in general, 
                          or specifically for internationalized names of the specified type), the evaluator shall prepare the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary 
                          to use the matching method and establish a reference identifier that matches a wildcard name for the <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion of the appropriate name type, 
                          in accordance with the appropriate <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr>, in a certificate representing the server. 
                          The evaluator shall ensure the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends the certificate containing the wildcard name of the type tested, 
                          and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection. 
                        <p>
                          <b>Note:</b> If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>'s ability to support wildcard certificates is configurable, 
                          both <a href="#tls-client-valid-wildcard" class="dynref">Test FCS_TLSC_EXT.1:9.2.3</a> and <a href="#tls-client-no-wildcard" class="dynref">Test FCS_TLSC_EXT.1:9.2.4</a> are performed under the appropriate configuration. 
                          This test is required if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports internationalized names of the specified type – in this case, the reference identifier only includes 
                          an internationalized encoding in the leftmost label. 
                          The certificate used is intended to match the certificate as if wildcards were supported and if the wildcard extended to internationalized names.
                        </p>
                        </li>
                        <li class="test-"><a id="tls-client-invalid-wildcard" class="defined" href="#tls-client-invalid-wildcard">Test FCS_TLSC_EXT.1:9.2.5</a>:
      
                          [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports wildcards for a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or SVR name type, the evaluator shall prepare the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary to use the matching method. 
                          The evaluator shall establish a reference identifier and a certificate for the server as indicated in each of the sub-tests described below. 
                          The evaluator shall in turn, ensure the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends the certificate associated with the reference identifier 
                          and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session. 
                          <span class="testlist-"><ul>
                            <li class="test-"><a id="_t_179" class="defined" href="#_t_179">Test FCS_TLSC_EXT.1:9.2.5.1</a>:
      The reference identifier contains a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion with two labels, and the certificate includes a name whose <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion includes 
                              a matching rightmost label and a wildcard in the leftmost label (e.g., *.com).</li>
                            <li class="test-"><a id="_t_180" class="defined" href="#_t_180">Test FCS_TLSC_EXT.1:9.2.5.2</a>:
      The reference identifier contains a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion with four labels, 
                              and the certificate includes a name whose <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion includes two rightmost labels matching the reference identifier, 
                              and a wildcard in the third label, and a matching identifier in the fourth (leftmost) label (e.g., foo.*.example.com).</li>
                            <li class="test-"><a id="_t_181" class="defined" href="#_t_181">Test FCS_TLSC_EXT.1:9.2.5.3</a>:
      The reference identifier contains a <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion with three labels, 
                              and the certificate includes a name whose <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> portion includes two rightmost labels matching the reference identifier, 
                              and a wildcard in the third (leftmost) label (e.g., *.example.com).</li>
                          </ul></span>
                        </li>
                        <li class="test-"><a id="_t_182" class="defined" href="#_t_182">Test FCS_TLSC_EXT.1:9.2.6</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports wildcards and supports embedded <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr>, or SVR name types in the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>, 
                          then for each supported name type, the evaluator shall repeat 
                          <a href="#tls-client-valid-wildcard" class="dynref">Test FCS_TLSC_EXT.1:9.2.3</a>, <a href="#tls-client-no-wildcard" class="dynref">Test FCS_TLSC_EXT.1:9.2.4</a>, and <a href="#tls-client-invalid-wildcard" class="dynref">Test FCS_TLSC_EXT.1:9.2.5</a>
                          using certificates with the prescribed name embedded in the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>. 
                        </li>
                        <li class="test-"><a id="tls-client-ip-wildcard" class="defined" href="#tls-client-ip-wildcard">Test FCS_TLSC_EXT.1:9.2.7</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses as an embedded name type in the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>, 
                          the evaluator shall establish an <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address as a reference identifier and establish a certificate with a valid <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name in the subject field, 
                          including a <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> whose value is the digital formatting of the octets of the reference identifier. 
                          The evaluator shall ensure the server sends the certificate and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully completes the session.</li>
                        <li class="test-"><a id="_t_184" class="defined" href="#_t_184">Test FCS_TLSC_EXT.1:9.2.8</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses and any embedded name type in the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>, 
                          the evaluator shall establish an <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> address as a reference identifier and establish a certificate with a valid <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name in the subject field, 
                          including a <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> whose value is the digital formatting of the octets of the reference identifier (as in <a href="#tls-client-ip-wildcard" class="dynref">Test FCS_TLSC_EXT.1:9.2.7</a>) 
                          except that one of the octets is replaced by the ‘*’ character. 
                          The evaluator shall ensure the server sends the certificate and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.</li>
                      </ul></span>
                    </li>
                    
                    
                    <li class="test-"><a id="_t_185" class="defined" href="#_t_185">Test FCS_TLSC_EXT.1:9.3</a>:
      (mixed identifiers)[conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports a name matching method where the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> performs matching of both <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-encoded name types and <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> names of the same type, 
                      then for each such method, and for each such name type, the evaluator shall establish a valid certificate trusted by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> 
                      to represent the test server using one name for the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-encoded name type and a different name for the <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name type The evaluator shall perform the following tests: 
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_186" class="defined" href="#_t_186">Test FCS_TLSC_EXT.1:9.3.1</a>:
      The evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to use the name matching method and establish reference identifiers matching only the <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr>. 
                        The evaluator shall ensure that the test server sends the certificate with the matching <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> and non-matching <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-encoded name, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the connection.
                        <p>
                        <b>Note:</b> Configuration of the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> may depend on the application using <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>.
                        </p></li>
                      <li class="test-"><a id="_t_187" class="defined" href="#_t_187">Test FCS_TLSC_EXT.1:9.3.2</a>:
      The evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to use the name matching method and establish reference identifiers matching only the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-encoded name. 
                        The evaluator shall ensure that the test server sends the certificate with the matching <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-encoded name and non-matching <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr>, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                        <p>
                        It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).  
                        </p></li>
                    </ul></span>
                    </li>
                    <li class="test-"><a id="_t_188" class="defined" href="#_t_188">Test FCS_TLSC_EXT.1:9.4</a>:
      (empty certificate) The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server to supply an empty certificate message and verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                      <p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                      </p></li>
                    <li class="test-"><a id="_t_189" class="defined" href="#_t_189">Test FCS_TLSC_EXT.1:9.5</a>:
      (invalid certificate) [conditional] If validity exceptions are supported, 
                      then  for each exception for certificate validity supported, 
                      the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to allow the exception and ensure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server sends a certificate that is valid and trusted, 
                      except for the allowed exception. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the session. 
                      <p>
                      Without modifying the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> configuration, the evaluator shall initiate a new session with the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server that includes an additional validation error, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                      </p><p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., decode error, bad certificate) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                      </p><p>
                      The intent of this test is to verify the scope of the exception processing. 
                      If verifying certificate status information is claimed as an exception, then this test will verify that a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session succeeds when all supported methods for obtaining certificate status information is blocked from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>, 
                      to include removing any status information that might be cached by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>. 
                      If the exception is limited to specific certificates 
                      (e.g., only leaf certificates are exempt, or only certain leaf certificates are exempt) 
                      the additional validation error could be unavailable revocation information for a non-exempt certificate 
                      (e.g., revocation status information from an intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> is blocked for the issuing <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> of an exempt leaf certificate, 
                      or revocation information from the issuing <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> is blocked for a non-exempt leaf certificate). 
                      If the only option for the exception is for all revocation information for all certificates, another validation error from <span class="no-link">FIA_X509_EXT.1</span> (e.g., certificate expiration, extended key usage, etc.) may be used. 
                    </p></li>
                  </ul></span>
                </li>
              </ul></span>
	             </div></div></div></div></div>
        
        
        
        <div class="comp" id="FCS_TLSC_EXT.2"><h4>FCS_TLSC_EXT.2 TLS Client Support for Mutual Authentication</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</a>.
      </i></b></div>
		  
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.2.1"><a href="#FCS_TLSC_EXT.2.1" class="abbr">FCS_TLSC_EXT.2.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support mutual <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> authentication using X.509v3 certificates during the handshake and [<b>selection</b>: <span class="selectable-content" id="_s_283">in support of post-handshake authentication requests</span>, <span class="selectable-content" id="_s_284">at no other time</span>], in accordance with [<b>selection</b>: <span class="selectable-content" id="_s_285"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, Section 7.4.4</span>, <span class="selectable-content" id="_s_286"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, Section 4.3.2</span>].<div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "mutual authentication" is selected in <a href="#FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</a>.
              </p><p>
              Clients that support <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 and post-handshake authentication should claim "in support of post-handshake authentication requests"
              in the first selection.  
              The "at no other time" selection is claimed for clients only supporting <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 or for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 clients that do not support post-handshake authentication.  
              </p><p>
              The certificate request message sent by the server specifies the signature algorithms and certification authorities supported by the server. 
              If the client does not possess a matching certificate, it sends an empty certificate message. 
              The structure of the certificate request message is changed in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 to use the signature_algorithm, signature_algorithms_cert (optional), and certificate_authorities extensions, 
              and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 allows for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 implementations to use the new message structure. 
              The "<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, Section 4.3.2" option is claimed in the second selection if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported or if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 method is supported for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 servers. 
              The "<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, Section 7.4.4" option is claimed if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246 method is supported for interoperability with <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 servers that do not adopt the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 method. 
              When mutual authentication is supported, at least one of these methods must be claimed, per the selection.
              </p>
            </span></div></div></div>
	  
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSC_EXT.2">FCS_TLSC_EXT.2</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> description required per <span class="no-link">FIA_X509_EXT.2.1</span> includes the use of client-side certificates for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> mutual authentication. 
                The evaluator shall also ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes any factors beyond configuration that are necessary in order for the client to engage in mutual authentication using X.509v3 certificates.
                </p>
	      </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                The evaluator shall ensure that the operational guidance includes any instructions necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to perform mutual authentication. 
                The evaluator shall also verify that the operational guidance required per <span class="no-link">FIA_X509_EXT.2.1</span> includes instructions for configuring the client-side certificates for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> mutual authentication.
                </p>
	      </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                For each supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> version, the evaluator shall perform the following tests:
       <span class="testlist-"><ul>
         <li class="test-"><a id="_t_190" class="defined" href="#_t_190">Test FCS_TLSC_EXT.2:1</a>:
      The evaluator shall establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> connection from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server that negotiates the tested version 
           and which is not configured for mutual authentication (i.e., does not send a Server’s Certificate Request (type 13) message). 
           The evaluator shall observe negotiation of a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel and confirm that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> did not send a Client’s Certificate message (type 11) during handshake.</li>
         <li class="test-"><a id="_t_191" class="defined" href="#_t_191">Test FCS_TLSC_EXT.2:2</a>:
      The evaluator shall establish a connection to a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server with a shared trusted root that is configured for mutual authentication 
           (i.e., it sends a Server’s Certificate Request (type 13) message). 
           The evaluator shall observe negotiation of a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel and confirm that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> responds with a non-empty Client’s Certificate message (type 11) and Certificate Verify (type 15) message.</li>
         <li class="test-"><a id="_t_192" class="defined" href="#_t_192">Test FCS_TLSC_EXT.2:3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports post-handshake authentication, 
           the evaluator shall establish a pre-shared key between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server. 
           The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session using the pre-shared key and confirm the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server successfully complete the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake and both support post-handshake authentication. 
           After the session is successfully established, the evaluator shall initiate a certificate request message from the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server. 
           The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> receives that authentication request 
           and shall take necessary actions, in accordance with the operational guidance, to complete the authentication request. 
           The evaluator shall confirm that the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server receives certificate and certificate verification messages from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> over the channel that authenticates the client.
           <p>
           <b>Note:</b> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 certificate requests from the test server and client certificate and certificate verify messages are encrypted. 
           The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends the appropriate messages by examining the messages received at the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server and by inspecting any relevant server logs. 
           The evaluator may also take advantage of the calling application to demonstrate that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> receives data configured at the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server. 
           </p></li>
       </ul></span>
	      </div></div></div></div></div>
	      
        <div class="comp" id="FCS_TLSC_EXT.3"><h4>FCS_TLSC_EXT.3 TLS Client Downgrade Protection</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</a>.
      </i></b></div>
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.3.1"><a href="#FCS_TLSC_EXT.3.1" class="abbr">FCS_TLSC_EXT.3.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel if the ServerHello message includes 
              [<b>selection</b>: <span class="selectable-content" id="_s_287"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator</span>, <span class="selectable-content" id="_s_288"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade indicator</span>]
              in the server random field. <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "supplemental downgrade protection" is selected in <a href="#FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</a>.
              </p><p>
              The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims the “<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator” when <a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a> indicates support for both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 and 
              implements supplemental downgrade protection. 
              This option is not claimed if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is not supported. 
              The “<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade indicator” option may also be claimed if supported, 
              but should only be claimed if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is capable of detecting the indicator. 
              This package requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to always terminate <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 sessions based on the ServerHello negotiated version field; it is 
              acceptable to ignore any downgrade indicator. 
              However, a <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> that is capable of detecting the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade indicator may claim this option if it takes
              different actions depending on whether the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade indicator is set. 
              </p>
            </span></div></div></div> 
	  
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSC_EXT.3">FCS_TLSC_EXT.3</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                The evaluator shall review the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and confirm that the description of the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client protocol includes the downgrade protection mechanism in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 
                and identifies any configurable features of the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> needed to meet the requirements. 
                If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> claims that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 and below indicator is processed, 
                the evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> indicates which configurations allow processing of the downgrade indicator 
                and the specific response of the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> when it receives the downgrade indicator as opposed to simply terminating the session for the unsupported version.
                </p>
	      </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                The evaluator shall review the operational guidance and confirm that any instructions to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to meet the requirements are included.
                </p>
	      </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall perform the following tests to confirm the response to downgrade indicators from a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server:
              <span class="testlist-"><ul>
                <li class="test-"><a id="_t_193" class="defined" href="#_t_193">Test FCS_TLSC_EXT.3:1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 session with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server 
                  configured to send a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ServerHello (not including any <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 extensions) 
                  but including the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator ‘44 4F 57 4E 47 52 44 01’ in the last eight bytes of the server random field. 
                  The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                  <p>  
                  <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> send a fatal error alert message (e.g., illegal parameter), but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminate the session without sending an error alert.
                  </p></li>
                <li class="test-"><a id="_t_194" class="defined" href="#_t_194">Test FCS_TLSC_EXT.3:2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade indicator and if the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates a configuration where the indicator is processed, 
                  the evaluator shall follow operational guidance instructions to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> so it parses a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 handshake to detect and process the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> downgrade indicator. 
                  The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server that is configured to send a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 ServerHello message 
                  with the downgrade indicator ‘44 4F 57 4E 47 52 44 00’ in the last eight bytes of the server random field, 
                  but which is otherwise compliant with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 4346. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session as described in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>.
                  <p>
                  <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> send a fatal error alert message (illegal parameter or unsupported version), but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminate the session without sending an error alert. 
                  </p><p>
                  Use of the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 and below indicator as a redundant mechanism 
                  where there is no configuration that actually processes the value does not require additional testing, 
                  since this would be addressed by <a href="#tls-client-obsolete-versions" class="dynref">Test FCS_TLSC_EXT.1:2.1</a> for <a href="#FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</a>. 
                  This test is only required if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> responds differently (e.g., a different error alert) when the downgrade indicator is present than when <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below is negotiated and the downgrade indicator is not present.
                  </p></li>
              </ul></span>
	      </div></div></div></div></div>
	      
        <div class="comp" id="FCS_TLSC_EXT.4"><h4>FCS_TLSC_EXT.4 TLS Client Support for Renegotiation</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
      </i></b></div>
          
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.4.1"><a href="#FCS_TLSC_EXT.4.1" class="abbr">FCS_TLSC_EXT.4.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support secure <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> renegotiation through use of
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_289">the “renegotiation_info” <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extension</span></li><li style=""><span class="selectable-content" id="_s_290">the TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuite signaling value in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746</span></li><li style=""><span class="selectable-content" id="_s_291">rejection of all renegotiation attempts</span></li></ul>]
              and shall terminate the session if an unexpected ServerHello is received or [<b>selection</b>: <span class="selectable-content" id="_s_292">hello request message is received</span>, <span class="selectable-content" id="_s_293">in no other case</span>]. 
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a client" is selected in <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
              </p>
              <p>
                The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims the methods supported.
              </p>
              <p>
              A client supporting <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 renegotiation may present either the "renegotiation_info" extension or the 
              signaling ciphersuite value TLS_EMPTY_RENEGOTIATION_INFO_SCSV in the initial 
              ClientHello message to indicate support for secure renegotiation.
              </p>
              <p>
                A client supporting <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 must claim "rejection of all renegotiation attempts." This option may also be claimed as a 
                method for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 renegotiation protection.
              </p>
              <p>
              The TLS_EMPTY_RENEGOTIATION_INFO_SCSV is the preferred mechanism for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 protection against insecure renegotiation when the
              client does not renegotiate. 
              The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author will claim the ‘hello request message is received’ option in the second selection to indicate support for this
              mechanism.
              </p>
              <p>
              <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 allows the client to accept connections with servers that do not support the extension; 
              this <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> refines <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 and requires the client to terminate sessions with such servers. 
              Thus, unexpected ServerHello messages include an initial ServerHello negotiating 
              <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 that does not contain a renegotiation_info extension, 
              an initial ServerHello negotiating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 that has a renegotiation_info extension that is non-empty, 
              a subsequent ServerHello renegotiating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 that does not contain a renegotiation_info extension, 
              a subsequent ServerHello negotiating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 that has a renegotiation_info extension with an incorrect renegotiated_connection
              value, and a ServerHello request message when renegotiation is not allowed (for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 or when the option is claimed for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2). 
              </p>
              <p>
              <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 provides protection against insecure renegotiation by not allowing renegotiation. 
              If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is claimed in <a href="#FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</a>, the client receives a ServerHello that attempts to negotiate <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, and the ServerHello
              also contains a non-empty renegotiation_info extension; the client will terminate the connection.
              </p>
            </span></div></div></div>
	  
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSC_EXT.4">FCS_TLSC_EXT.4</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure that <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> renegotiation protections are described in accordance with the requirements. 
                The evaluator shall ensure that any configurable features of the renegotiation protections are identified.
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
              <p>
                The evaluator shall examine the operational guidance to confirm that instructions for any configurable features of the renegotiation protection mechanisms are included.
              </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall perform the following tests as indicated. If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and one or more of the secure renegotiation methods defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 is claimed, <a href="#tls-client-accepts-renegotiation" class="dynref">Test FCS_TLSC_EXT.4:1</a> is required. If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> (has a configuration that) rejects all <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 renegotiation attempts, or if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, <a href="#tls-client-prevents-renegotiation" class="dynref">Test FCS_TLSC_EXT.4:2</a> is required.
              <span class="testlist-"><ul>
                <li class="test-"><a id="tls-client-accepts-renegotiation" class="defined" href="#tls-client-accepts-renegotiation">Test FCS_TLSC_EXT.4:1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and supports a configuration to accept renegotiation requests for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, 
                  the evaluator shall follow any operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>. The evaluator shall perform the following tests:  
                <span class="testlist-"><ul>
                  <li class="test-"><a id="tls-client-offers-renegotiation" class="defined" href="#tls-client-offers-renegotiation">Test FCS_TLSC_EXT.4:1.1</a>:
      The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> connection with a test server configured to negotiate a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 handshake. 
                    The evaluator shall inspect the messages received by the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server. 
                    The evaluator shall observe that either the “renegotiation_info” field or the <abbr class="dyn-abbr"><a href="#abbr_SCSV">SCSV</a></abbr> ciphersuite is included in the ClientHello message during the initial handshake.</li>
                  <li class="test-"><a id="_t_197" class="defined" href="#_t_197">Test FCS_TLSC_EXT.4:1.2</a>:
      For each of the following sub-tests, the evaluator shall initiate a new <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> connection with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server configured to send a renegotiation_info extension as specified, 
                    but otherwise complete a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 session:
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_198" class="defined" href="#_t_198">Test FCS_TLSC_EXT.4:1.2.1</a>:
      The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server to send a renegotiation_info extension whose value indicates a non-zero length. 
                      The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection. 
                      <p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., illegal parameter) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                      </p>
                    </li>
                    <li class="test-"><a id="_t_199" class="defined" href="#_t_199">Test FCS_TLSC_EXT.4:1.2.2</a>:
      The evaluator shall configure the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server to send a compliant renegotiation_info extension and observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully completes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 connection.</li>
                    <li class="test-"><a id="_t_200" class="defined" href="#_t_200">Test FCS_TLSC_EXT.4:1.2.3</a>:
      The evaluator shall initiate a session renegotiation after completing a successful handshake with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server that completes a successful <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 handshake 
                      (as in <a href="#tls-client-offers-renegotiation" class="dynref">Test FCS_TLSC_EXT.4:1.1</a>) and then sends a hello reset request from the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server with a 
                      “renegotiation_info” extension that has an unexpected “client_verify_data” or “server_verify_data” 
                      value (modify a byte from a compliant response). The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection.
                      <p>
                      <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., illegal parameter, handshake error) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                      </p>
                    </li>
                  </ul></span>
                  </li>
                </ul></span>
                </li>
                <li class="test-"><a id="tls-client-prevents-renegotiation" class="defined" href="#tls-client-prevents-renegotiation">Test FCS_TLSC_EXT.4:2</a>:
      [conditional] if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports a configuration that prevents renegotiation, the evaluator shall perform the following tests:
                  <span class="testlist-"><ul>
                    <li class="test-"><a id="_t_202" class="defined" href="#_t_202">Test FCS_TLSC_EXT.4:2.1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and supports a configuration to reject <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 renegotiation, the evaluator shall follow the operational guidance as necessary to prevent renegotiation.  The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session between the so-configured <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 server that is configured to perform a compliant handshake, followed by a hello reset request. The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the initial handshake successfully but does not initiate renegotiation after receiving the hello request.
                    </li>
                    <li class="test-"><a id="_t_203" class="defined" href="#_t_203">Test FCS_TLSC_EXT.4:2.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server that completes a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 handshake, 
                      followed by a hello reset message. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the initial <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 handshake successfully, but terminates the session on receiving the hello reset message.
                      <p>
                      It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., unexpected message) in response to this, 
                      but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                      </p>
                    </li>
                  </ul></span>
                </li>
              </ul></span>
	      </div></div></div></div></div>
	      
        <div class="comp" id="FCS_TLSC_EXT.5"><h4>FCS_TLSC_EXT.5 TLS Client Support for Session Resumption</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</a>.
      </i></b></div>
           
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.5.1"><a href="#FCS_TLSC_EXT.5.1" class="abbr">FCS_TLSC_EXT.5.1</a></div><div class="reqdesc">
            The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support session resumption as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client via the use of [<b>selection</b>: <span class="selectable-content" id="_s_294">session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246</span>, <span class="selectable-content" id="_s_295">tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077</span>, <span class="selectable-content" id="tlsc_v13_resumption">PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span>]. 
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
              This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "session resumption" is selected in <a href="#FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</a>.
              </p><p>
              The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates which session resumption mechanisms are supported. 
              One or both of the first two options, "session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246" and "tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077" are claimed
              if resumption of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 sessions is supported. 
              If resumption of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 sessions is supported, "PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446" is selected, and the selection-based <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> <a href="#FCS_TLSC_EXT.6">FCS_TLSC_EXT.6</a> must also be claimed.
              </p><p>
              While it is possible to perform session resumption using PSK ciphersuites in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, this is uncommon. 
              Validation of key exchange and session negotiation rules for PSK ciphersuites is independent of the source of the pre-shared key and is covered in <a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a>. 
              </p>
            </span></div></div></div>  
	  
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSC_EXT.5">FCS_TLSC_EXT.5</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
              <p>
                The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and confirm that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client protocol description includes a description of the supported resumption mechanisms.
              </p>
	      </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
              <p>
                The evaluator shall ensure the operational guidance describes instructions for any configurable features of the resumption mechanism.
              </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
              The evaluator shall perform the following tests:
              <span class="testlist-"><ul>
                <li class="test-"><a id="tls-client-successful-resumption" class="defined" href="#tls-client-successful-resumption">Test FCS_TLSC_EXT.5:1</a>:
      For each supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> version and for each supported resumption mechanism that is supported for that version, 
                  the evaluator shall establish a new <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and a compliant test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server that is configured to negotiate the indicated version 
                  and perform resumption using the indicated mechanism. 
                  The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the initial <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake and shall cause the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to close the session normally. 
                  The evaluator shall then cause the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to resume the session with the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server using the indicated method and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully establishes the session.
                  <p>
                  <b>Note:</b> For each method, successful establishment refers to proper use of the mechanism, to include compliant extensions and behavior, as indicated in the referenced <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr>.
                  </p>
                </li>
                <li class="test-"><a id="_t_205" class="defined" href="#_t_205">Test FCS_TLSC_EXT.5:2</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 session id echo) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the evaluator shall initiate a new <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 session with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server. 
                  The evaluator shall cause the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server to send a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ServerHello message 
                  (or a hello retry request if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not include the key share extension) that contains a different value in the legacy_session_id field from the expected 32-byte value, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                  <p>
                  <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., illegal parameter) in response to this, 
                  but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                  </p>
                </li>
              </ul></span>
	      </div></div></div></div></div>

        <div class="comp" id="FCS_TLSC_EXT.6"><h4>FCS_TLSC_EXT.6 TLS Client TLS 1.3 Resumption Refinements</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLSC_EXT.5.1">FCS_TLSC_EXT.5.1</a>.
      </i></b></div>
           
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.6.1"><a href="#FCS_TLSC_EXT.6.1" class="abbr">FCS_TLSC_EXT.6.1</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall send a psk_key_exchange_modes extension with the value psk_dhe_ke when <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 session resumption is offered. 
            </div></div>
          <div class="element"><div class="reqid" id="FCS_TLSC_EXT.6.2"><a href="#FCS_TLSC_EXT.6.2" class="abbr">FCS_TLSC_EXT.6.2</a></div><div class="reqdesc">
                The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not send early data in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 sessions. 
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446" is selected in <a href="#FCS_TLSC_EXT.5.1">FCS_TLSC_EXT.5.1</a>.
              </p>
              <p>
              This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed when session resumption is supported for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3. <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 allows pre-shared keys to be used directly 
              and also allows early data to be protected using only the pre-shared key. This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> refines the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> to use PSK only with a supplemental <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> key exchange to ensure perfect forward secrecy for all sessions. 
            </p>
            </span></div></div></div>  
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSC_EXT.6">FCS_TLSC_EXT.6</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to verify that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client protocol description indicates that the PSK exchange requires <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> mode and prohibits sending early data. 
                The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to verify it lists all applications that can be secured by <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 using pre-shared keys and 
                describes how each <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 client application ensures data for the application is not sent using early data.
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                The evaluator shall examine the operational guidance to verify that instructions for any configurable features that are required to meet the requirement are included. 
                The evaluator shall ensure the operational guidance includes any instructions required to configure applications so the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 client implementation does not send early data.
                </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                [conditional] For each application that is able to be secured via <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 using PSK, 
                the evaluator shall follow operational guidance to configure the application not to send early data. 
                The evaluator shall cause the application to initiate a resumed <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 session between the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and a compliant test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server as in 
                <a href="#tls-client-successful-resumption" class="dynref">Test FCS_TLSC_EXT.5:1</a> in <a href="#FCS_TLSC_EXT.5">FCS_TLSC_EXT.5</a>. 
                The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> ClientHello for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 includes the psk_mode extension with the value psk_dhe_ke and sends a key share value for a supported group. 
                The evaluator shall confirm that early data is not received by the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server.
                <p>
                <b>Note:</b> If no applications supported by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> provide data to <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 that can be sent using PSK, this test is omitted.
                </p>
              </div></div></div></div></div>


   

        <div class="comp" id="FCS_TLSS_EXT.1"><h4>FCS_TLSS_EXT.1 TLS Server Protocol</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
      </i></b></div>
          
          
          
          
          
          
           
          
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.1.1"><a href="#FCS_TLSS_EXT.1.1" class="abbr">FCS_TLSS_EXT.1.1</a></div><div class="reqdesc"> The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement
              [<b>selection</b>: <span class="selectable-content" id="_s_297"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246)</span>, <span class="selectable-content" id="_s_298"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span>] as a server that supports additional functionality for session renegotiation protection and
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="tlss_mutual_auth">mutual authentication</span></li><li style=""><span class="selectable-content" id="tlss_downgrade_protection">supplemental downgrade protection</span></li><li style=""><span class="selectable-content" id="tlss_resumption">session resumption</span></li><li style=""><span class="selectable-content" id="_s_302">no optional functionality</span></li></ul>]
              and shall reject connection attempts from clients supporting only <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1, <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.0, or SSL versions.
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a server" is selected in <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
              </p><p>
              These requirements will be revisited as new <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> versions are standardized by the <abbr class="dyn-abbr"><a href="#abbr_IETF">IETF</a></abbr>.
              </p><p>
                Session renegotiation protection is required for both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, and the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the requirements from <a href="#FCS_TLSS_EXT.4">FCS_TLSS_EXT.4</a>. 
                Within <a href="#FCS_TLSS_EXT.4">FCS_TLSS_EXT.4</a>, options for implementation of secure session renegotiation for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 or rejecting renegotiation requests are claimed.
              </p><p>
              If "mutual authentication" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include the requirements from <a href="#FCS_TLSS_EXT.2">FCS_TLSS_EXT.2</a>. If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> with mutual authentication, this selection must be made.
              </p><p>
                Supplemental downgrade protection is claimed if both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 are supported. If "supplemental downgrade protection" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include the requirements from <a href="#FCS_TLSS_EXT.3">FCS_TLSS_EXT.3</a>. 
              If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> provides downgrade protection as indicated in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, in particular, if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, this selection must be made. 
              </p><p>
              If "session resumption" is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include the requirements from <a href="#FCS_TLSS_EXT.5">FCS_TLSS_EXT.5</a>.
              </p>
            </span></div></div></div>
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.1.2"><a href="#FCS_TLSS_EXT.1.2" class="abbr">FCS_TLSS_EXT.1.2</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following:
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_303"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites:
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_304">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8422</span></li><li style=""><span class="selectable-content" id="_s_305">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289 and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8422</span></li><li style=""><span class="selectable-content" id="_s_306">TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5288</span></li><li style=""><span class="selectable-content" id="_s_307">TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5288</span></li><li style=""><span class="selectable-content" id="_s_308">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289</span></li><li style=""><span class="selectable-content" id="_s_309">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5289</span></li><li style=""><span class="selectable-content" id="_s_310">ciphersuites using pre-shared secrets:
                    [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_311">TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442</span></li><li style=""><span class="selectable-content" id="_s_312">TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487</span></li><li style=""><span class="selectable-content" id="_s_313">TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487</span></li></ul>]</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_314"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites:
            [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_315">TLS_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span></li><li style=""><span class="selectable-content" id="_s_316">[<b>assignment</b>: 
     <span class="assignable-content">other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites</span>]</span></li></ul>]</span></li></ul>]
              using a preference order based on [<b>selection</b>: <span class="selectable-content" id="_s_317"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9151 priority</span>, <span class="selectable-content" id="_s_318">ClientHello ordering</span>, <span class="selectable-content" id="_s_319">[<b>assignment</b>: 
     <span class="assignable-content">additional priority</span>]</span>].
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
              The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author should select the ciphersuites that are supported and must select at least one ciphersuite for each <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> version supported. 
              It is necessary to limit the ciphersuites that can be used administratively in an evaluated configuration on the server in the test environment. 
              If administrative steps need to be taken so that the ciphersuites negotiated by the implementation are limited to those in this requirement, then the appropriate instructions need to be contained in the guidance. 
              </p>
              <p>
              The final selection indicates the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>’s preference for negotiating a ciphersuite. 
              <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9151 indicates the required ciphersuites for NSS systems and "<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9151 priority" is claimed if those ciphersuites are
              selected whenever offered by the client. The final option is used to provide a specific preference ordering that does not agree
              with either of the other options.               
              </p>
              <p>
              While indicated as mandatory in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, the ciphersuite TLS_AES_128_GCM_SHA256 is deprecated by this <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> and should not be
              included in “other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites.” The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author may list additional <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites as they are registered.
              </p>
              <p>
              The ‘ClientHello ordering’ option is claimed if client priority is considered; 
              if both are claimed, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author should indicate which is primary and which is secondary, and whether the priority scheme is configurable. 
              If other priority schemes or if tertiary priority is used, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author will claim the third option and describe the scheme in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>.
              </p>
             </span></div></div></div>
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.1.3"><a href="#FCS_TLSS_EXT.1.3" class="abbr">FCS_TLSS_EXT.1.3</a></div><div class="reqdesc">
            The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a connection with a client that does not indicate support for at least one of the supported cryptographic
            parameter sets.
          <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                In <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 handshakes, the cryptographic parameters are determined by the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite components passed in the client
                hello. In <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the cryptographic parameters are determined by the ciphersuite components and the supported group
                extension. When both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 are supported, cryptographic parameters are determined by the highest version
                supported by the client.
              </p>
              <p>
                Ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 are of the form TLS_(key exchange algorithm)_WITH_(encryption algorithm)_(message digest algorithm)
                and are listed in the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters section of the internet assignments at iana.org.
              </p>
              <p>
                Ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 are of the form TLS_(AEAD)_(HASH), where (AEAD) is of the form (encryption algorithm)_(symmetric key
                length)_(mode) for an authenticated encryption with associated data specification (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5116).
              </p>
            </span></div></div></div>
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.1.4"><a href="#FCS_TLSS_EXT.1.4" class="abbr">FCS_TLSS_EXT.1.4</a></div><div class="reqdesc">
            The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to process the following <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ClientHello message extensions: 
            <ul>
              <li>signature_algorithms extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for 
                [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_320">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_321">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_322">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_323">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_324">no other signature algorithms</span></li></ul>]
                and
                </li>
            </ul>
              
                  [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_325">signature_algorithms_cert extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_326">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_327">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_328">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_329">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_330">no other signature algorithms</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_331">supported_versions extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 and [<b>selection</b>: <span class="selectable-content" id="_s_332"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2</span>, <span class="selectable-content" id="_s_333">no other versions</span>]</span></li><li style=""><span class="selectable-content" id="_s_334">supported_groups extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7919, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_335">secp384r1</span></li><li style=""><span class="selectable-content" id="_s_336">secp521r1</span></li><li style=""><span class="selectable-content" id="_s_337">ffdhe3072(257)</span></li><li style=""><span class="selectable-content" id="_s_338">ffdhe4096(258)</span></li><li style=""><span class="selectable-content" id="_s_339">ffdhe6144(259)</span></li><li style=""><span class="selectable-content" id="_s_340">ffdhe8192(260)</span></li></ul>]</span></li><li style=""><span class="selectable-content" id="_s_341">key_share extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_342">extended_master_secret extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 7627) enforcing client support and
                      [<b>selection</b>: <span class="selectable-content" id="_s_343">allowing legacy clients</span>, <span class="selectable-content" id="_s_344">no other enforcement mode</span>]</span></li><li style=""><span class="selectable-content" id="_s_345">no other extensions</span></li></ul>].
              
          <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                Support for the signature_algorithms extension is optional in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246 but is mandated for this functional package. Support for the signature_algorithms extension is mandatory in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 and remains so in this functional package. Whether the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>'s implementation conforms to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, or both is dependent on whether the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, or both.
              </p>
              <p>
            If support for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is claimed in <a href="#FCS_TLSS_EXT.1.1">FCS_TLSS_EXT.1.1</a>, the selections for supported_versions, supported_groups, and key_share are claimed. 
            If support for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is not claimed, supported_versions and key_share are not claimed.
              </p>
              <p>
                If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is claimed, extended_master_secret extension is claimed, with the ability to enforce client support, and optionally, the ability to support legacy clients.     
              </p>
              <p>
            If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites are claimed in <a href="#FCS_TLSS_EXT.1.2">FCS_TLSS_EXT.1.2</a>, the entry for supported_groups is claimed. Support for additional extensions is acceptable.
            For signature_algorithms and signature_algorithms_certs (if supported), at least one of the signature schemes presented in the first sub-selection is claimed.
              </p>
          </span></div></div></div>
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.1.5"><a href="#FCS_TLSS_EXT.1.5" class="abbr">FCS_TLSS_EXT.1.5</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall perform key establishment for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> using [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_351"><abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> with size [<b>selection</b>: <span class="selectable-content" id="_s_352">3072</span>, <span class="selectable-content" id="_s_353">4096</span>] bits and no other sizes</span></li><li style=""><span class="selectable-content" id="_s_354">Diffie-Hellman groups [<b>selection</b>: <span class="selectable-content" id="_s_355">ffdhe3072</span>, <span class="selectable-content" id="_s_356">ffdhe4096</span>, <span class="selectable-content" id="_s_357">ffdhe6144</span>, <span class="selectable-content" id="_s_358">ffdhe8192</span>] and no other groups,
                consistent with the client's supported groups extension and [<b>selection</b>: <span class="selectable-content" id="_s_359">key share</span>, <span class="selectable-content" id="_s_360">no other</span>] extension
                </span></li><li style=""><span class="selectable-content" id="_s_361"><abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> parameters using elliptic curves [<b>selection</b>: <span class="selectable-content" id="_s_362">secp256r1</span>, <span class="selectable-content" id="s-tls-secp384">secp384r1</span>, <span class="selectable-content" id="_s_364">secp521r1</span>] and no other curves,  
                  consistent with the client's supported groups extension and [<b>selection</b>: <span class="selectable-content" id="_s_365">key share</span>, <span class="selectable-content" id="_s_366">no other</span>] extension and using non-compressed formatting for points
                </span></li></ul>].
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
              <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 perform key exchange using different mechanisms.
              </p>
              <p>If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> ciphersuites are supported, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims the "<abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> with key size..." option and the
                key sizes supported. The requirements apply to the <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> key size for the server's certificate and in the key exchange messages
                received by the server
              </p>
              <p>
              If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> are supported, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author may claim the "Diffie-Hellman parameters..." The requirements apply
              to the server key exchange messaged sent by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>. 
              </p>
              <p>
              If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and supported groups extension are supported (for <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> groups), the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims the
              “Diffie_Hellman groups…” or “<abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> parameters...” according to the supported ciphersuites and supported groups extension
              values. This is required when <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites are supported and recommended when <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites are supported.
              </p>
              <p>
              If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims one or both of "Diffie-Hellman groups..." or "<abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> parameters..." options, and
              claims the "key share" options in the sub-selections. The requirements apply to the values of the supported groups extension
              and the key share extension contained in the ServerHello message.              
              </p>
            </span></div></div></div>
        
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                The evaluator shall check the description of the implementation of this protocol in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure the supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> versions, features, ciphersuites, and extensions, 
                are specified in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246 (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2) and <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 and updates to <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2) as appropriate. The evaluator shall check the description to see if beta <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 versions are supported.
                </p><p>
                  The evaluator shall verify that ciphersuites indicated in <a href="#FCS_TLSS_EXT.1.2">FCS_TLSS_EXT.1.2</a> are included in the description, and that none of the following ciphersuites are supported: ciphersuites indicating NULL, RC2, RC4, DES, IDEA, TDES, or <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>-128 in the encryption algorithm component, indicating 'anon,' or indicating MD5 or <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr> in the message digest algorithm component.
                </p><p>
                The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> implementation description includes the extensions as required in <a href="#FCS_TLSS_EXT.1.4">FCS_TLSS_EXT.1.4</a>.
                </p><p>
                The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> description includes the number and types of certificates that can be installed to represent the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>.
                </p>
	      </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                The evaluator shall check the operational guidance to ensure that it contains instructions on configuring the product so that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> conforms to the requirements. 
                If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates that beta versions of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 are supported for backward compatibility, the evaluator shall ensure that the operational guidance provides instructions for disabling these versions.
                </p><p>
                The evaluator shall review the operational guidance to ensure instructions on installing certificates representing the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> are provided.
                </p>
	      </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall perform the following tests:
                <span class="testlist-"><ul>
                  
                  <li class="test-"><a id="_t_206" class="defined" href="#_t_206">Test FCS_TLSS_EXT.1:1</a>:
      (supported configurations) The evaluator shall perform the following tests: 
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="tls-server-supported-configurations" class="defined" href="#tls-server-supported-configurations">Test FCS_TLSS_EXT.1:1.1</a>:
      
                        [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, for each supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite, the evaluator shall send a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ClientHello with the highest version or legacy version of 1.2 (value '03 03'), 
                        a single entry in the ciphersuites field consisting of the specific ciphersuite, and
                        no supported version extension or key share extension. The evaluator shall observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ServerHello indicates <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 in the highest version or legacy version field,  
                        does not include a supported version or key share extension, and indicates the specific ciphersuite in the ciphersuite field. 
                        If the ciphersuite requires certificate-based authentication, the evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a valid certificate representing the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and successfully completes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake. 
                        <p>
                        <b>Note:</b> The ciphersuites TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487, 
                        TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442, and TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487, if supported, do not require certificate-based authentication of the server. 
                        </p>
                      </li>
                      <li class="test-"><a id="_t_208" class="defined" href="#_t_208">Test FCS_TLSS_EXT.1:1.2</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 support for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 clients) [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is configurable to support only <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 (or if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is not supported), 
                        and if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites, the evaluator shall follow any operational guidance instructions necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to only support <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2. 
                        For each supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite with <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> indicated as the key exchange method, 
                        the evaluator shall send a ClientHello with the highest version or legacy version of 1.2 (value '03 03'), 
                        a list of ciphersuites consisting of one or more <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuites followed by the specific <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite and no other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites in the ciphersuites field, 
                        and including a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 supported group and key share extension with consistent values. 
                        The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ServerHello indicates <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 in the highest version or legacy version field, 
                        does not include a supported version or key share extension, and indicates the specific <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite in the ciphersuite field. 
                        The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 handshake successfully.
                        <p>
                        <b>Note:</b> Supported ciphersuites using <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> key exchange should not be included in this test. 
                        The supported groups extension sent by the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client should be consistent with the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite (e.g., it should be an EC group if the ciphersuite is <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr>).
                        </p>
                      </li>
                      <li class="test-"><a id="_t_209" class="defined" href="#_t_209">Test FCS_TLSS_EXT.1:1.3</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 support) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, then for each supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuite and key exchange group, 
                        the evaluator shall send a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ClientHello indicating a list of one or more <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites followed by the specific <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuite and no other ciphersuites in the ciphersuites field, 
                        a supported version extension indicating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 (value '03 04') only, 
                        a supported groups extension indicating the selected group, and a key share extension containing a value representing an element of the specific group. 
                        The evaluator shall observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ServerHello contains the supported versions extension indicating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the specific ciphersuite in the selected ciphersuite field, 
                        and a key share extension containing an element of the specific supported group. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> completes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 handshake successfully.</li>
                    </ul></span>
                    <p>
                    <b>Note:</b> The connections in <a href="#tls-server-supported-configurations" class="dynref">Test FCS_TLSS_EXT.1:1.1</a> may be established as part of the establishment of a higher-level protocol, e.g., as part of an <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> session.
                    </p><p>
                    It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; 
                    it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr> and not 256-bit <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>).
                    </p><p>
                    It is not necessary to pair every supported ciphersuite with every supported group. 
                    It is sufficient to use a set of ciphersuite and supported group pairs such that each ciphersuite and each supported group are included in this set.
                    </p><p>
                    <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 includes the supported_groups extension in the encrypted_extensions message. 
                    This message may be observed at the test client after it is decrypted to help verify the key_share is actually a member of the supported group requested.
                    </p>
                  </li>
                  
                  
                  <li class="test-"><a id="_t_210" class="defined" href="#_t_210">Test FCS_TLSS_EXT.1:2</a>:
      (obsolete versions) The evaluator shall perform the following tests:
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="tls-server-obsolete-versions" class="defined" href="#tls-server-obsolete-versions">Test FCS_TLSS_EXT.1:2.1</a>:
      For each of SSL version 2, SSL version 3, <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.0, <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1, and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 if it is not supported, 
                        the evaluator shall send a ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> indicating the selected version as the highest version. The evaluator shall observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection. 
                        <p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., protocol version, insufficient security) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                        </p></li>
                      <li class="test-"><a id="tls-server-beta-versions" class="defined" href="#tls-server-beta-versions">Test FCS_TLSS_EXT.1:2.2</a>:
      [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is not supported, or if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported and the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates that it processes the legacy version field, then the evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to ensure any supported beta <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 versions are disabled, as necessary. 
                        The evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a ClientHello message indicating the supported version (referred to as the legacy version in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) 
                        with the value '03 04' and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> responds with a ServerHello indicating the highest version supported.
                        <p>
                        <b>Note:</b> <a href="#tls-server-beta-versions" class="dynref">Test FCS_TLSS_EXT.1:2.2</a> is intended to test the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> response to non-standard versions, including beta versions of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3. 
                        If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports such beta versions, the evaluator shall follow the operational guidance instructions to disable them prior to 
                        conducting <a href="#tls-server-beta-versions" class="dynref">Test FCS_TLSS_EXT.1:2.2</a>.
                        </p><p>
                        Some <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 implementations ignore the legacy version field and only check for the supported_versions extension to determine <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 support by a client. 
                        It is preferred that the legacy version field should still be set to a standard version ('03 03') in the ServerHello, 
                        but it is acceptable that presence of the supported_versions indicating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 (value '03 04') overrides the legacy_version indication to determine highest supported version. In this case, this test is not performed.
                        </p></li>
                    </ul></span>
          </li>
                  
                  
                  <li class="test-"><a id="_t_213" class="defined" href="#_t_213">Test FCS_TLSS_EXT.1:3</a>:
      (ciphersuites)  The evaluator shall perform the following tests on handling unexpected ciphersuites using a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client 
                    sending handshake messages compliant with the negotiated version except as indicated in the test: 
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_214" class="defined" href="#_t_214">Test FCS_TLSS_EXT.1:3.1</a>:
      (ciphersuite not supported) For each supported version, the evaluator shall follow the operational guidance, 
                        if available, to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to disable a supported ciphersuite. 
                        The evaluator shall send a compliant ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> indicating support for the specific version and a ciphersuites field containing this single disabled ciphersuite. 
                        The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                        <p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                        </p><p>
                        If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s ciphersuites are not configurable, it is acceptable to use a named ciphersuite from the IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> protocols associated with the tested version. 
                        Additional special cases of this test for special ciphersuites are performed separately.
                        </p>
                      </li>
                      <li class="test-"><a id="tls-server-version-confusion" class="defined" href="#tls-server-version-confusion">Test FCS_TLSS_EXT.1:3.2</a>:
      (version confusion) For each supported version, the evaluator shall send a ClientHello that is compliant for the specific version
                        that includes a list of ciphersuites consisting of a single ciphersuite not associated with that version. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                        <p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                        </p><p>
                        If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, <a href="#tls-server-version-confusion" class="dynref">Test FCS_TLSS_EXT.1:3.2</a> sends a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuite to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as a server negotiating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, using a supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ciphersuite if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3. 
                          If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, <a href="#tls-server-version-confusion" class="dynref">Test FCS_TLSS_EXT.1:3.2</a> sends a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite with compatible supported_group, signature_algorithms, and key share to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as a server negotiating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, using a supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported. 
                        </p>
                      </li>
                      <li class="test-"><a id="_t_216" class="defined" href="#_t_216">Test FCS_TLSS_EXT.1:3.3</a>:
      (null ciphersuite) For each supported version, the evaluator shall send a ClientHello indicating support for the version and include a ciphersuite list consisting of 
                        only the null ciphersuite (TLS_NULL_WITH_NULL_NULL, with the value '00 00') and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                        <p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                        </p>
                      </li>
                      <li class="test-"><a id="_t_217" class="defined" href="#_t_217">Test FCS_TLSS_EXT.1:3.4</a>:
      
                      <p>
                      (anonymous connection request) The evaluator shall perform one or more of the following tests according to the supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> versions:
                      </p><p>
                        [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 handshake that is compliant, except that the ciphersuites field includes a ciphersuite list consisting only of ciphersuites using the anonymous server authentication method and observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                      </p>
                        <p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).  
                        </p><p>
                        See IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters for available ciphersuites to be included in the ClientHello. 
                        The test ciphersuites list should include ciphersuites using supported cryptographic algorithms in as many of the other components as possible. 
                        For example, if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports the ciphersuite TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the evaluator should include TLS_DH_ANON_WITH_AES_256_GCM_SHA_384.
                      </p>
                        <p>
                          [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> (if necessary) to not support anonymous server requests, and send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a ClientHello containing the server_cert_type extension indicating only ‘raw public key’ type. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> either ignores the extension (the extension is not supported), proceeding with a normal <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake, to include sending a valid certificate and certificate verify message, or it terminates the session (the extension is supported, but the anonymous server functionality is not supported). 
                        </p><p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., unsupported_certificate) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).  
                        </p>
                      </li>
                      <li class="test-"><a id="tls-server-deprecated-encryption" class="defined" href="#tls-server-deprecated-encryption">Test FCS_TLSS_EXT.1:3.5</a>:
      
                        <p>
                        (deprecated encryption algorithm) The evaluator shall perform one or more of the following, depending on the supported versions: 
                        </p><p>
                          [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ClientHello that is compliant with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9591, except that the ciphersuites field is a list consisting only of ciphersuites indicating a deprecated encryption algorithm, including at least one each of NULL, RC2, RC4, DES, IDEA, TDES, and <abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr>-128. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                        </p><p>
                          <b>Note:</b> See IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters for available <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites to be included. The test ciphersuite should use supported cryptographic algorithms for as many of the other components as possible. For example, if the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test could include TLS_ECDHE_PSK_WITH_NULL_SHA_384, TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5, TLS_ECDHE_RSA_WITH_RC4_128_SHA, TLS_DHE_DSS_WITH_DES_CBC_SHA, TLS_RSA_WITH_IDEA_CBC_SHA, and TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA.
                        </p><p>
                          [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ClientHello that is compliant with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9591, except that the ciphersuites field contains the single ciphersuite TLS_AES_128_GCM_SHA256. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects the connection.
                        </p><p>
                          <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                        </p>
                       </li>
                    </ul></span>
                    </li>
                  
                  
                  <li class="test-"><a id="_t_219" class="defined" href="#_t_219">Test FCS_TLSS_EXT.1:4</a>:
      (extensions)
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_220" class="defined" href="#_t_220">Test FCS_TLSS_EXT.1:4.1</a>:
      
                        (signature algorithms) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports certificate-based authentication, 
                        then for each supported signature algorithm indicated in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>, the evaluator shall perform the following sub-tests with certificates that represent the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>. 
                        For each sub-test, the evaluator shall establish a certificate
                        representing the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and using a public-private key pair suitable for the specific signature algorithm value, and signed by a certification authority
                        that uses the same signature algorithm.
                       <p>
                        If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> also supports the signature_algorithms_cert extension, then for each value of the signature_algorithms_cert extension, 
                        the evaluator shall repeat the sub-tests 
                        
                        using a certificate representing the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and using a key pair consistent with the signature algorithm, 
                        but signed by a certification authority using the signature algorithm specified in the signature_algorithms_cert extension. 
                       </p><p>
                        <b>Note:</b> If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports certificate-based server authentication if the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 supported ciphersuites include ciphersuites other than 
                        TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487, 
                        TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8442, and TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5487. 
                        If these are the only supported ciphersuites, this test is omitted. If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, certificate-based server authentication is required, and the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ClientHello for the test should not include the PSK extension.
                       </p><p>
                        The evaluator shall follow operational guidance instructions to provision the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> with one or more of these certificates as indicated in the following sub-tests:
                       </p>
                        <span class="testlist-"><ul>
                          <li class="test-"><a id="tls-server-correct-signature" class="defined" href="#tls-server-correct-signature">Test FCS_TLSS_EXT.1:4.1.1</a>:
      [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, then for each supported value of the signature_algorithms extension, the evaluator shall provision a certificate with a key pair compatible with the specific signature_algorithm value and 
                            send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ClientHello that indicates all supported ciphersuites and has a signature_algorithms extension consisting of a single value matching the specific signature algorithm.
                            <p>
                            If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports the signature_algorithms_cert extension, the ClientHello also contains the value consistent with the provisioned certificate.
                            </p><p>
                            The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> negotiates <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 with
                            a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuite that is compatible with the signature algorithm, and that it sends a certificate message containing the provisioned certificate with a key pair that is consistent 
                            with the specific signature_algorithm value (and signed using the signature_algorithms_cert extension value, if supported). 
                            </p><p>
                            <b>Note:</b> For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, the ciphersuite describes the signature algorithm as <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> 
                            and is compatible with the certificate used if the signature algorithm component of the ciphersuite is of the same type as the signature value of the signature_algorithms extension. 
                            </p>
                          </li>
                          <li class="test-"><a id="tls-server-correct-1-3-signature" class="defined" href="#tls-server-correct-1-3-signature">Test FCS_TLSS_EXT.1:4.1.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, then for each supported value of the signature_algorithm, 
                            the evaluator shall provision a certificate with a key pair that is compatible with the specific signature_algorithm value, 
                            send a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ClientHello that indicates a supported ciphersuite and has a signature_algorithms extension consisting of a single value matching the specific signature algorithm. 
                            <p>
                            If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports the signature_algorithms_cert extension, the ClientHello also contains a signature_algorithms_cert extension with a value consistent with the provisioned certificate.
                            </p><p>
                            The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a certificate message containing the provisioned certificate consistent with the 
                            specific signature_algorithm value (and signed using the signature_algorithms_cert extension value) and a certificate verify message using the signature_algorithms extension value.
                            </p><p>
                            <b>Note:</b> For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the certificate message and certificate verify is encrypted. The evaluator shall confirm the values of these messages as received at the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client, using logs, or using a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client designed to expose the certificates after they are decrypted. 
                            </p><p>
                            It is not necessary to manually verify the signature used in the key exchange message (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2) or certificate verify message (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3). 
                            </p></li>
                          <li class="test-"><a id="_t_223" class="defined" href="#_t_223">Test FCS_TLSS_EXT.1:4.1.3</a>:
      
                            [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports provisioning of multiple certificates, 
                            the evaluator shall conduct the following sub-tests:
                            <span class="testlist-"><ul>
                              <li class="test-"><a id="tls-server-mismatch-signature" class="defined" href="#tls-server-mismatch-signature">Test FCS_TLSS_EXT.1:4.1.3.1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, the evaluator shall repeat <a href="#tls-server-correct-signature" class="dynref">Test FCS_TLSS_EXT.1:4.1.1</a> with both the provisioned certificate indicated for 
                                <a href="#tls-server-correct-signature" class="dynref">Test FCS_TLSS_EXT.1:4.1.1</a> and a provisioned certificate using a public key that is not consistent with the 
                                signature_algorithm value, but signed by a <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> using the signature algorithm specified in the ClientHello. 
                                The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s certificate message does not include the certificate that does not match 
                                the signature_algorithm value in the ClientHello. </li>
                              <li class="test-"><a id="tls-server-mismatch-1-3-signature" class="defined" href="#tls-server-mismatch-1-3-signature">Test FCS_TLSS_EXT.1:4.1.3.2</a>:
      [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, 
                                the evaluator shall similarly repeat <a href="#tls-server-correct-1-3-signature" class="dynref">Test FCS_TLSS_EXT.1:4.1.2</a> 
                                with both the provisioned certificate indicated for <a href="#tls-server-correct-1-3-signature" class="dynref">Test FCS_TLSS_EXT.1:4.1.2</a> and a provisioned certificate 
                                with public keys that are not consistent with the signature_algorithm value but which are signed by a <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> 
                                using the signature_algorithm value specified in the ClientHello, 
                                and observe that the certificate message sent by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not include the certificate that 
                                does not match the value of the signature_algorithm entry in the ClientHello. </li>
                              <li class="test-"><a id="_t_226" class="defined" href="#_t_226">Test FCS_TLSS_EXT.1:4.1.3.3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> also indicates support for the signature_algorithms_cert extension, 
                                the evaluator shall repeat <a href="#tls-server-mismatch-signature" class="dynref">Test FCS_TLSS_EXT.1:4.1.3.1</a> (if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported) and <a href="#tls-server-mismatch-1-3-signature" class="dynref">Test FCS_TLSS_EXT.1:4.1.3.2</a> 
                                (if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported) using additional provisioned certificates 
                                representing the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> that use public keys consistent with the signature_algorithm value, 
                                but which are signed by CAs using signature algorithms that do not match the value of the signature_algorithms_cert in the ClientHello 
                                and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s certificate message does not include the certificate that does not match 
                                the signature_algorithms_cert values in the ClientHello.</li>
                            </ul></span>  
                          </li>
                          <li class="test-"><a id="_t_227" class="defined" href="#_t_227">Test FCS_TLSS_EXT.1:4.1.4</a>:
      [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, the evaluator shall provision a certificate as in <a href="#tls-server-correct-signature" class="dynref">Test FCS_TLSS_EXT.1:4.1.1</a>, 
                            but shall send a ClientHello that only offers ciphersuites whose signature component does not match the value of the signature_algorithms extension. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the handshake.
                            <p>
                            <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure, illegal parameter) in response to this, 
                            but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                            </p></li>
                        </ul></span>
                      </li>
                      <li class="test-"><a id="_t_228" class="defined" href="#_t_228">Test FCS_TLSS_EXT.1:4.2</a>:
      (extended master secret) [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> as necessary to enforce client support for extended master secret. The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 session with the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> from a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client for which the ClientHello does not include the extended master secret extension and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                        <p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake error) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
                        </p>
                      </li>
                      <li class="test-"><a id="_t_229" class="defined" href="#_t_229">Test FCS_TLSS_EXT.1:4.3</a>:
      
                        (supported_groups for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2) 
                        [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, and supports <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites, the evaluator shall perform the following tests.                        
                      </li>
                    </ul></span>
                  </li>
                  
                  
                  <li class="test-"><a id="tls-server-key-exchange" class="defined" href="#tls-server-key-exchange">Test FCS_TLSS_EXT.1:5</a>:
      
                    (key exchange) The evaluator shall perform the following tests to confirm compliant key exchange:
                    <span class="testlist-"><ul>
                      <li class="test-"><a id="_t_231" class="defined" href="#_t_231">Test FCS_TLSS_EXT.1:5.1</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> key exchange) [conditional] If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported and if any of the supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ciphersuites in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> includes <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> for the key exchange method, the evaluator shall perform the following sub-tests:
                        <span class="testlist-"><ul>
                          <li class="test-"><a id="_t_232" class="defined" href="#_t_232">Test FCS_TLSS_EXT.1:5.1.1</a>:
      For each supported <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> key size, the evaluator shall provision the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> with a valid certificate that has an <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> public key of that size. 
                            The evaluator shall initiate a valid <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 handshake from a compliant test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 client and observe that the server certificate message matches the provisioned certificate.</li>
                          <li class="test-"><a id="_t_233" class="defined" href="#_t_233">Test FCS_TLSS_EXT.1:5.1.2</a>:
      For each supported <abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr> key size, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ClientHello, 
                            but in place of the client’s key exchange message, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a (non-compliant) key exchange message that is properly formatted but uses an invalid EncryptedPreMasterSecret 
                            field in the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake (e.g., modify a byte of a properly computed value). 
                            The evaluator shall attempt to complete the handshake using compliant client change cipher spec and finished messages and verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the handshake in a manner that is indistinguishable 
                            from a finished message error and does not send application data.
                            <p>
                            <b>Note:</b> Mitigations for oracle attacks described in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246 Appendix D require the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to exhibit the same behavior for key exchange failures as it does for finished message failures. 
                            It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> send a fatal decrypt failure error alert at the end of the handshake in both this case and for a finished message error,  
                            but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminate the session with another error alert, or without sending an error alert in either case. 
                            If the failure error alert is not for a decryption failure, the evaluator shall note that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>’s response agrees with the response observed 
                            in the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 iteration of <a href="#tls-server-rejects-bad-client-finished" class="dynref">Test FCS_TLSS_EXT.1:5.2</a>. 
                            </p>
                          </li>
                        </ul></span>
                        </li>
                      <li class="test-"><a id="tls-server-rejects-bad-client-finished" class="defined" href="#tls-server-rejects-bad-client-finished">Test FCS_TLSS_EXT.1:5.2</a>:
      For each supported version, the evaluator shall initiate a compliant handshake up through the (implied for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3) change cipher spec message. 
                        The evaluator shall then send a (non-compliant) client finished handshake message with an invalid ‘verify data’ value and 
                        verify that the server terminates the session and does not send any application data.
                        <p>
                        <b>Note:</b> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 handshakes include explicit change cipher spec messages, 
                        but <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 omits the change cipher spec message. If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, the modified finished message is sent as the final message from the client 
                        after receiving the server’s second flight of handshake messages [encrypted extensions, (new ticket), (certificate, certificate verify), (certificate request)].
                        </p><p>
                        It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> send a fatal decryption failure error alert, but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminate the session using another error alert or without sending an error alert.
                        </p><p>
                        The finished message is encrypted. The invalid ‘verify data’ can be constructed by modifying a byte of a compliant finished message payload.
                      </p>
                      </li>
                      <li class="test-"><a id="_t_235" class="defined" href="#_t_235">Test FCS_TLSS_EXT.1:5.3</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> key exchange) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and supports <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, then the evaluator shall perform the following sub-tests:
                        <span class="testlist-"><ul>                          
                          <li class="test-"><a id="_t_236" class="defined" href="#_t_236">Test FCS_TLSS_EXT.1:5.3.1</a>:
      
                            [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> ciphersuites and supports <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> groups in the supported groups extension, 
                            then for each supported <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> group, the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ClientHello indicating a single ciphersuite that is
                            compatible with the group and indicating the group in the supported groups extension. 
                            The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> negotiates <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 using the indicated ciphersuite and that the server key exchange message indicates the specific group. 
                            The evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> a client key exchange with a valid point in the group and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully completes the session.
                          </li><li class="test-"><a id="_t_237" class="defined" href="#_t_237">Test FCS_TLSS_EXT.1:5.3.2</a>:
      
                            The evaluator shall send a ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as in the previous test with identical ciphersuite and supported
                            group extension values. After the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> responds with a valid key exchange message, 
                            the evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a client key exchange with the public key value '0.' The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                          </li><li class="test-"><a id="_t_238" class="defined" href="#_t_238">Test FCS_TLSS_EXT.1:5.3.3</a>:
      
                            The evaluator shall send a ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as in the previous two tests including the same ciphersuite, but now instead indicating a group not supported by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> in the supported groups extension. 
                            The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                            <p>
                            <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., decryption failure, illegal parameter, handshake error) in response to this, 
                            but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                          </p>
                          </li>
                          <li class="test-"><a id="_t_239" class="defined" href="#_t_239">Test FCS_TLSS_EXT.1:5.3.4</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuites (and therefore supports <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> groups in the supported groups extension), 
                            the evaluator shall send a ClientHello message indicating a single supported <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuite and including the supported <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> group in the supported groups extension. 
                            The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a key exchange message with a valid point of the specified group. 
                            The evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a client key exchange message to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> consisting of a valid element in the supported group and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully completes the session.
                          </li><li class="test-"><a id="_t_240" class="defined" href="#_t_240">Test FCS_TLSS_EXT.1:5.3.5</a>:
      
                            The evaluator shall send a ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as in the previous test with identical ciphersuite and supported group extension values. After the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends the valid key exchange message, 
                            the evaluator shall send a client key exchange message consisting of an invalid element of the supported group and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the handshake.
                          </li><li class="test-"><a id="_t_241" class="defined" href="#_t_241">Test FCS_TLSS_EXT.1:5.3.6</a>:
      
                            The evaluator shall send a ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as in the previous two tests indicating the supported <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> ciphersuite, but now including an <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> group that is not supported. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session. 
                            <p>
                            <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., decryption failure, illegal parameter, handshake error, insufficient security) in response to this, 
                            but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).  
                            </p><p>
                            An invalid <abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr> point consists of properly formatted x and y components, but for which the equation of the curve is not satisfied. To obtain an invalid point, the evaluator shall modify a byte of the y coordinate value of a valid point and confirm that the point is not on the curve. 
                            </p><p>
                            The IANA <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> parameters website lists registered <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> groups for use in selecting a non-supported group. If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports all registered <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> groups, it is acceptable to send the ClientHello without a supported groups extension. The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> should reject such a ClientHello, but it is acceptable for the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to default to a supported group. In this case, the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> passes the test.
                            </p>
                          </li>
                        </ul></span>
                      </li>
                      <li class="test-"><a id="_t_242" class="defined" href="#_t_242">Test FCS_TLSS_EXT.1:5.4</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 key exchange) [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, then for each supported group the evaluator shall perform the following sub-tests: 
                        <span class="testlist-"><ul>
                          <li class="test-"><a id="_t_243" class="defined" href="#_t_243">Test FCS_TLSS_EXT.1:5.4.1</a>:
      The evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ClientHello indicating a single key share value from the supported group and shall observe that the ServerHello 
                            includes valid elements of the supported group.</li>
                          <li class="test-"><a id="_t_244" class="defined" href="#_t_244">Test FCS_TLSS_EXT.1:5.4.2</a>:
      The evaluator shall send the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 ClientHello indicating a supported groups value supported by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> 
                            but containing a key share extension indicating an element claiming to be in the supported group that does not represent a valid element of the group. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
                            <p>
                            <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., illegal parameter, handshake failure, decryption failure) in response to this, 
                            but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                            </p><p>
                            For <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> groups, the invalid element may be of the wrong length; 
                            for <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> groups, the invalid element has coordinates (x and y) that do not satisfy the equation of the elliptic curve. 
                            To obtain an invalid <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> point, the evaluator shall modify a byte of the y coordinate value of a valid point and confirm that the point is not on the curve.
                            </p></li>
                        </ul></span>
                        </li>
                      <li class="test-"><a id="tls-server-no-finished-msg" class="defined" href="#tls-server-no-finished-msg">Test FCS_TLSS_EXT.1:5.5</a>:
      For each supported version, the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake from a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client 
                        with compliant handshake messages negotiating the version and supported parameters 
                        to include the change cipher spec message (implied for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3), but which omits the finished message and instead 
                        sends an application message containing random data. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection.
                        <p>
                        <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., decryption failure) in response to this, 
                        but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                        </p><p>
                        Application data is indicated by the TLSCipherText ContentType field having value 23 (application data). 
                        The legacy record version '03 03' and length fields should match a valid TLSCipherText message of the same size.
                        </p></li>
                    </ul></span>
                  </li>
                </ul></span>
	      </div></div></div></div></div>

       <div class="comp" id="FCS_TLSS_EXT.2"><h4>FCS_TLSS_EXT.2 TLS Server Support for Mutual Authentication</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLSS_EXT.1.1">FCS_TLSS_EXT.1.1</a>.
      </i></b></div>
         
         
         
         
         
         
         
         
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.2.1"><a href="#FCS_TLSS_EXT.2.1" class="abbr">FCS_TLSS_EXT.2.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support authentication of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> clients using X.509v3 certificates during the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake and [<b>selection</b>: <span class="selectable-content" id="_s_367">during post-handshake requests</span>, <span class="selectable-content" id="_s_368">at no other time</span>] 
              using the certificate types indicated in the client’s signature_algorithms and [<b>selection</b>: <span class="selectable-content" id="_s_369">signature_algorithms_cert</span>, <span class="selectable-content" id="_s_370">no other</span>] extension.
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "mutual authentication" is selected in <a href="#FCS_TLSS_EXT.1.1">FCS_TLSS_EXT.1.1</a>.
              </p><p>
              <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 supports authentication after completing the abbreviated handshake with pre-shared keys. 
              A server may send a client a certificate request after the finished message whenever the client includes the post-handshake authentication extension. 
              The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims ‘during post-handshake request’ if this feature is supported. 
              If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is not supported, or if the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> post-handshake request extension is not recognized in a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 handshake, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author selects ‘at no other time’.
              </p>
            </span></div></div></div>
         <div class="element"><div class="reqid" id="FCS_TLSS_EXT.2.2"><a href="#FCS_TLSS_EXT.2.2" class="abbr">FCS_TLSS_EXT.2.2</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support authentication of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> clients using X.509v3 certificates in accordance with <span class="no-link">FIA_X509_EXT.1</span>.</div></div>
         <div class="element"><div class="reqid" id="FCS_TLSS_EXT.2.3"><a href="#FCS_TLSS_EXT.2.3" class="abbr">FCS_TLSS_EXT.2.3</a></div><div class="reqdesc">
             The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to reject the establishment of a trusted channel if the requested client certificate is invalid and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_371">continue establishment of a server-only authenticated <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel in accordance with <a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a> in support of [<b>selection</b>: <span class="selectable-content" id="_s_372">all applications</span>, <span class="selectable-content" id="_s_373">[<b>assignment</b>: 
     <span class="assignable-content">list of calling applications that accept both authenticated and unauthenticated client sessions</span>]</span>] 
                 when an empty certificate message is provided by the client</span></li><li style=""><span class="selectable-content" id="_s_374">continue establishment of a mutually authenticated <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel when revocation status information for the [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_375">client's leaf certificate</span></li><li style=""><span class="selectable-content" id="_s_376">[<b>assignment</b>: 
     <span class="assignable-content">specific intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificates</span>]</span></li><li style=""><span class="selectable-content" id="_s_377">any non-trust store certificate in the certificate chain</span></li></ul>]  
                 is not available in support of [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_378">all supported functions</span></li><li style=""><span class="selectable-content" id="_s_379">[<b>assignment</b>: 
     <span class="assignable-content">list of calling supported functions configurable to perform certificate status information bypass processing</span>]</span></li></ul>] as [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_380">configured by an administrator</span></li><li style=""><span class="selectable-content" id="_s_381">confirmed by the supported function user</span></li><li style=""><span class="selectable-content" id="_s_382">a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>-specific default for [<b>assignment</b>: 
     <span class="assignable-content">subset of supported functions</span>]</span></li></ul>]
               </span></li><li style=""><span class="selectable-content" id="_s_383">no other processing options for missing or invalid client certificates</span></li></ul>]. 
           <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
             <p>
             The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims any certificate processing exceptions that are allowed for specific calling applications. 
             The "continue establishment of a server-only authenticated <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel" selection is claimed if the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> product supports applications that can 
             provide services to unauthenticated users if the user does not possess an appropriate certificate. 
             Within this selection, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates which applications are able to support both authenticated and unauthenticated users.
             </p><p>
             The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims "continue establishment of a mutually authenticated <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel" if there is an administrator configuration or 
             user confirmation that revocation status information is not available for one or more of the certificates in the client’s certificate chain. 
             If claimed, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author will describe in the assignment for intermediate values which <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificates are included in the exception 
             (for example, “all intermediates but the issuing <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>” or “specific end-entity certificates as configured”). 
             Within this selection, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author specifies which applications are impacted and which authorized user is allowed to approve continuing with the session 
             when revocation information is not available.</p><p> 
             If an administrator configures whether a user may accept a certificate without status information, both selections are claimed. 
             The "a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>-specific default" selection should only be chosen for applications that do not have access to revocation information. This
             is not claimed when alternate revocation methods are claimed in <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> that apply to <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client certificates.
             Methods for obtaining revocation information are included in <span class="no-link">FIA_X509_EXT.1</span>.
             </p>
           </span></div></div></div>
         <div class="element"><div class="reqid" id="FCS_TLSS_EXT.2.4"><a href="#FCS_TLSS_EXT.2.4" class="abbr">FCS_TLSS_EXT.2.4</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_384">not establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session if an entry of the Distinguished Name or a [<b>selection</b>: <span class="selectable-content" id="_s_385">rfc822_name</span>, <span class="selectable-content" id="_s_386">dns_name</span>, <span class="selectable-content" id="_s_387">[<b>assignment</b>: 
     <span class="assignable-content">supported name types</span>]</span>]
               in the Subject Alternate Name extension contained in the client certificate does not match one of the expected identifiers for the client in accordance with [<b>selection</b>: <span class="selectable-content" id="_s_388"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822</span>, <span class="selectable-content" id="_s_389"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span>, <span class="selectable-content" id="_s_390"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280</span>, <span class="selectable-content" id="_s_391">[<b>assignment</b>: 
     <span class="assignable-content"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> for the supported name type</span>]</span>]
               matching rules</span></li><li style=""><span class="selectable-content" id="_s_392">pass the [<b>selection</b>: <span class="selectable-content" id="_s_393">validated certificate</span>, <span class="selectable-content" id="_s_394"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822 name normalized according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822</span>, <span class="selectable-content" id="_s_395"><abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name normalized according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span>, <span class="selectable-content" id="_s_396">[<b>assignment</b>: 
     <span class="assignable-content">list of <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280 name types and normalization rules</span>]</span>, <span class="selectable-content" id="_s_397">[<b>assignment</b>: 
     <span class="assignable-content">list of 'other' name types and standard normalization rules</span>]</span>] 
               to [<b>assignment</b>: 
     <span class="assignable-content">list of calling applications capable of making access decisions</span>]</span></li><li style=""><span class="selectable-content" id="_s_398">pass initial name constraints of type [<b>selection</b>: <span class="selectable-content" id="_s_399">directory name</span>, <span class="selectable-content" id="_s_400">rfc_822_name</span>, <span class="selectable-content" id="_s_401">dns_name</span>, <span class="selectable-content" id="_s_402">[<b>assignment</b>: 
     <span class="assignable-content">supported name types</span>]</span>]
               to the certification path processing function to verify, in accordance with <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>, that the presented identifier matches
               an expected client identifier</span></li><li style=""><span class="selectable-content" id="_s_403">associate a PSK to a specific reference identifier</span></li></ul>].
           <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
             <p>
             Authorization for services provided by the applications that are protected by the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session is determined by the supported
             function establishing a set of reference identifiers, by passing the received identifiers to the supported function, or by passing
             initial name constraints to the certification path validation function. 
             The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates the methods supported and, for each method supported, indicates all name types supported; if name types are
             processed by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>, at least one name type is required. 
             In the assignment of the first option, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates all name types and the corresponding method for matching in the sub-selections. 
             In the second method option, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates which name type normalizations the product supports. 
             If the product passes the entire validated certificate to the application, no normalization of the names contained in the certificate is expected. 
             If the third method is claimed, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates which name types are supported for formulating initial name constraints.
             </p>
             <p>
             If name normalization is claimed, care should be taken regarding wildcards and <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses. 
             <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses embedded in <abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> host names and in Directory Name <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> components have been observed to include non-standard wildcard designations including the ‘*’ character. 
             Any embedded <abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr> addresses should use standard CIDR notation and should not include nonstandard encoding. 
             </p>
           </span></div></div></div>
	  
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSS_EXT.2">FCS_TLSS_EXT.2</a></div>
	      
	      
	      
	    <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
	        <p>
	          The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> description required per <span class="no-link">FIA_X509_EXT.2.1</span> includes the use of client-side certificates for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> mutual authentication, 
	        and that the description includes any certificate validation exception rules and the name types supported for matching to reference identifiers for all applications that use <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>. 
	        The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure that any <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr>-embedded name types that are used include a description of the encoding and matching rules.</p><p>
	          The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> includes a description of each response option claimed in <a href="#FCS_TLSS_EXT.2.3">FCS_TLSS_EXT.2.3</a>, to include the supporting functions using the option, and the behavior of functions exercising a non-authenticated option or exception processing (if claimed).
	        </p>
	      </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
	        <p>
	          The evaluator shall verify that the operational guidance includes instructions for configuring trust stores for client-side certificates used in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> mutual authentication. 
	        The evaluator shall ensure that the operational guidance includes instructions for configuring the server to require mutual authentication of clients using these certificates and for configuring any certificate validation exception rules. 
	        The evaluator shall ensure that the operational guidance includes instructions for configuring reference identifiers normalized or matched by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and matching rules for the supported name types.
	        </p>
	      </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
	        The evaluator shall use <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a function to verify that the validation rules in <span class="no-link">FIA_X509_EXT.1</span> are adhered to and shall perform the tests listed below in conjunction with testing for <span class="no-link">FIA_X509_EXT.1</span>. 
	        The evaluator shall apply the operational guidance to configure the server to require <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> mutual authentication of clients for these tests unless overridden by instructions in the test activity.
	        <p>
	          <b>Note:</b> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is a fundamentally different protocol than <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, so even though the certificate validation and name checking tests are identical for both versions, it is likely that early deployments of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 may use a different code-base that warrants independent testing. If both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 are supported and the evaluator can verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> uses the same code-base for certificate validation and name checking for both <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 and <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, it is acceptable that testing be performed for only one version for these tests.
	        </p>
	        <span class="testlist-"><ul>
	          <li class="test-"><a id="_t_246" class="defined" href="#_t_246">Test FCS_TLSS_EXT.2:1</a>:
      
	            For each supported version, the evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to require valid client authentication with no exceptions in support of a function (configured, as necessary) that does not allow unauthenticated sessions, and initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session from a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> test client 
	            supporting that version. The evaluator shall ensure that the test client sends a certificate_list structure which has a length of zero. The evaluator shall verify the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session and no application data flows. 
	            <p>
	            <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure, bad certificate, unknown certificate, unknown <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>) in response to this, 
	            but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
	            </p>
	          </li>
	          <li class="test-"><a id="_t_247" class="defined" href="#_t_247">Test FCS_TLSS_EXT.2:2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> indicates that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports establishment of a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session for missing or invalid certificates, then for each supported version, 
	            and for each supported response option for a missing or invalid certificate indicated in <a href="#FCS_TLSS_EXT.2.3">FCS_TLSS_EXT.2.3</a>, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> according to the operational guidance 
	            to respond as indicated for the calling application. The evaluator shall send client handshake messages from a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client as indicated for each sub-test. The evaluator shall perform the following sub-tests:
	            <span class="testlist-"><ul>
	              <li class="test-"><a id="_t_248" class="defined" href="#_t_248">Test FCS_TLSS_EXT.2:2.1</a>:
      [conditional]: If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports non-authenticated session establishment when receiving an empty certificate message, 
	                the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake from a compliant test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client supporting the version and providing a certificate message 
	                containing a certificate_list structure of length zero. The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> notifies the calling application that the user is unauthenticated.
	                <p>
	                <b>Note:</b> Specific procedures for determining that the calling application is notified will vary based on the application. 
	                If an API to the calling application is not available, the evaluator may attempt to configure the calling application to provide a different response 
	                (e.g., require authentication for flagged data) for authenticated and non-authenticated users and make a request at the test client that results in a response 
	                indicating the application is treating the client as non-authenticated.
	                </p></li>
	              <li class="test-"><a id="_t_249" class="defined" href="#_t_249">Test FCS_TLSS_EXT.2:2.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports exceptions for when revocation status information is unavailable, 
	                then the evaluator shall follow the operational guidance to attempt to establish a narrowly defined exception for which both exempt and non-exempt certificates can be established. 
	                The evaluator shall establish a primary certificate chain for the test client that only exhibits the allowed exception 
	                and one or more alternate certificate chains for the test client that do not pass the exception rule, as necessary to test the boundaries of the exception rules. 
	                <p>
	                The evaluator shall follow the operational guidance to remove any cached revocation status information for the test client’s primary certificate chain. 
	                The evaluator shall initiate a valid <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session from the test client that presents the primary certificate for the test client, 
	                provide any feedback requested by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to confirm the exception, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> allows the certificate and completes the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake successfully. 
	                </p><p>
	                For each alternate certificate chain, the evaluator shall repeat the session initiation from the test client but present the alternate certificate chain and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
	                </p><p>
	                <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., bad certificate, unknown certificate, access denied, handshake error) in response to this, 
	                but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
	                </p><p>
	                The alternate certificate chains are intended to test the boundaries of the exception rules. 
	                For example, if the exception rule indicates that only leaf certificates are exempt, the evaluator shall include an alternate certificate chain for which a <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate’s revocation information is advertised but is not available; 
	                if the exception can be configured for an explicit leaf certificate, or particular subjects, an alternate chain will be included that does not include an excepted certificate or subject. 
	                If the exception rules can be configured for all certificates having advertised revocation information, an alternate certificate chain can include an expired certificate – only one additional validity failure 
	                (e.g., expired certificate) is required in this case. More comprehensive validity failure handling is addressed by testing for <span class="no-link">FIA_X509_EXT.1</span>.
	                </p></li>
	            </ul></span>
	            </li>
	          <li class="test-"><a id="_t_250" class="defined" href="#_t_250">Test FCS_TLSS_EXT.2:3</a>:
      For each supported version, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to negotiate the version and require client authentication and perform the following steps: <ul>
	            <li>For each supported name matching method indicated in <a href="#FCS_TLSS_EXT.2.4">FCS_TLSS_EXT.2.4</a>, and for each name type supported by the matching method,
	              the evaluator shall establish a valid primary certificate chain with a leaf certificate containing a single name of the supported type matching a reference ID and a valid alternate certificate chain with a leaf certificate containing a single name indicating a different name of the same type not matching a reference ID. </li>
	            <li>[conditional] If any of the supported name types include <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> encoding of a name type also supported as a <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> entry, the evaluator shall 
	              
	              establish additional certificate chains:
	              <ul>
	                <li>The evaluator shall establish a primary certificate chain with multiple names, to include a leaf certificate with: 
	                <ul>
	                  <li>a <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> entry that matches the name in the primary certificate chain with single names, of the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name type; and </li>
	                  <li>a <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> entry encoding the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> type which matches the name in the alternate certificate chain with single names of the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> encoding of the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name type;</li>
	                </ul></li>
	                <li>The evaluator shall establish an alternate certificate chain with multiple names, to include a leaf certificate with:
	                <ul>
	                  <li>a <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> entry that matches the name in the alternate certificate chain with single names, of the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name type; and</li> 
	                  <li>a <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> entry encoding the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> type which matches the name in the primary certificate chain with single names, of the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> encoding of the same <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> name type.</li>
	                </ul></li>
	              </ul></li>
	            <li>[conditional] If any of the supported name types include <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> encoding, the evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>, 
	              establishing trust in the root <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> for all primary and alternate certificate chains. 
	              The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and any relevant <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> applications that use <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> for client authentication as necessary to establish reference identifiers that match the names in the client’s primary certificate chains 
	              with single names, but not matching any of the names in the alternate certificate chains with single names.</li>
	            <li>For each primary certificate chain (with single or multiple names), the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session from the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client that is configured to present the primary certificate chain 
	              in a certificate message and a valid certificate verify message in response to the server’s certificate request message. 
	              The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> accepts the certificate and completes the authenticated <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session successfully.</li>
	            <li>For each alternate certificate chain (with single or multiple names), the evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session from the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client that is configured 
	              to present the alternate certificate chain in a certificate message and a valid certificate verify message in response to the server’s certificate request message. 
	              The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.</li>
	          </ul>
	            <p>
	            <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., access denied) in response to this, 
	            but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
	            </p><p>
	            The intent of this test is to confirm that for each method that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> uses to match name types presented in validated certificates, 
	            it is able to recognize both matching and non-matching names. 
	            Names of special types implicitly encoded in the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> entry of the certificate subject name are especially prone to error since they may only be validated 
	            by the issuing <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> as a directory name (RDN) type, especially if the issuing <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> is unaware of the intended encoding as a different name type. 
	            It is a best practice that when the <abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr> is interpreted as an embedded name type other than RDN, an explicitly encoded <abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr> entry should take precedence.
	            </p>
	          <p>
	            <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 certificate requests from the test server and client certificate and certificate verify messages are encrypted. The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends the appropriate messages by examining the messages received at the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 server and by inspecting any relevant server logs. The evaluator may also take advantage of the calling application to demonstrate that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> receives data configured at the test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server.
	          </p>
	          </li>
	        </ul></span>
	      </div></div></div></div></div>
 
        <div class="comp" id="FCS_TLSS_EXT.3"><h4>FCS_TLSS_EXT.3 TLS Server Downgrade Protection</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLSS_EXT.1.1">FCS_TLSS_EXT.1.1</a>.
      </i></b></div>
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.3.1"><a href="#FCS_TLSS_EXT.3.1" class="abbr">FCS_TLSS_EXT.3.1</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall set the ServerHello extension to a random value concatenated with the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator when negotiating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 as indicated in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, Section 4.1.3.
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "supplemental downgrade protection" is selected in <a href="#FCS_TLSS_EXT.1.1">FCS_TLSS_EXT.1.1</a>. 
              </p><p>
              <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 requires both the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator as well as an indicator for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 and below. 
              This <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> requires the server to reject attempts to establish <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 and below, making this mechanism redundant. 
              However, products may still implement both indicators to be compliant with the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr>. 
              </p>
	    </span></div></div></div>
	   
	<div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSS_EXT.3">FCS_TLSS_EXT.3</a></div>
        
        
	      
	    <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
          <p>
          The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and confirm that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> description includes details on the session downgrade protections that are supported.
          </p>
	</div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
        <p>
          The evaluator shall examine the operational guidance to confirm that instructions are included to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support only <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 and to provide the associated downgrade indications.
        </p>
	</div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
	        The evaluator shall follow the operational guidance as necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to negotiate only <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 and to provide the associated downgrade indications. 
	        The evaluator shall send a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ClientHello to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> that indicates support for only <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2. 
	        The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a ServerHello with the last eight bytes of the server random value equal to 44 4F 57 4E 47 52 44 01.
	      </div></div></div></div></div>

	<div class="comp" id="FCS_TLSS_EXT.4"><h4>FCS_TLSS_EXT.4 TLS Server Support for Renegotiation</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
      </i></b></div>
	  
	  
	  
	  
	  
	  
	  
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.4.1"><a href="#FCS_TLSS_EXT.4.1" class="abbr">FCS_TLSS_EXT.4.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support secure <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> renegotiation through the use of [<b>selection</b>: <span class="selectable-content" id="_s_404">the "renegotiation_info" <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extension in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746</span>, <span class="selectable-content" id="_s_405">not allowing session renegotiation</span>]. 
            </div></div>
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.4.2"><a href="#FCS_TLSS_EXT.4.2" class="abbr">FCS_TLSS_EXT.4.2</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall
              [<b>selection</b>: <span class="selectable-content" id="_s_406">indicate support for renegotiating a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 session by including the renegotiation_info extension in the server
                  hello message when a ClientHello with the renegotiation_info extension is received and shall terminate a session if
                  neither of the renegotiation_info or TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuites are indicated in the client
                  hello</span>, <span class="selectable-content" id="_s_407">not allow renegotiation</span>].
            </div></div>
	  <div class="element"><div class="reqid" id="FCS_TLSS_EXT.4.3"><a href="#FCS_TLSS_EXT.4.3" class="abbr">FCS_TLSS_EXT.4.3</a></div><div class="reqdesc">
	      The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall terminate the session if an unexpected ClientHello is received during an active <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session.
	    <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
              This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "<abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a server" is selected in <a href="#FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</a>.
              </p>
              <p>
              If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author claims either method of protecting against insecure renegotiation attempts. The first
              selection refines <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746. <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 defines an extension to <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 that binds renegotiation handshakes to the cryptography in
              the original handshake, but allows interoperability with clients that do not follow <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746. 
              As a refinement of the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr>, servers that support <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 renegotiation will terminate a session if neither of the methods
              described in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 are offered by the client.               
              Alternatively, a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server supporting <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 may negotiate <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 without any <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 client renegotiation indicators 
              if it always terminates an existing session when a new ClientHello is received, similar to the implementation of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3. 
              </p>
              <p>
              If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author must claim "does not allow renegotiation."
              <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 does not allow renegotiation. Termination, as indicated in <a href="#FCS_TLSS_EXT.4.3">FCS_TLSS_EXT.4.3</a>, covers <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 sessions as well as <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2
              sessions where the ClientHello received does not comply with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746, or when configured to reject renegotiation (if the
              product is configurable).
              </p>
	    </span></div></div></div>
	
	<div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSS_EXT.4">FCS_TLSS_EXT.4</a></div>
	      
	      
	      
	    <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
	        <p>
	        The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to confirm that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> description includes details on session renegotiation protection methods supported, 
	        to include when renegotiation is prohibited.
	        </p>
	      </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
	        <p>
	        The evaluator shall examine the operational guidance to confirm that any instructions that are needed to meet the requirements are included. 
	        If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, and the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is configurable to use <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 methods or to deny renegotiation, 
	        the evaluator shall ensure that the operational guidance includes instructions for configuring the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> in this manner.
	        </p>
	      </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
	        The evaluator shall perform the following tests, as indicated based on supported secure renegotiation methods. The conditions: ‘support for renegotiation’, ‘allowing renegotiation,’ or ‘supporting <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 methods’ imply that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2. <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 does not allow renegotiation. For each test, the evaluator shall use a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client able to construct the indicated messages and expose messages received from the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>.
	        <span class="testlist-"><ul>
	          <li class="test-"><a id="_t_251" class="defined" href="#_t_251">Test FCS_TLSS_EXT.4:1</a>:
      (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 initial handshake) [conditional] 
	            If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports renegotiation, the evaluator shall follow the operational guidance as necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to enforce <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 methods. 
	            The evaluator shall initiate a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 session from a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client for each of the following sub-tests:
	            <span class="testlist-"><ul>
	              <li class="test-"><a id="_t_252" class="defined" href="#_t_252">Test FCS_TLSS_EXT.4:1.1</a>:
      The evaluator shall send an initial ClientHello without the renegotiation_info extension and without including the signaling ciphersuite value, TLS_EMPTY_RENEGOTIATION_INFO_SCSV. 
	                The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
	                <p>
	                <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure) in response to this, 
	                but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
	                </p>
	              </li>
	              <li class="test-"><a id="_t_253" class="defined" href="#_t_253">Test FCS_TLSS_EXT.4:1.2</a>:
      
	                The evaluator shall send an initial ClientHello with the renegotiation_info extension indicating a renegotiated_connection length greater than zero. The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session. 
	                <p>
	                <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure) in response to this, 
	                but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
	                </p>
	              </li>
	            </ul></span>
	            </li>
	          <li class="test-"><a id="_t_254" class="defined" href="#_t_254">Test FCS_TLSS_EXT.4:2</a>:
      
	            (renegotiation attempt) For each of the following sub-tests, the evaluator shall establish a compliant <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel with an initial handshake that uses the indicated secure renegotiation method for the version indicated. 
	            Without closing the session, the evaluator shall send a second ClientHello within the channel specific to the version as indicated:
	            <span class="testlist-"><ul>
	              <li class="test-"><a id="_t_255" class="defined" href="#_t_255">Test FCS_TLSS_EXT.4:2.1</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> allows renegotiation, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746 methods, 
	                send an initial handshake with a valid renegotiation extension, 
	                send a new <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ClientHello on the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 channel containing the renegotiation_info extension indicating valid client_verify_data, and observe the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully completes the handshake.</li>
	              <li class="test-"><a id="_t_256" class="defined" href="#_t_256">Test FCS_TLSS_EXT.4:2.2</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> allows renegotiation, the evaluator shall send an initial ClientHello containing a valid renegotiation extension, 
	                 send a new <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ClientHello on the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 channel with the signaling ciphersuite value, TLS_ EMPTY_RENEGOTIATION_INFO_SCSV, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
	                <p>
	                <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., handshake failure) in response to this, 
	                but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
	                </p>
	              </li>
	              <li class="test-"><a id="_t_257" class="defined" href="#_t_257">Test FCS_TLSS_EXT.4:2.3</a>:
      [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> allows renegotiation, for each <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 renegotiation method claimed in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746, 
	                the evaluator shall send an initial ClientHello indicating the method, send a new <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ClientHello on the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 channel without a renegotiation_info extension, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
	                <p>
	                <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., unexpected message) in response to this, 
	                but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
	                </p>
	              </li>
	              <li class="test-"><a id="_t_258" class="defined" href="#_t_258">Test FCS_TLSS_EXT.4:2.4</a>:
      [conditional]: If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> allows renegotiation, for each <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 renegotiation method claimed in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746, 
	                the evaluator shall send an initial ClientHello indicating the method, 
	                send a new <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 ClientHello on the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 channel with a renegotiation_info extension indicating an invalid client_verify_data value (modify a byte of a valid value), and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
	                <p>
	                <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., unexpected message) in response to this, 
	                but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
	                </p></li>
	              <li class="test-"><a id="_t_259" class="defined" href="#_t_259">Test FCS_TLSS_EXT.4:2.5</a>:
      [conditional]  If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> rejects renegotiation for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, the evaluator shall follow the operational guidance as necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to reject renegotiation. The evaluator shall initiate a valid initial session, send a valid ClientHello on the non-renegotiable <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not perform renegotiation of the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel.
	              </li>
	              <li class="test-"><a id="_t_260" class="defined" href="#_t_260">Test FCS_TLSS_EXT.4:2.6</a>:
      
	                [conditional]  If the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the evaluator shall follow the operational guidance as necessary to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to negotiate the version. The evaluator shall initiate a valid initial session for the specified version, send a valid ClientHello on the non-renegotiable <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the session.
	                <p>
	                <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., unexpected message) in response to this, 
	                but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert).
	                </p></li>
	            </ul></span>
	            </li>
	        </ul></span>
	      </div></div></div></div></div>
        
        
        <div class="comp" id="FCS_TLSS_EXT.5"><h4>FCS_TLSS_EXT.5 TLS Server Support for Session Resumption</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLSS_EXT.1.1">FCS_TLSS_EXT.1.1</a>.
      </i></b></div>
           
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.5.1"><a href="#FCS_TLSS_EXT.5.1" class="abbr">FCS_TLSS_EXT.5.1</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support session resumption as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server via the use of [<b>selection</b>: <span class="selectable-content" id="_s_408">session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246</span>, <span class="selectable-content" id="_s_409">tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077</span>, <span class="selectable-content" id="tlss_v13_resumption">PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span>]. 
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
              This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if "session resumption" is selected in <a href="#FCS_TLSS_EXT.1.1">FCS_TLSS_EXT.1.1</a>.
              </p><p>
              The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author indicates which session resumption mechanisms are supported. 
              If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 is supported, one or both of the first two options, "session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246" and "tickets in
              accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077" are claimed. 
              If <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported, "PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446" is selected, and the selection-based <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> <a href="#FCS_TLSS_EXT.6">FCS_TLSS_EXT.6</a> must also be claimed.
              </p><p>
              While it is possible to perform session resumption using PSK ciphersuites in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, this is uncommon. 
              Validation of key exchange and session negotiation rules for PSK ciphersuites is independent of the source of the pre-shared key and is covered in <a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a>.
              </p>
            </span></div></div></div>
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSS_EXT.5">FCS_TLSS_EXT.5</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and confirm that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server protocol description includes a description of the supported resumption mechanisms.
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                The evaluator shall ensure the operational guidance describes instructions for any configurable features of the resumption mechanism.
                </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall perform the following tests:
                <span class="testlist-"><ul>
                  <li class="test-"><a id="tls-server-successful-resumption" class="defined" href="#tls-server-successful-resumption">Test FCS_TLSS_EXT.5:1</a>:
      For each supported version, and for each supported resumption method for that version, 
                    the evaluator shall establish a compliant initial <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session with the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> for the version using the specified method. 
                    The evaluator shall close the successful session and initiate resumption using the specified mechanism. 
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> successfully establishes the resumed session in accordance with the requirements. </li>
                  <li class="test-"><a id="_t_262" class="defined" href="#_t_262">Test FCS_TLSS_EXT.5:2</a>:
      For each supported version and each supported resumption method for that version, 
                    the evaluator shall send a compliant ClientHello message supporting only the specific version and indicating support for the resumption method. 
                    The evaluator shall allow the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and test client to continue with the compliant handshake until resumption information is established but then cause a fatal error to terminate the session. 
                    The evaluator shall then send a new ClientHello in an attempt to resume the session with the resumption information provided 
                    and verify that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not resume the session, but instead either terminates the session or completes a full handshake, ignoring the resumption information.
                    <p>
                    <b>Note:</b> For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2, resumption information should be established at the point the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a ServerHello, either acknowledging the session-based resumption 
                    or acknowledging support for ticket-based resumption and sending a new_ticket message. 
                    A <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 session can then be terminated by sending a modified finished message. 
                    For <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, the new_ticket message is sent after the finished message; once received by the client, the session can be terminated by modifying a byte of the encrypted application data. 
                    </p>
                  </li>
                </ul></span>
              </div></div></div></div></div>
        
        
        <div class="comp" id="FCS_TLSS_EXT.6"><h4>FCS_TLSS_EXT.6 TLS Server TLS 1.3 Resumption Refinements</h4><div class="statustag"><b><i>This is a selection-based component. Its inclusion depends upon selection from
	  <a href="#FCS_TLSS_EXT.5.1">FCS_TLSS_EXT.5.1</a>.
      </i></b></div>
           
          
          
          
          
          
          
          
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.6.1"><a href="#FCS_TLSS_EXT.6.1" class="abbr">FCS_TLSS_EXT.6.1</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 resumption using PSK with psk_key_exchange_modes extension with the value psk_dhe_ke.  
            </div></div>
          <div class="element"><div class="reqid" id="FCS_TLSS_EXT.6.2"><a href="#FCS_TLSS_EXT.6.2" class="abbr">FCS_TLSS_EXT.6.2</a></div><div class="reqdesc">
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall ignore early data received in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 sessions.
            <div class="appnote"><span class="note-header">Application
      Note:
    </span><span class="note">
              <p>
                This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> is claimed if <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 is supported and "PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446" is selected in <a href="#FCS_TLSS_EXT.5.1">FCS_TLSS_EXT.5.1</a>.
              </p><p>
              <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446 allows pre-shared keys to be used directly 
              and also allows early data to be protected using only the pre-shared key. This <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> refines the <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> to use PSK only with a supplemental <abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr> key exchange to ensure perfect forward secrecy for all sessions.
              </p>
            </span></div></div></div>  
          
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_TLSS_EXT.6">FCS_TLSS_EXT.6</a></div>
              
              
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="ea"><div class="ea">
                <p>
                The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to confirm that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> description includes details on session resumption for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3, 
                describes each application capable of using <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 with PSK, and describes how the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and application respond to client attempts to use early data (including via logging or observable responses). 
                The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> description shows that only the psk_dhe_ke psk_key_exchange_modes is supported and that early information is ignored. 
                </p>
              </div></div><div class="eacategory">Guidance</div><div class="ea"><div class="ea">
                <p>
                The evaluator shall examine the operational guidance to verify that instructions for any configurable features that are required to meet the requirement are included. 
                </p>
              </div></div><div class="eacategory">Tests</div><div class="ea"><div class="ea">
                The evaluator shall follow the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to negotiate <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 and shall perform the following tests:
                <span class="testlist-"><ul>
                  
                  <li class="test-"><a id="_t_263" class="defined" href="#_t_263">Test FCS_TLSS_EXT.6:1</a>:
      The evaluator shall attempt a resumed session (see <a href="#FCS_TLSS_EXT.5">FCS_TLSS_EXT.5</a> <a href="#tls-server-successful-resumption" class="dynref">Test FCS_TLSS_EXT.5:1</a>) but using psk_ke mode as the value for the psk_key_exchange_modes extension in the resumption ClientHello. 
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> refuses to resume the session, either by completing a full <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 handshake or by terminating the session.
                    <p>
                    <b>Note:</b> It is preferred that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> sends a fatal error alert message (e.g., illegal parameter) in response to this, 
                    but it is acceptable that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> terminates the connection silently (i.e., without sending a fatal error alert). 
                    </p>
                  </li>
                  
                  <li class="test-"><a id="_t_264" class="defined" href="#_t_264">Test FCS_TLSS_EXT.6:2</a>:
      
                    The evaluator shall establish a valid <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 session with the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and send the data as application data after the finished messages have been verified, 
                    and observe the response. The evaluator shall then configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to clear the response and initiate a resumed session
                    (see <a href="#FCS_TLSS_EXT.5">FCS_TLSS_EXT.5</a> <a href="#tls-server-successful-resumption" class="dynref">Test FCS_TLSS_EXT.5:1</a>) with a test <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 client attempting to provide
                    the same data in early data. 
                    The evaluator shall observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> does not react to the early data as it did when presented as application data 
                    after the finished messages, indicating that the data was ignored.
                    <p>
                    <b>Note:</b> The specific early data used may depend on the applications calling the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session and should be selected to initiate an observable response in the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> or calling application as described in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>. 
                    For HTTPS, for example, the early data can be an <abbr class="dyn-abbr"><a href="#abbr_HTTP">HTTP</a></abbr> POST that updates data at the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>, which can then be observed via a user interface for the application if the data was 
                    posted or via application logging indicating that the operation failed.
                    </p>
                  </li>
                </ul></span>
              </div></div></div></div></div>
 
        
        
      

  <h1 id="impl-reqs" class="indexable" data-level="A">Appendix A -  Implementation-dependent Requirements</h1>
                Implementation-dependent Requirements 
		Appendix <a href="#feat-based-reqs" class="dynref"></a> defines requirements that must be claimed in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>  
		if the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements particular product features. 
		For this technology type, the following product features require the claiming of additional <abbr class="dyn-abbr"><a href="#abbr_SFR">SFRs</a></abbr>:
  <h1 id="ext-comp-defs" class="indexable" data-level="A">Appendix B -  Extended Component Definitions</h1>
	This appendix contains the definitions for all extended requirements specified in the Functional Package.

    <h2 id="ext-comp-defs-bg" class="indexable" data-level="2">B.1 Extended Components Table</h2>

	All extended components specified in the Functional Package are listed in this table:

<table class="sort_kids_"><caption data-sortkey="#0"><b><span class="ctr" data-myid="" data-counter-type="ct-Table" id="">Table <span class="counter">2</span></span>: Extended Component Definitions</b></caption><tr data-sortkey="#1"><th>Functional Class</th><th>Functional Components</th></tr><tr data-sortkey="Cryptographic Support (FCS)"><td>Cryptographic Support (FCS)</td><td>FCS_DTLSC_EXT <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Protocol<br/>FCS_DTLSS_EXT <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Protocol<br/>FCS_TLSC_EXT <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Protocol<br/>FCS_TLSS_EXT <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Protocol<br/>FCS_TLS_EXT <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Protocol<br/></td></tr></table><h2 id="ext-comp-defs-bg" class="indexable" data-level="2">B.2 Extended Component Definitions</h2><span class="sort_kids_"><span data-sortkey="Cryptographic Support (FCS)"><h3 id="ext-comp-FCS" class="indexable" data-level="3">B.2.1 Cryptographic Support (FCS)</h3>This Functional Package defines the following extended components as part of the
	 FCS class originally defined by <abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr> Part 2:
	<h3 id="ext-comp-FCS_TLS_EXT" class="indexable" data-level="4">B.2.1.1 FCS_TLS_EXT TLS Protocol</h3><div style="margin-left: 1em;"><h4>Family Behavior</h4><div>This family defines the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> claims that can be made by a conformant <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>.</div><h4>Component Leveling</h4><svg style="max-height: 30px;"><text x="4" fill="black" font-size="15" y="24">FCS_TLS_EXT</text><rect x="2" y="11" width="150" height="16" fill="none" stroke="black"></rect><text x="234" fill="black" font-size="15" y="24">1</text><rect x="232" y="11" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="17" x2="231" y2="17" stroke="black"></line></svg><p><a href="#FCS_TLS_EXT.1">FCS_TLS_EXT.1</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Protocol,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to specify whether it implements <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a client or as a server.
          </p><h4>Management: FCS_TLS_EXT.1</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLS_EXT.1</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_TLS_EXT.1 TLS Protocol</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td>No dependencies.
          </td></tr></table><h4 id="ext-comp-FCS_TLS_EXT.1.1">FCS_TLS_EXT.1.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement
        [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="tlsc_impl"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a client</span></li><li style=""><span class="selectable-content" id="tlss_impl"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a server</span></li><li style=""><span class="selectable-content" id="dtlsc_impl"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a client</span></li><li style=""><span class="selectable-content" id="dtlss_impl"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a server</span></li></ul>].
        </div></div><h3 id="ext-comp-FCS_DTLSC_EXT" class="indexable" data-level="4">B.2.1.2 FCS_DTLSC_EXT DTLS Client Protocol</h3><div style="margin-left: 1em;"><h4>Family Behavior</h4><div>This family defines requirements for implementation of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a client.</div><h4>Component Leveling</h4><svg style="max-height: 130px;"><text x="4" fill="black" font-size="15" y="84">FCS_DTLSC_EXT</text><rect x="2" y="71" width="150" height="16" fill="none" stroke="black"></rect><text x="234" fill="black" font-size="15" y="24">1</text><rect x="232" y="11" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="17" stroke="black"></line><text x="234" fill="black" font-size="15" y="44">2</text><rect x="232" y="31" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="37" stroke="black"></line><text x="234" fill="black" font-size="15" y="64">3</text><rect x="232" y="51" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="57" stroke="black"></line><text x="234" fill="black" font-size="15" y="84">4</text><rect x="232" y="71" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="77" stroke="black"></line><text x="234" fill="black" font-size="15" y="104">5</text><rect x="232" y="91" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="97" stroke="black"></line><text x="234" fill="black" font-size="15" y="124">6</text><rect x="232" y="111" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="117" stroke="black"></line></svg><p><a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Protocol,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to implement <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a client in the specified manner.
    </p><p><a href="#FCS_DTLSC_EXT.2">FCS_DTLSC_EXT.2</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Support for Mutual Authentication,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support mutually-authenticated <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> when acting as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client.
    </p><p><a href="#FCS_DTLSC_EXT.3">FCS_DTLSC_EXT.3</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Downgrade Protection,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to implement version downgrade protection when acting as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client.
          </p><p><a href="#FCS_DTLSC_EXT.4">FCS_DTLSC_EXT.4</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Support for Renegotiation,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session renegotiation when acting as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client.
          </p><p><a href="#FCS_DTLSC_EXT.5">FCS_DTLSC_EXT.5</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Support for Session Resumption,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session resumption when acting as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client.
          </p><p><a href="#FCS_DTLSC_EXT.6">FCS_DTLSC_EXT.6</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 Resumption Refinements,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session resumption behavior specific to <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 when acting as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client.
          </p><h4>Management: FCS_DTLSC_EXT.1</h4><p>No specific management functions are identified.
    </p><h4>Audit: FCS_DTLSC_EXT.1</h4><p>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the
      <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>, functional package, or <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>:<ul>
        <li>Establishment and termination of a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session</li>
        <li>Failure to establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session</li>
        <li>Failure to verify presented identifier</li>
      </ul>
    </p><h4>FCS_DTLSC_EXT.1 DTLS Client Protocol</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td>
      <a href="#FCS_CKM.1">FCS_CKM.1</a> Cryptographic Key Generation<br/>
      <a href="#FCS_CKM.2">FCS_CKM.2</a> Cryptographic Key Distribution<br/>
      <a href="#FCS_COP.1">FCS_COP.1</a> Cryptographic Operation<br/>
      <a href="#FCS_RBG.1">FCS_RBG.1</a> Random Bit Generation (RBG)<br/>
      <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> X.509 Certificate Validation<br/>
      <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a> X.509 Certificate Authentication
    </td></tr></table><h4 id="ext-comp-FCS_DTLSC_EXT.1.1">FCS_DTLSC_EXT.1.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement
      [<b>selection</b>: <span class="selectable-content" id="_s_5"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6347)</span>, <span class="selectable-content" id="_s_6"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147)</span>] as a client that supports additional functionality for session renegotiation protection and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="dtlsc_mutual_auth">mutual authentication</span></li><li style=""><span class="selectable-content" id="dtlsc_downgrade_protection">supplemental downgrade protection</span></li><li style=""><span class="selectable-content" id="dtlsc_resumption">session resumption</span></li><li style=""><span class="selectable-content" id="_s_10">no optional functionality</span></li></ul>] and shall abort attempts by a server to negotiate all other <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> versions.
      <h4 id="ext-comp-FCS_DTLSC_EXT.1.2">FCS_DTLSC_EXT.1.2</h4>
          The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following
            [<b>assignment</b>: 
     <span class="assignable-content">list of supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ciphersuites</span>],
          offering the supported ciphersuites in a ClientHello message in preference order: 
          [<b>assignment</b>: 
     <span class="assignable-content">list of supported ciphersuites</span>].
        <h4 id="ext-comp-FCS_DTLSC_EXT.1.3">FCS_DTLSC_EXT.1.3</h4>
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not offer ClientHello messages indicating the following: 
        <ul>
          <li>null encryption</li>
          <li>support for anonymous servers</li>
          <li>use of deprecated or export-grade cryptography including DES, 3DES, RC2, RC4, or IDEA for encryption</li>
          <li>use of MD-5 or <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr>-1 for key derivation.</li>
        </ul> and shall abort sessions where a server attempts to negotiate cryptographic options not enumerated in the ClientHello
        message.
      <h4 id="ext-comp-FCS_DTLSC_EXT.1.4">FCS_DTLSC_EXT.1.4</h4>
            The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ClientHello message extensions: 
            <ul>
              <li>signature_algorithms extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for 
                [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_52">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_53">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_54">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_55">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_56">no other signature algorithms</span></li></ul>] and
              </li>
                [<b>assignment</b>: 
     <span class="assignable-content">other supported <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> extensions</span>]<br/>
                and shall not send the following extensions: <ul>
                  <li>early_data</li>
                  <li>psk_key_exchange_modes indicating PSK only mode.</li>
                </ul>
            </ul>
            
        <h4 id="ext-comp-FCS_DTLSC_EXT.1.5">FCS_DTLSC_EXT.1.5</h4>
          The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_68">verify that a presented identifier of name type: 
            [<b>assignment</b>: 
     <span class="assignable-content">supported name types</span>]</span></li><li style=""><span class="selectable-content" id="_s_69">interface with a supported function requesting the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel to verify that a presented identifier</span></li><li style=""><span class="selectable-content" id="_s_70">pass initial name constraints to the certification path processing function to verify, in accordance with
              <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>, that the presented identifier</span></li></ul>] 
          matches a reference identifier for the requested <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server and shall abort the session if no match is found.
        <h4 id="ext-comp-FCS_DTLSC_EXT.1.6">FCS_DTLSC_EXT.1.6</h4>
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a trusted channel if the server certificate is invalid [<b>selection</b>: <span class="selectable-content" id="s-dtlsc-no-excep">with no <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>-specific exceptions</span>, <span class="selectable-content" id="_s_72">except when override is authorized in accordance with [<b>assignment</b>: 
     <span class="assignable-content">override rules</span>]in the case where valid revocation information is not available</span>]. 
      <h4 id="ext-comp-FCS_DTLSC_EXT.1.7">FCS_DTLSC_EXT.1.7</h4>
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall [<b>selection</b>: <span class="selectable-content" id="_s_73">terminate the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session</span>, <span class="selectable-content" id="_s_74">silently discard the record</span>]
        if a message received contains an invalid MAC or if decryption fails in the case of <abbr class="dyn-abbr"><a href="#abbr_GCM">GCM</a></abbr> and other AEAD ciphersuites.
      </div><h4>Management: FCS_DTLSC_EXT.2</h4><p>No specific management functions are identified.
    </p><h4>Audit: FCS_DTLSC_EXT.2</h4><p>There are no auditable events foreseen.
    </p><h4>FCS_DTLSC_EXT.2 DTLS Client Support for Mutual Authentication</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Protocol
    </td></tr></table><h4 id="ext-comp-FCS_DTLSC_EXT.2.1">FCS_DTLSC_EXT.2.1</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support mutual <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> authentication using X.509v3 certificates during the handshake and 
              [<b>selection</b>: <span class="selectable-content" id="_s_75">in support of post-handshake authentication requests</span>, <span class="selectable-content" id="_s_76">at no other time</span>], in accordance with [<b>selection</b>: <span class="selectable-content" id="_s_77"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, Section 7.4.4</span>, <span class="selectable-content" id="_s_78"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, Section 4.3.2</span>].
            </div><h4>Management: FCS_DTLSC_EXT.3</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_DTLSC_EXT.3</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_DTLSC_EXT.3 DTLS Client Downgrade Protection</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Protocol
          </td></tr></table><h4 id="ext-comp-FCS_DTLSC_EXT.3.1">FCS_DTLSC_EXT.3.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel if the ServerHello message includes a
              [<b>selection</b>: <span class="selectable-content" id="_s_79"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator</span>, <span class="selectable-content" id="_s_80"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade indicator</span>]
              in the server random field. </div><h4>Management: FCS_DTLSC_EXT.4</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_DTLSC_EXT.4</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_DTLSC_EXT.4 DTLS Client Support for Renegotiation</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Protocol
          </td></tr></table><h4 id="ext-comp-FCS_DTLSC_EXT.4.1">FCS_DTLSC_EXT.4.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support secure <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> renegotiation through use of [<b>selection</b>: <span class="selectable-content" id="_s_81">the “renegotiation_info” <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extension in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746</span>, <span class="selectable-content" id="_s_82">the TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuite signaling value in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746</span>, <span class="selectable-content" id="_s_83">rejection of all renegotiation attempts</span>]
              and shall
              [<b>selection</b>: <span class="selectable-content" id="_s_84">terminate the session</span>, <span class="selectable-content" id="_s_85">discard the message</span>]
              if an unexpected ServerHello is received or
              [<b>selection</b>: <span class="selectable-content" id="_s_86">hello request message is received</span>, <span class="selectable-content" id="_s_87">in no other case</span>].
            </div><h4>Management: FCS_DTLSC_EXT.5</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_DTLSC_EXT.5</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_DTLSC_EXT.5 DTLS Client Support for Session Resumption</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Protocol
          </td></tr></table><h4 id="ext-comp-FCS_DTLSC_EXT.5.1">FCS_DTLSC_EXT.5.1</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support session resumption as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client via the use of [<b>selection</b>: <span class="selectable-content" id="_s_88">session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246</span>, <span class="selectable-content" id="_s_89">tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077</span>, <span class="selectable-content" id="dtlsc_v13_resumption">PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span>]. 
            </div><h4>Management: FCS_DTLSC_EXT.6</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_DTLSC_EXT.6</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_DTLSC_EXT.6 DTLS Client DTLS 1.3 Resumption Refinements</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_DTLSC_EXT.1">FCS_DTLSC_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Protocol<br/>
            <a href="#FCS_DTLSC_EXT.5">FCS_DTLSC_EXT.5</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Client Support for Session Resumption
          </td></tr></table><h4 id="ext-comp-FCS_DTLSC_EXT.6.1">FCS_DTLSC_EXT.6.1</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall send a psk_key_exchange_modes extension with value psk_dhe_ke when <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 session resumption is offered. 
            <h4 id="ext-comp-FCS_DTLSC_EXT.6.2">FCS_DTLSC_EXT.6.2</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not send early data in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 sessions. 
            </div></div><h3 id="ext-comp-FCS_DTLSS_EXT" class="indexable" data-level="4">B.2.1.3 FCS_DTLSS_EXT DTLS Server Protocol</h3><div style="margin-left: 1em;"><h4>Family Behavior</h4><div>This family defines requirements for implementation of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a server.</div><h4>Component Leveling</h4><svg style="max-height: 130px;"><text x="4" fill="black" font-size="15" y="84">FCS_DTLSS_EXT</text><rect x="2" y="71" width="150" height="16" fill="none" stroke="black"></rect><text x="234" fill="black" font-size="15" y="24">1</text><rect x="232" y="11" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="17" stroke="black"></line><text x="234" fill="black" font-size="15" y="44">2</text><rect x="232" y="31" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="37" stroke="black"></line><text x="234" fill="black" font-size="15" y="64">3</text><rect x="232" y="51" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="57" stroke="black"></line><text x="234" fill="black" font-size="15" y="84">4</text><rect x="232" y="71" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="77" stroke="black"></line><text x="234" fill="black" font-size="15" y="104">5</text><rect x="232" y="91" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="97" stroke="black"></line><text x="234" fill="black" font-size="15" y="124">6</text><rect x="232" y="111" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="117" stroke="black"></line></svg><p><a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Protocol,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to implement <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> as a server in the specified manner.
    </p><p><a href="#FCS_DTLSS_EXT.2">FCS_DTLSS_EXT.2</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Support for Mutual Authentication,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support mutually-authenticated <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> when acting as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server.
    </p><p><a href="#FCS_DTLSS_EXT.3">FCS_DTLSS_EXT.3</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Downgrade Protection,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to implement version downgrade protection when acting as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server.
          </p><p><a href="#FCS_DTLSS_EXT.4">FCS_DTLSS_EXT.4</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Support for Renegotiation,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session renegotiation when acting as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server.
          </p><p><a href="#FCS_DTLSS_EXT.5">FCS_DTLSS_EXT.5</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Support for Session Resumption,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session resumption when acting as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server.
          </p><p><a href="#FCS_DTLSS_EXT.6">FCS_DTLSS_EXT.6</a>,
             <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 Resumption Refinements,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session resumption behavior specific to <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 when acting as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server.
          </p><h4>Management: FCS_DTLSS_EXT.1</h4><p>No specific management functions are identified.
    </p><h4>Audit: FCS_DTLSS_EXT.1</h4><p>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the
      <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>, functional package, or <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>:<ul>
        <li>Failure to establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session</li>
      </ul>
    </p><h4>FCS_DTLSS_EXT.1 DTLS Server Protocol</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td>
      <a href="#FCS_CKM.1">FCS_CKM.1</a> Cryptographic Key Generation<br/>
      <a href="#FCS_CKM.2">FCS_CKM.2</a> Cryptographic Key Distribution<br/>
      <a href="#FCS_COP.1">FCS_COP.1</a> Cryptographic Operation<br/>
      <a href="#FCS_RBG.1">FCS_RBG.1</a> Random Bit Generation (RBG)<br/>
      <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> X.509 Certificate Validation<br/>
      <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a> X.509 Certificate Authentication
    </td></tr></table><h4 id="ext-comp-FCS_DTLSS_EXT.1.1">FCS_DTLSS_EXT.1.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement 
      [<b>selection</b>: <span class="selectable-content" id="_s_91"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6347)</span>, <span class="selectable-content" id="_s_92"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 9147)</span>] as a server that supports additional functionality for session renegotiation protection and
        [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="dtlss_mutual_auth">mutual authentication</span></li><li style=""><span class="selectable-content" id="dtlss_downgrade_protection">supplemental downgrade protection</span></li><li style=""><span class="selectable-content" id="dtlss_resumption">session resumption</span></li><li style=""><span class="selectable-content" id="_s_96">no optional functionality</span></li></ul>]
        and shall reject connection attempts from clients supporting only <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.0.
      <h4 id="ext-comp-FCS_DTLSS_EXT.1.2">FCS_DTLSS_EXT.1.2</h4>
          The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following
          [<b>assignment</b>: 
     <span class="assignable-content">list of supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ciphersuites</span>],
          offering the supported ciphersuites in a ClientHello message in preference order: 
          [<b>assignment</b>: 
     <span class="assignable-content">priority</span>].
        <h4 id="ext-comp-FCS_DTLSS_EXT.1.3">FCS_DTLSS_EXT.1.3</h4>
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a connection with a client that does not indicate support for at least one of the supported cryptographic
        parameter sets.
      <h4 id="ext-comp-FCS_DTLSS_EXT.1.4">FCS_DTLSS_EXT.1.4</h4>
          The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to process the following <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ClientHello message extensions: 
          <ul>
            <li>signature_algorithms extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for 
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_140">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_141">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_142">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_143">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_144">no other signature algorithms</span></li></ul>]
            </li>
          </ul>
            
              and the following other extensions: [<b>assignment</b>: 
     <span class="assignable-content">other supported <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> extensions</span>]
            
          
        <h4 id="ext-comp-FCS_DTLSS_EXT.1.5">FCS_DTLSS_EXT.1.5</h4>
          The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall perform key establishment for <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> using [<b>assignment</b>: 
     <span class="assignable-content">key establishment parameters</span>]. 
        <h4 id="ext-comp-FCS_DTLSS_EXT.1.6">FCS_DTLSS_EXT.1.6</h4>
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not proceed with a connection handshake attempt if the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> client fails validation.
      </div><h4>Management: FCS_DTLSS_EXT.2</h4><p>No specific management functions are identified.
    </p><h4>Audit: FCS_DTLSS_EXT.2</h4><p>There are no auditable events foreseen.
    </p><h4>FCS_DTLSS_EXT.2 DTLS Server Support for Mutual Authentication</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Protocol
    </td></tr></table><h4 id="ext-comp-FCS_DTLSS_EXT.2.1">FCS_DTLSS_EXT.2.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support authentication of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> clients using X.509v3 certificates during the <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> handshake and [<b>selection</b>: <span class="selectable-content" id="_s_160">during post-handshake requests</span>, <span class="selectable-content" id="_s_161">at no other time</span>] 
                using the certificate types indicated in the client’s signature_algorithms and [<b>selection</b>: <span class="selectable-content" id="_s_162">signature_algorithms_cert</span>, <span class="selectable-content" id="_s_163">no other</span>] extension.
            <h4 id="ext-comp-FCS_DTLSS_EXT.2.2">FCS_DTLSS_EXT.2.2</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support authentication of <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> clients using X.509v3 certificates in accordance with <span class="no-link">FIA_X509_EXT.1</span>.<h4 id="ext-comp-FCS_DTLSS_EXT.2.3">FCS_DTLSS_EXT.2.3</h4>
        The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to reject the establishment of a trusted channel if the requested client certificate is invalid and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_164">continue establishment of a server-only authenticated <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel in accordance with <a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a> in support of [<b>selection</b>: <span class="selectable-content" id="_s_165">all applications</span>, <span class="selectable-content" id="_s_166">[<b>assignment</b>: 
     <span class="assignable-content">list of calling applications that accept both authenticated and unauthenticated client sessions</span>]</span>] 
            when an empty certificate message is provided by the client</span></li><li style=""><span class="selectable-content" id="_s_167">continue establishment of a mutually authenticated <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> channel when revocation status information for the
            [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_168">client's leaf certificate</span></li><li style=""><span class="selectable-content" id="_s_169">[<b>assignment</b>: 
     <span class="assignable-content">specific intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificates</span>]</span></li><li style=""><span class="selectable-content" id="_s_170">any non-trust store certificate in the certificate chain</span></li></ul>]  
            is not available in support of
            [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_171">all applications</span></li><li style=""><span class="selectable-content" id="_s_172">[<b>assignment</b>: 
     <span class="assignable-content">list of calling applications configurable to perform certificate status information bypass processing
              </span>]</span></li></ul>]
            as [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_173">configured by an administrator</span></li><li style=""><span class="selectable-content" id="_s_174">confirmed by the supported function user</span></li><li style=""><span class="selectable-content" id="_s_175">a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr>-specific default for [<b>assignment</b>: 
     <span class="assignable-content">subset of supported function</span>]</span></li></ul>]
          </span></li><li style=""><span class="selectable-content" id="_s_176">no other processing options for missing or invalid client certificates</span></li></ul>]. 
      <h4 id="ext-comp-FCS_DTLSS_EXT.2.4">FCS_DTLSS_EXT.2.4</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_177">not establish a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session if an entry of the Distinguished Name or a [<b>selection</b>: <span class="selectable-content" id="_s_178">rfc822_name</span>, <span class="selectable-content" id="_s_179">dns_name</span>, <span class="selectable-content" id="_s_180">[<b>assignment</b>: 
     <span class="assignable-content">supported name types</span>]</span>]
          in the Subject Alternate Name extension contained in the client certificate does not match one of the expected identifiers for the client in accordance with [<b>selection</b>: <span class="selectable-content" id="_s_181"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822</span>, <span class="selectable-content" id="_s_182"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span>, <span class="selectable-content" id="_s_183"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280</span>, <span class="selectable-content" id="_s_184">[<b>assignment</b>: 
     <span class="assignable-content"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> for the supported name type</span>]</span>]
          matching rules</span></li><li style=""><span class="selectable-content" id="_s_185">pass the [<b>selection</b>: <span class="selectable-content" id="_s_186">validated certificate</span>, <span class="selectable-content" id="_s_187"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822 name normalized according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822</span>, <span class="selectable-content" id="_s_188"><abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name normalized according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span>, <span class="selectable-content" id="_s_189">[<b>assignment</b>: 
     <span class="assignable-content">list of <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280 name types and normalization rules</span>]</span>, <span class="selectable-content" id="_s_190">[<b>assignment</b>: 
     <span class="assignable-content">list of 'other' name types and standard normalization rules</span>]</span>] 
          to [<b>assignment</b>: 
     <span class="assignable-content">list of calling applications capable of making access decisions</span>]</span></li><li style=""><span class="selectable-content" id="_s_191">pass initial name constraints of type [<b>selection</b>: <span class="selectable-content" id="_s_192">directory name</span>, <span class="selectable-content" id="_s_193">rfc_822_name</span>, <span class="selectable-content" id="_s_194">dns_name</span>, <span class="selectable-content" id="_s_195">[<b>assignment</b>: 
     <span class="assignable-content">supported name types</span>]</span>]
          to the certification path processing function to verify, in accordance with <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>, that the presented identifier matches an
          expected client identifier
        </span></li></ul>].     
      </div><h4>Management: FCS_DTLSS_EXT.3</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_DTLSS_EXT.3</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_DTLSS_EXT.3 DTLS Server Downgrade Protection</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Protocol
          </td></tr></table><h4 id="ext-comp-FCS_DTLSS_EXT.3.1">FCS_DTLSS_EXT.3.1</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall set the ServerHello extension to a random value concatenated with the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator when
              negotiating <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 as indicated in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, Section 4.1.3.
            </div><h4>Management: FCS_DTLSS_EXT.4</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_DTLSS_EXT.4</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_DTLSS_EXT.4 DTLS Server Support for Renegotiation</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Protocol
          </td></tr></table><h4 id="ext-comp-FCS_DTLSS_EXT.4.1">FCS_DTLSS_EXT.4.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support secure <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> renegotiation through the use of [<b>selection</b>: <span class="selectable-content" id="_s_196">the "renegotiation_info" <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extension in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746</span>, <span class="selectable-content" id="_s_197">not allowing session renegotiation</span>].
            <h4 id="ext-comp-FCS_DTLSS_EXT.4.2">FCS_DTLSS_EXT.4.2</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_198">indicate support for renegotiating a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 session by including the renegotiation_info extension in the ServerHello
                message and shall terminate a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.2 session if neither of the renegotiation_info or TLS_EMPTY_RENEGOTIATION_INFO_SCSV
                signaling ciphersuites are indicated in the ClientHello</span></li><li style=""><span class="selectable-content" id="_s_199">not allow renegotiation</span></li></ul>].
            <h4 id="ext-comp-FCS_DTLSS_EXT.4.3">FCS_DTLSS_EXT.4.3</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall [<b>selection</b>: <span class="selectable-content" id="_s_200">terminate the session</span>, <span class="selectable-content" id="_s_201">silently ignore the message</span>] if an unexpected ClientHello is received during an active <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> session.
            </div><h4>Management: FCS_DTLSS_EXT.5</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_DTLSS_EXT.5</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_DTLSS_EXT.5 DTLS Server Support for Session Resumption</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Protocol
          </td></tr></table><h4 id="ext-comp-FCS_DTLSS_EXT.5.1">FCS_DTLSS_EXT.5.1</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support session resumption as a <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> server via the use of [<b>selection</b>: <span class="selectable-content" id="_s_202">session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246</span>, <span class="selectable-content" id="_s_203">tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077</span>, <span class="selectable-content" id="dtlss_v13_resumption">PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span>]. 
            </div><h4>Management: FCS_DTLSS_EXT.6</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_DTLSS_EXT.6</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_DTLSS_EXT.6 DTLS Server DTLS 1.3 Resumption Refinements</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_DTLSS_EXT.1">FCS_DTLSS_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Protocol<br/>
            <a href="#FCS_DTLSS_EXT.5">FCS_DTLSS_EXT.5</a> <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> Server Support for Session Resumption
          </td></tr></table><h4 id="ext-comp-FCS_DTLSS_EXT.6.1">FCS_DTLSS_EXT.6.1</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 resumption using PSK with psk_key_exchange_modes extension with the value psk_dhe_ke.  
            <h4 id="ext-comp-FCS_DTLSS_EXT.6.2">FCS_DTLSS_EXT.6.2</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall ignore early data received in <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 sessions.
            </div></div><h3 id="ext-comp-FCS_TLSC_EXT" class="indexable" data-level="4">B.2.1.4 FCS_TLSC_EXT TLS Client Protocol</h3><div style="margin-left: 1em;"><h4>Family Behavior</h4><div>This family defines requirements for implementation of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a client.</div><h4>Component Leveling</h4><svg style="max-height: 130px;"><text x="4" fill="black" font-size="15" y="84">FCS_TLSC_EXT</text><rect x="2" y="71" width="150" height="16" fill="none" stroke="black"></rect><text x="234" fill="black" font-size="15" y="24">1</text><rect x="232" y="11" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="17" stroke="black"></line><text x="234" fill="black" font-size="15" y="44">2</text><rect x="232" y="31" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="37" stroke="black"></line><text x="234" fill="black" font-size="15" y="64">3</text><rect x="232" y="51" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="57" stroke="black"></line><text x="234" fill="black" font-size="15" y="84">4</text><rect x="232" y="71" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="77" stroke="black"></line><text x="234" fill="black" font-size="15" y="104">5</text><rect x="232" y="91" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="97" stroke="black"></line><text x="234" fill="black" font-size="15" y="124">6</text><rect x="232" y="111" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="117" stroke="black"></line></svg><p><a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Protocol,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to implement <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a client in the specified manner.
          </p><p><a href="#FCS_TLSC_EXT.2">FCS_TLSC_EXT.2</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Support for Mutual Authentication,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support mutually-authenticated <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> when acting as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client.
          </p><p><a href="#FCS_TLSC_EXT.3">FCS_TLSC_EXT.3</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Downgrade Protection,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to implement version downgrade protection when acting as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client.
          </p><p><a href="#FCS_TLSC_EXT.4">FCS_TLSC_EXT.4</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Support for Renegotiation,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session renegotiation when acting as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client.
          </p><p><a href="#FCS_TLSC_EXT.5">FCS_TLSC_EXT.5</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Support for Session Resumption,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session resumption when acting as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client.
          </p><p><a href="#FCS_TLSC_EXT.6">FCS_TLSC_EXT.6</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 Resumption Refinements,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session resumption behavior specific to <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 when acting as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client.
          </p><h4>Management: FCS_TLSC_EXT.1</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLSC_EXT.1</h4><p>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the
            <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>, functional package, or <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>:<ul>
              <li>Establishment and termination of a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session</li>
              <li>Failure to establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session</li>
              <li>Failure to verify presented identifier</li>
            </ul>
          </p><h4>FCS_TLSC_EXT.1 TLS Client Protocol</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td>
            <a href="#FCS_CKM.1">FCS_CKM.1</a> Cryptographic Key Generation<br/>
            <a href="#FCS_CKM.2">FCS_CKM.2</a> Cryptographic Key Distribution<br/>
            <a href="#FCS_COP.1">FCS_COP.1</a> Cryptographic Operation<br/>
            <a href="#FCS_RBG.1">FCS_RBG.1</a> Random Bit Generation (RBG)<br/>
            <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> X.509 Certificate Validation<br/>
            <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a> X.509 Certificate Authentication
          </td></tr></table><h4 id="ext-comp-FCS_TLSC_EXT.1.1">FCS_TLSC_EXT.1.1</h4> The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement
              [<b>selection</b>: <span class="selectable-content" id="_s_205"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246)</span>, <span class="selectable-content" id="_s_206"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span>] as a client that supports additional functionality for session renegotiation protection and
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="tlsc_mutual_auth">mutual authentication</span></li><li style=""><span class="selectable-content" id="tlsc_downgrade_protection">supplemental downgrade protection</span></li><li style=""><span class="selectable-content" id="tlsc_resumption">session resumption</span></li><li style=""><span class="selectable-content" id="_s_210">no optional functionality</span></li></ul>]
              and shall abort attempts by a server to negotiate all other <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> or SSL versions. 
            <h4 id="ext-comp-FCS_TLSC_EXT.1.2">FCS_TLSC_EXT.1.2</h4>
                The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following [<b>assignment</b>: 
     <span class="assignable-content">list of supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ciphersuites</span>],
                offering the supported ciphersuites in a ClientHello message in preference order: 
                [<b>assignment</b>: 
     <span class="assignable-content">list of supported ciphersuites</span>].
              <h4 id="ext-comp-FCS_TLSC_EXT.1.3">FCS_TLSC_EXT.1.3</h4>
            The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not offer ClientHello messages indicating the following: 
            <ul>
              <li>null encryption</li>
              <li>support for anonymous servers</li>
              <li>use of deprecated or export-grade cryptography including DES, 3DES, RC2, RC4, or IDEA for encryption</li>
              <li>use of MD-5 or <abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr>-1 for key derivation</li>
            </ul> and shall abort sessions where a server attempts to negotiate ciphersuites not enumerated in the ClientHello message.
          <h4 id="ext-comp-FCS_TLSC_EXT.1.4">FCS_TLSC_EXT.1.4</h4>
                The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ClientHello message extensions: 
                <ul>
                  <li>signature_algorithms extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for 
                    [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_252">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_253">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_254">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_255">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_256">no other signature algorithms</span></li></ul>]
                    and
                  </li>
                  [<b>assignment</b>: 
     <span class="assignable-content">other supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extensions</span>]<br/>
                    and shall not send the following extensions: <ul>
                      <li>early_data</li>
                      <li>psk_key_exchange_modes indicating PSK only mode.</li>
                    </ul>
                </ul>
              <h4 id="ext-comp-FCS_TLSC_EXT.1.5">FCS_TLSC_EXT.1.5</h4>
                The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_272">verify that a presented identifier of name type: 
                    [<b>assignment</b>: 
     <span class="assignable-content">supported name types</span>]</span></li><li style=""><span class="selectable-content" id="_s_273">interface with a supported function requesting the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel to pass 
                    [<b>selection</b>: <span class="selectable-content" id="_s_274">the validated certification path</span>, <span class="selectable-content" id="_s_275">names of [<b>assignment</b>: 
     <span class="assignable-content">specified types</span>] extracted from the leaf certificate of a validated certification path</span>, <span class="selectable-content" id="_s_276">normalized representations of names of [<b>assignment</b>: 
     <span class="assignable-content">specified types</span>] extracted from the leaf certificate of a validated certification path</span>] for verification that a presented identifier</span></li><li style=""><span class="selectable-content" id="_s_277">pass initial name constraints to the certification path processing function to verify, in accordance with 
                    <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>, that the presented identifier</span></li><li style=""><span class="selectable-content" id="_s_278">associate a PSK with a valid server with an identifier that</span></li></ul>] 
                matches a reference identifier for the requested <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server and shall abort the session if no match is found.
              <h4 id="ext-comp-FCS_TLSC_EXT.1.6">FCS_TLSC_EXT.1.6</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a trusted channel if 
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_279">the server certificate is invalid [<b>selection</b>: <span class="selectable-content" id="s-tlsc-no-excep">with no <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>-specific exceptions</span>, <span class="selectable-content" id="_s_281">except when override is authorized in accordance with [<b>assignment</b>: 
     <span class="assignable-content">override rules</span>] in the case where valid revocation information is not available</span>]
              </span></li><li style=""><span class="selectable-content" id="_s_282">a PSK associated with the server is invalid</span></li></ul>]. 
            </div><h4>Management: FCS_TLSC_EXT.2</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLSC_EXT.2</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_TLSC_EXT.2 TLS Client Support for Mutual Authentication</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Protocol
          </td></tr></table><h4 id="ext-comp-FCS_TLSC_EXT.2.1">FCS_TLSC_EXT.2.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support mutual <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> authentication using X.509v3 certificates during the handshake and [<b>selection</b>: <span class="selectable-content" id="_s_283">in support of post-handshake authentication requests</span>, <span class="selectable-content" id="_s_284">at no other time</span>], in accordance with [<b>selection</b>: <span class="selectable-content" id="_s_285"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246, Section 7.4.4</span>, <span class="selectable-content" id="_s_286"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, Section 4.3.2</span>].</div><h4>Management: FCS_TLSC_EXT.3</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLSC_EXT.3</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_TLSC_EXT.3 TLS Client Downgrade Protection</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Protocol
          </td></tr></table><h4 id="ext-comp-FCS_TLSC_EXT.3.1">FCS_TLSC_EXT.3.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel if the ServerHello message includes 
              [<b>selection</b>: <span class="selectable-content" id="_s_287"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator</span>, <span class="selectable-content" id="_s_288"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1 or below downgrade indicator</span>]
              in the server random field. </div><h4>Management: FCS_TLSC_EXT.4</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLSC_EXT.4</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_TLSC_EXT.4 TLS Client Support for Renegotiation</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Protocol
          </td></tr></table><h4 id="ext-comp-FCS_TLSC_EXT.4.1">FCS_TLSC_EXT.4.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support secure <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> renegotiation through use of
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_289">the “renegotiation_info” <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extension</span></li><li style=""><span class="selectable-content" id="_s_290">the TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuite signaling value in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746</span></li><li style=""><span class="selectable-content" id="_s_291">rejection of all renegotiation attempts</span></li></ul>]
              and shall terminate the session if an unexpected ServerHello is received or [<b>selection</b>: <span class="selectable-content" id="_s_292">hello request message is received</span>, <span class="selectable-content" id="_s_293">in no other case</span>]. 
            </div><h4>Management: FCS_TLSC_EXT.5</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLSC_EXT.5</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_TLSC_EXT.5 TLS Client Support for Session Resumption</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Protocol
          </td></tr></table><h4 id="ext-comp-FCS_TLSC_EXT.5.1">FCS_TLSC_EXT.5.1</h4>
            The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support session resumption as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> client via the use of [<b>selection</b>: <span class="selectable-content" id="_s_294">session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246</span>, <span class="selectable-content" id="_s_295">tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077</span>, <span class="selectable-content" id="tlsc_v13_resumption">PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span>]. 
            </div><h4>Management: FCS_TLSC_EXT.6</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLSC_EXT.6</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_TLSC_EXT.6 TLS Client TLS 1.3 Resumption Refinements</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Protocol<br/>
            <a href="#FCS_TLSC_EXT.5">FCS_TLSC_EXT.5</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Client Support for Session Resumption
          </td></tr></table><h4 id="ext-comp-FCS_TLSC_EXT.6.1">FCS_TLSC_EXT.6.1</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall send a psk_key_exchange_modes extension with the value psk_dhe_ke when <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 session resumption is offered. 
            <h4 id="ext-comp-FCS_TLSC_EXT.6.2">FCS_TLSC_EXT.6.2</h4>
                The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not send early data in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 sessions. 
            </div></div><h3 id="ext-comp-FCS_TLSS_EXT" class="indexable" data-level="4">B.2.1.5 FCS_TLSS_EXT TLS Server Protocol</h3><div style="margin-left: 1em;"><h4>Family Behavior</h4><div>This family defines requirements for implementation of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a server.</div><h4>Component Leveling</h4><svg style="max-height: 130px;"><text x="4" fill="black" font-size="15" y="84">FCS_TLSS_EXT</text><rect x="2" y="71" width="150" height="16" fill="none" stroke="black"></rect><text x="234" fill="black" font-size="15" y="24">1</text><rect x="232" y="11" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="17" stroke="black"></line><text x="234" fill="black" font-size="15" y="44">2</text><rect x="232" y="31" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="37" stroke="black"></line><text x="234" fill="black" font-size="15" y="64">3</text><rect x="232" y="51" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="57" stroke="black"></line><text x="234" fill="black" font-size="15" y="84">4</text><rect x="232" y="71" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="77" stroke="black"></line><text x="234" fill="black" font-size="15" y="104">5</text><rect x="232" y="91" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="97" stroke="black"></line><text x="234" fill="black" font-size="15" y="124">6</text><rect x="232" y="111" width="12" height="16" fill="none" stroke="black"></rect><line x1="152" y1="77" x2="231" y2="117" stroke="black"></line></svg><p><a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Protocol,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to implement <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> as a server in the specified manner.
          </p><p><a href="#FCS_TLSS_EXT.2">FCS_TLSS_EXT.2</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Support for Mutual Authentication,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support mutually-authenticated <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> when acting as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server.
         </p><p><a href="#FCS_TLSS_EXT.3">FCS_TLSS_EXT.3</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Downgrade Protection,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to implement version downgrade protection when acting as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server.
          </p><p><a href="#FCS_TLSS_EXT.4">FCS_TLSS_EXT.4</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Support for Renegotiation,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session renegotiation when acting as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server.
	  </p><p><a href="#FCS_TLSS_EXT.5">FCS_TLSS_EXT.5</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Support for Session Resumption,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session resumption when acting as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server.
          </p><p><a href="#FCS_TLSS_EXT.6">FCS_TLSS_EXT.6</a>,
             <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 Resumption Refinements,
              requires the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to support session resumption behavior specific to <abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr> 1.3 when acting as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server.
          </p><h4>Management: FCS_TLSS_EXT.1</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLSS_EXT.1</h4><p>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the
            <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>, functional package, or <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>:<ul>
              <li>Failure to establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session</li>
            </ul>
          </p><h4>FCS_TLSS_EXT.1 TLS Server Protocol</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td>
            <a href="#FCS_CKM.1">FCS_CKM.1</a> Cryptographic Key Generation<br/>
            <a href="#FCS_CKM.2">FCS_CKM.2</a> Cryptographic Key Distribution<br/>
            <a href="#FCS_COP.1">FCS_COP.1</a> Cryptographic Operation<br/>
            <a href="#FCS_RBG.1">FCS_RBG.1</a> Random Bit Generation (RBG)<br/>
            <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a> X.509 Certificate Validation<br/>
            <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a> X.509 Certificate Authentication
          </td></tr></table><h4 id="ext-comp-FCS_TLSS_EXT.1.1">FCS_TLSS_EXT.1.1</h4> The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement
              [<b>selection</b>: <span class="selectable-content" id="_s_297"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246)</span>, <span class="selectable-content" id="_s_298"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span>] as a server that supports additional functionality for session renegotiation protection and
              [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="tlss_mutual_auth">mutual authentication</span></li><li style=""><span class="selectable-content" id="tlss_downgrade_protection">supplemental downgrade protection</span></li><li style=""><span class="selectable-content" id="tlss_resumption">session resumption</span></li><li style=""><span class="selectable-content" id="_s_302">no optional functionality</span></li></ul>]
              and shall reject connection attempts from clients supporting only <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.1, <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.0, or SSL versions.
            <h4 id="ext-comp-FCS_TLSS_EXT.1.2">FCS_TLSS_EXT.1.2</h4>
                The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to support the following
                [<b>assignment</b>: 
     <span class="assignable-content">list of supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ciphersuites</span>],
                offering the supported ciphersuites in a ClientHello message in preference order: 
                [<b>assignment</b>: 
     <span class="assignable-content">priority</span>].
              <h4 id="ext-comp-FCS_TLSS_EXT.1.3">FCS_TLSS_EXT.1.3</h4>
            The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish a connection with a client that does not indicate support for at least one of the supported cryptographic
            parameter sets.
          <h4 id="ext-comp-FCS_TLSS_EXT.1.4">FCS_TLSS_EXT.1.4</h4>
                The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to process the following <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> ClientHello message extensions: 
                <ul>
                  <li>signature_algorithms extension (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446) indicating support for 
                    [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_346">ecdsa-secp384r1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li><li style=""><span class="selectable-content" id="_s_347">rsa_pkcs1_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446)</span></li></ul>], and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_348">rsa_pss_pss_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_349">rsa_pss_rsae_sha384 (<abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8603)</span></li><li style=""><span class="selectable-content" id="_s_350">no other signature algorithms</span></li></ul>]
                    and
                  </li>
                </ul>
                  [<b>assignment</b>: 
     <span class="assignable-content">other supported <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extensions</span>]
                  
                
              <h4 id="ext-comp-FCS_TLSS_EXT.1.5">FCS_TLSS_EXT.1.5</h4>
                  The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall perform key establishment for <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> using [<b>assignment</b>: 
     <span class="assignable-content">key establishment parameters</span>]. 
                </div><h4>Management: FCS_TLSS_EXT.2</h4><p>No specific management functions are identified.
         </p><h4>Audit: FCS_TLSS_EXT.2</h4><p>There are no auditable events foreseen.
         </p><h4>FCS_TLSS_EXT.2 TLS Server Support for Mutual Authentication</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Protocol
         </td></tr></table><h4 id="ext-comp-FCS_TLSS_EXT.2.1">FCS_TLSS_EXT.2.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support authentication of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> clients using X.509v3 certificates during the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> handshake and [<b>selection</b>: <span class="selectable-content" id="_s_367">during post-handshake requests</span>, <span class="selectable-content" id="_s_368">at no other time</span>] 
              using the certificate types indicated in the client’s signature_algorithms and [<b>selection</b>: <span class="selectable-content" id="_s_369">signature_algorithms_cert</span>, <span class="selectable-content" id="_s_370">no other</span>] extension.
            <h4 id="ext-comp-FCS_TLSS_EXT.2.2">FCS_TLSS_EXT.2.2</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support authentication of <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> clients using X.509v3 certificates in accordance with <span class="no-link">FIA_X509_EXT.1</span>.<h4 id="ext-comp-FCS_TLSS_EXT.2.3">FCS_TLSS_EXT.2.3</h4>
             The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to reject the establishment of a trusted channel if the requested client certificate is invalid and [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_371">continue establishment of a server-only authenticated <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel in accordance with <a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a> in support of [<b>selection</b>: <span class="selectable-content" id="_s_372">all applications</span>, <span class="selectable-content" id="_s_373">[<b>assignment</b>: 
     <span class="assignable-content">list of calling applications that accept both authenticated and unauthenticated client sessions</span>]</span>] 
                 when an empty certificate message is provided by the client</span></li><li style=""><span class="selectable-content" id="_s_374">continue establishment of a mutually authenticated <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> channel when revocation status information for the [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_375">client's leaf certificate</span></li><li style=""><span class="selectable-content" id="_s_376">[<b>assignment</b>: 
     <span class="assignable-content">specific intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificates</span>]</span></li><li style=""><span class="selectable-content" id="_s_377">any non-trust store certificate in the certificate chain</span></li></ul>]  
                 is not available in support of [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_378">all supported functions</span></li><li style=""><span class="selectable-content" id="_s_379">[<b>assignment</b>: 
     <span class="assignable-content">list of calling supported functions configurable to perform certificate status information bypass processing</span>]</span></li></ul>] as [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_380">configured by an administrator</span></li><li style=""><span class="selectable-content" id="_s_381">confirmed by the supported function user</span></li><li style=""><span class="selectable-content" id="_s_382">a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr>-specific default for [<b>assignment</b>: 
     <span class="assignable-content">subset of supported functions</span>]</span></li></ul>]
               </span></li><li style=""><span class="selectable-content" id="_s_383">no other processing options for missing or invalid client certificates</span></li></ul>]. 
           <h4 id="ext-comp-FCS_TLSS_EXT.2.4">FCS_TLSS_EXT.2.4</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to [<b>selection</b>: <ul><li style=""><span class="selectable-content" id="_s_384">not establish a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session if an entry of the Distinguished Name or a [<b>selection</b>: <span class="selectable-content" id="_s_385">rfc822_name</span>, <span class="selectable-content" id="_s_386">dns_name</span>, <span class="selectable-content" id="_s_387">[<b>assignment</b>: 
     <span class="assignable-content">supported name types</span>]</span>]
               in the Subject Alternate Name extension contained in the client certificate does not match one of the expected identifiers for the client in accordance with [<b>selection</b>: <span class="selectable-content" id="_s_388"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822</span>, <span class="selectable-content" id="_s_389"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span>, <span class="selectable-content" id="_s_390"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280</span>, <span class="selectable-content" id="_s_391">[<b>assignment</b>: 
     <span class="assignable-content"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> for the supported name type</span>]</span>]
               matching rules</span></li><li style=""><span class="selectable-content" id="_s_392">pass the [<b>selection</b>: <span class="selectable-content" id="_s_393">validated certificate</span>, <span class="selectable-content" id="_s_394"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822 name normalized according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 2822</span>, <span class="selectable-content" id="_s_395"><abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr> name normalized according to <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 6125</span>, <span class="selectable-content" id="_s_396">[<b>assignment</b>: 
     <span class="assignable-content">list of <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5280 name types and normalization rules</span>]</span>, <span class="selectable-content" id="_s_397">[<b>assignment</b>: 
     <span class="assignable-content">list of 'other' name types and standard normalization rules</span>]</span>] 
               to [<b>assignment</b>: 
     <span class="assignable-content">list of calling applications capable of making access decisions</span>]</span></li><li style=""><span class="selectable-content" id="_s_398">pass initial name constraints of type [<b>selection</b>: <span class="selectable-content" id="_s_399">directory name</span>, <span class="selectable-content" id="_s_400">rfc_822_name</span>, <span class="selectable-content" id="_s_401">dns_name</span>, <span class="selectable-content" id="_s_402">[<b>assignment</b>: 
     <span class="assignable-content">supported name types</span>]</span>]
               to the certification path processing function to verify, in accordance with <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>, that the presented identifier matches
               an expected client identifier</span></li><li style=""><span class="selectable-content" id="_s_403">associate a PSK to a specific reference identifier</span></li></ul>].
           </div><h4>Management: FCS_TLSS_EXT.3</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLSS_EXT.3</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_TLSS_EXT.3 TLS Server Downgrade Protection</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Protocol
          </td></tr></table><h4 id="ext-comp-FCS_TLSS_EXT.3.1">FCS_TLSS_EXT.3.1</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall set the ServerHello extension to a random value concatenated with the <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 downgrade indicator when negotiating <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 as indicated in <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446, Section 4.1.3.
            </div><h4>Management: FCS_TLSS_EXT.4</h4><p>No specific management functions are identified.
	  </p><h4>Audit: FCS_TLSS_EXT.4</h4><p>There are no auditable events foreseen.
	  </p><h4>FCS_TLSS_EXT.4 TLS Server Support for Renegotiation</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Protocol
	  </td></tr></table><h4 id="ext-comp-FCS_TLSS_EXT.4.1">FCS_TLSS_EXT.4.1</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support secure <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> renegotiation through the use of [<b>selection</b>: <span class="selectable-content" id="_s_404">the "renegotiation_info" <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> extension in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5746</span>, <span class="selectable-content" id="_s_405">not allowing session renegotiation</span>]. 
            <h4 id="ext-comp-FCS_TLSS_EXT.4.2">FCS_TLSS_EXT.4.2</h4>The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall
              [<b>selection</b>: <span class="selectable-content" id="_s_406">indicate support for renegotiating a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.2 session by including the renegotiation_info extension in the server
                  hello message when a ClientHello with the renegotiation_info extension is received and shall terminate a session if
                  neither of the renegotiation_info or TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuites are indicated in the client
                  hello</span>, <span class="selectable-content" id="_s_407">not allow renegotiation</span>].
            <h4 id="ext-comp-FCS_TLSS_EXT.4.3">FCS_TLSS_EXT.4.3</h4>
	      The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall terminate the session if an unexpected ClientHello is received during an active <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> session.
	    </div><h4>Management: FCS_TLSS_EXT.5</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLSS_EXT.5</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_TLSS_EXT.5 TLS Server Support for Session Resumption</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Protocol
          </td></tr></table><h4 id="ext-comp-FCS_TLSS_EXT.5.1">FCS_TLSS_EXT.5.1</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support session resumption as a <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> server via the use of [<b>selection</b>: <span class="selectable-content" id="_s_408">session ID in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5246</span>, <span class="selectable-content" id="_s_409">tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 5077</span>, <span class="selectable-content" id="tlss_v13_resumption">PSK and tickets in accordance with <abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr> 8446</span>]. 
            </div><h4>Management: FCS_TLSS_EXT.6</h4><p>No specific management functions are identified.
          </p><h4>Audit: FCS_TLSS_EXT.6</h4><p>There are no auditable events foreseen.
          </p><h4>FCS_TLSS_EXT.6 TLS Server TLS 1.3 Resumption Refinements</h4><div style="margin-left: 1em;"><table class="ecd_heir_dep" style="width: 100%"><tr><td style="whitespace: nowrap">Hierarchical to:</td><td style="width: 100%">No other components.</td></tr><tr style="background-color: inherit"><td>Dependencies to:</td><td><a href="#FCS_TLSS_EXT.1">FCS_TLSS_EXT.1</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Protocol<br/>
            <a href="#FCS_TLSS_EXT.5">FCS_TLSS_EXT.5</a> <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> Server Support for Session Resumption
          </td></tr></table><h4 id="ext-comp-FCS_TLSS_EXT.6.1">FCS_TLSS_EXT.6.1</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 resumption using PSK with psk_key_exchange_modes extension with the value psk_dhe_ke.  
            <h4 id="ext-comp-FCS_TLSS_EXT.6.2">FCS_TLSS_EXT.6.2</h4>
              The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall ignore early data received in <abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr> 1.3 sessions.
            </div></div></span></span><h1 id="acronyms" class="indexable" data-level="A">Appendix C -  Acronyms</h1><table><caption><span class="ctr" data-myid="t-acronyms" data-counter-type="ct-Table" id="t-acronyms">Table <span class="counter">3</span></span>: Acronyms
		</caption><tr class="header"><th>Acronym</th><th>Meaning</th></tr><tr><td><span class="term" id="abbr_AES"><abbr class="dyn-abbr"><a href="#abbr_AES">AES</a></abbr></span></td><td><span id="long_abbr_AES">Advanced Encryption Standard</span></td></tr>
<tr><td><span class="term" id="abbr_Base-PP" data-plural="Base-PPs"><abbr class="dyn-abbr"><a href="#abbr_Base-PP">Base-PP</a></abbr></span></td><td><span id="long_abbr_Base-PP">Base Protection Profile</span></td></tr>
<tr><td><span class="term" id="abbr_CA"><abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr></span></td><td><span id="long_abbr_CA">Certificate Authority</span></td></tr>
<tr><td><span class="term" id="abbr_CBC"><abbr class="dyn-abbr"><a href="#abbr_CBC">CBC</a></abbr></span></td><td><span id="long_abbr_CBC">Cipher Block Chaining</span></td></tr>
<tr><td><span class="term" id="abbr_CC"><abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr></span></td><td><span id="long_abbr_CC">Common Criteria</span></td></tr>
<tr><td><span class="term" id="abbr_CEM"><abbr class="dyn-abbr"><a href="#abbr_CEM">CEM</a></abbr></span></td><td><span id="long_abbr_CEM">Common Evaluation Methodology</span></td></tr>
<tr><td><span class="term" id="abbr_CN"><abbr class="dyn-abbr"><a href="#abbr_CN">CN</a></abbr></span></td><td><span id="long_abbr_CN">Common Name</span></td></tr>
<tr><td><span class="term" id="abbr_cPP" data-plural="cPPs"><abbr class="dyn-abbr"><a href="#abbr_cPP">cPP</a></abbr></span></td><td><span id="long_abbr_cPP">Collaborative Protection Profile</span></td></tr>
<tr><td><span class="term" id="abbr_DHE"><abbr class="dyn-abbr"><a href="#abbr_DHE">DHE</a></abbr></span></td><td><span id="long_abbr_DHE">Diffie-Hellman Ephemeral</span></td></tr>
<tr><td><span class="term" id="abbr_DN"><abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr></span></td><td><span id="long_abbr_DN">Distinguished Name</span></td></tr>
<tr><td><span class="term" id="abbr_DNS"><abbr class="dyn-abbr"><a href="#abbr_DNS">DNS</a></abbr></span></td><td><span id="long_abbr_DNS">Domain Name Server</span></td></tr>
<tr><td><span class="term" id="abbr_DTLS"><abbr class="dyn-abbr"><a href="#abbr_DTLS">DTLS</a></abbr></span></td><td><span id="long_abbr_DTLS">Datagram Transport Layer Security</span></td></tr>
<tr><td><span class="term" id="abbr_EAP"><abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr></span></td><td><span id="long_abbr_EAP">Extensible Authentication Protocol</span></td></tr>
<tr><td><span class="term" id="abbr_ECDHE"><abbr class="dyn-abbr"><a href="#abbr_ECDHE">ECDHE</a></abbr></span></td><td><span id="long_abbr_ECDHE">Elliptic Curve Diffie-Hellman Ephemeral</span></td></tr>
<tr><td><span class="term" id="abbr_ECDSA"><abbr class="dyn-abbr"><a href="#abbr_ECDSA">ECDSA</a></abbr></span></td><td><span id="long_abbr_ECDSA">Elliptic Curve Digital Signature Algorithm</span></td></tr>
<tr><td><span class="term" id="abbr_EP"><abbr class="dyn-abbr"><a href="#abbr_EP">EP</a></abbr></span></td><td><span id="long_abbr_EP">Extended Package</span></td></tr>
<tr><td><span class="term" id="abbr_FP"><abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr></span></td><td><span id="long_abbr_FP">Functional Package</span></td></tr>
<tr><td><span class="term" id="abbr_GCM"><abbr class="dyn-abbr"><a href="#abbr_GCM">GCM</a></abbr></span></td><td><span id="long_abbr_GCM">Galois/Counter Mode</span></td></tr>
<tr><td><span class="term" id="abbr_HTTP"><abbr class="dyn-abbr"><a href="#abbr_HTTP">HTTP</a></abbr></span></td><td><span id="long_abbr_HTTP">Hypertext Transfer Protocol</span></td></tr>
<tr><td><span class="term" id="abbr_IETF"><abbr class="dyn-abbr"><a href="#abbr_IETF">IETF</a></abbr></span></td><td><span id="long_abbr_IETF">Internet Engineering Task Force</span></td></tr>
<tr><td><span class="term" id="abbr_IP"><abbr class="dyn-abbr"><a href="#abbr_IP">IP</a></abbr></span></td><td><span id="long_abbr_IP">Internet Protocol</span></td></tr>
<tr><td><span class="term" id="abbr_NIST"><abbr class="dyn-abbr"><a href="#abbr_NIST">NIST</a></abbr></span></td><td><span id="long_abbr_NIST">National Institute of Standards and Technology</span></td></tr>
<tr><td><span class="term" id="abbr_OE"><abbr class="dyn-abbr"><a href="#abbr_OE">OE</a></abbr></span></td><td><span id="long_abbr_OE">Operational Environment</span></td></tr>
<tr><td><span class="term" id="abbr_PP" data-plural="PPs"><abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr></span></td><td><span id="long_abbr_PP">Protection Profile</span></td></tr>
<tr><td><span class="term" id="abbr_PP-Configuration"><abbr class="dyn-abbr"><a href="#abbr_PP-Configuration">PP-Configuration</a></abbr></span></td><td><span id="long_abbr_PP-Configuration">Protection Profile Configuration</span></td></tr>
<tr><td><span class="term" id="abbr_PP-Module"><abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr></span></td><td><span id="long_abbr_PP-Module">Protection Profile Module</span></td></tr>
<tr><td><span class="term" id="abbr_RFC"><abbr class="dyn-abbr"><a href="#abbr_RFC">RFC</a></abbr></span></td><td><span id="long_abbr_RFC">Request for Comment (<abbr class="dyn-abbr"><a href="#abbr_IETF">IETF</a></abbr>)</span></td></tr>
<tr><td><span class="term" id="abbr_RSA"><abbr class="dyn-abbr"><a href="#abbr_RSA">RSA</a></abbr></span></td><td><span id="long_abbr_RSA">Rivest Shamir Adelman</span></td></tr>
<tr><td><span class="term" id="abbr_SAN"><abbr class="dyn-abbr"><a href="#abbr_SAN">SAN</a></abbr></span></td><td><span id="long_abbr_SAN">Subject Alternative Name</span></td></tr>
<tr><td><span class="term" id="abbr_SAR" data-plural="SARs"><abbr class="dyn-abbr"><a href="#abbr_SAR">SAR</a></abbr></span></td><td><span id="long_abbr_SAR">Security Assurance Requirement</span></td></tr>
<tr><td><span class="term" id="abbr_SCSV"><abbr class="dyn-abbr"><a href="#abbr_SCSV">SCSV</a></abbr></span></td><td><span id="long_abbr_SCSV">Signaling ciphersuite Value</span></td></tr>
<tr><td><span class="term" id="abbr_SFR" data-plural="SFRs"><abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr></span></td><td><span id="long_abbr_SFR">Security Functional Requirement</span></td></tr>
<tr><td><span class="term" id="abbr_SHA"><abbr class="dyn-abbr"><a href="#abbr_SHA">SHA</a></abbr></span></td><td><span id="long_abbr_SHA">Secure Hash Algorithm</span></td></tr>
<tr><td><span class="term" id="abbr_ST" data-plural="STs"><abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr></span></td><td><span id="long_abbr_ST">Security Target</span></td></tr>
<tr><td><span class="term" id="abbr_TCP"><abbr class="dyn-abbr"><a href="#abbr_TCP">TCP</a></abbr></span></td><td><span id="long_abbr_TCP">Transmission Control Protocol</span></td></tr>
<tr><td><span class="term" id="abbr_TLS"><abbr class="dyn-abbr"><a href="#abbr_TLS">TLS</a></abbr></span></td><td><span id="long_abbr_TLS">Transport Layer Security</span></td></tr>
<tr><td><span class="term" id="abbr_TOE" data-plural="TOEs"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr></span></td><td><span id="long_abbr_TOE">Target of Evaluation</span></td></tr>
<tr><td><span class="term" id="abbr_TSF"><abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr></span></td><td><span id="long_abbr_TSF"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> Security Functionality</span></td></tr>
<tr><td><span class="term" id="abbr_TSFI" data-plural="TSFIs"><abbr class="dyn-abbr"><a href="#abbr_TSFI">TSFI</a></abbr></span></td><td><span id="long_abbr_TSFI"><abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> Interface</span></td></tr>
<tr><td><span class="term" id="abbr_TSS"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></span></td><td><span id="long_abbr_TSS"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> Summary Specification</span></td></tr>
<tr><td><span class="term" id="abbr_UDP"><abbr class="dyn-abbr"><a href="#abbr_UDP">UDP</a></abbr></span></td><td><span id="long_abbr_UDP">User Datagram Protocol</span></td></tr>
<tr><td><span class="term" id="abbr_URI"><abbr class="dyn-abbr"><a href="#abbr_URI">URI</a></abbr></span></td><td><span id="long_abbr_URI">Uniform Resource Identifier</span></td></tr>
<tr><td><span class="term" id="abbr_URL"><abbr class="dyn-abbr"><a href="#abbr_URL">URL</a></abbr></span></td><td><span id="long_abbr_URL">Uniform Resource Locator</span></td></tr>
</table><h1 id="appendix-bibliography" class="indexable" data-level="A">Appendix D -  Bibliography</h1><table><caption><span class="ctr" data-myid="t-biblio" data-counter-type="ct-Table" id="t-biblio">Table <span class="counter">4</span></span>: Bibliography</caption><tr class="header"><th>Identifier</th><th>Title</th></tr><tr><td><span id="bibCC">[<abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>]</span></td><td><span class="description">Common Criteria for Information Technology Security Evaluation - <ul>
            <li><a href="https://www.commoncriteriaportal.org/files/ccfiles/CC2022PART1R1.pdf">Part 1: 
				Introduction and general model</a>, CCMB-2022-11-001, <abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>:2022, Revision 1, November 2022.</li>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CC2022PART2R1.pdf">Part 2: 
				Security functional requirements</a>, CCMB-2022-11-002, <abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>:2022, Revision 1, November 2022.</li>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CC2022PART3R1.pdf">Part 3: 
                Security assurance requirements</a>, CCMB-2022-11-003, <abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>:2022, Revision 1, November 2022.</li>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CC2022PART4R1.pdf">Part 4: 
                Framework for the specification of evaluation methods and activities</a>, CCMB-2022-11-004, <abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>:2022, Revision 1, November 2022.</li>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CC2022PART5R1.pdf">Part 5: 
                 Pre-defined packages of security requirements</a>, CCMB-2022-11-005, <abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>:2022, Revision 1, November 2022.</li>
          </ul></span></td></tr><tr><td><span id="bibCEM">[<abbr class="dyn-abbr"><a href="#abbr_CEM">CEM</a></abbr>]</span></td><td><span class="description">
          <a href="https://commoncriteriaportal.org/files/ccfiles/CEM2022R1.pdf">Common
            Methodology for Information Technology Security - Evaluation Methodology</a>,
          CCMB-2022-11-006, <abbr class="dyn-abbr"><a href="#abbr_CEM">CEM</a></abbr>:2022, Revision 1, November 2022. </span></td></tr><tr><td><span id="bibCEM">[<abbr class="dyn-abbr"><a href="#abbr_CEM">CEM</a></abbr>]</span></td><td><span class="description">Common Methodology for Information Technology Security Evaluation - <ul>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CEM2022R1.pdf">
                 Evaluation methodology</a>, CCMB-2022-11-006, <abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>:2022, Revision 1, November 2022.</li>
          </ul></span></td></tr></table></body></html>